function HandsontableHelper(e,t){var n=e,r=[],a=t,o=void 0;isUndefined(a.fixedColLeft)&&(a.fixedColLeft=1),isUndefined(a.readonlyBool)&&(a.readonlyBool=!0),isUndefined(a.sortBool)&&(a.sortBool=!0),isUndefined(a.rowHeaders)&&(a.rowHeaders=!0),isUndefined(a.chkAllColumnYn)&&(a.chkAllColumnYn=!0),isUndefined(a.heightVal)&&(a.heightVal=200),(isEmpty(r.curPage)||isEmpty(r.perPage))&&(r.curPage=1,r.perPage=10);for(var l=0;l<a.columns.length;l++)if("CHK"==a.columns[l].data){a.chkAllColumnYn=!0,a.chkAllHeaderStr="<input type='checkbox' class='checkAll'/>",a.chkALlClassNm="cls_"+n.selector.replace("#",""),a.colHeaders[l]="<input type='checkbox' class='"+a.chkALlClassNm+"'/>";break}this.getHsc=function(){return n},this.getHsData=function(){return r},this.getHsChgData=function(){return r.chg},this.getHsGridData=function(){return r.grid},this.getHsOrgData=function(){return r.org},this.getMetaData=function(){return a},this.getCurRow=function(){return o},this.setData=function(e){var t=n.handsontable("getInstance");e=void 0==e?[]:e,addUid(e),r.chg={};var a=new Object;a=JSON.parse(JSON.stringify(e)),r.org=a,r.grid=e,t.loadData(null),t.loadData(e),t.render()},this.addData=function(e,t){isUndefined(e)&&(e={}),isUndefined(t)&&(t=!1);for(var a,o=Object.keys(r.org).length,l=void 0,d=void 0,s=0;s<Object.keys(r.chg).length;s++)a=Object.keys(r.chg)[s],d=a,0<=r.chg[a].uid&&(void 0==l?l=r.chg[a].uid:l<r.chg[a].uid&&(l=r.chg[a].uid));var i;i=void 0==l?o:l>=o?l+1:o;var c;c=void 0==d?0:1*d+1,addDataObj(jQuery,e,"uid",i),addDataObj(jQuery,e,"ROW_STATUS","I"),t&&addDataObj(jQuery,e,"CHK",!1),addDataObj(jQuery,r.grid,Object.keys(r.grid).length,e),addDataObj(jQuery,r.chg,c,e);var u=n.handsontable("getInstance");u.render()},this.delrow=function(){var e=n.handsontable("getInstance");if(isUndefined(o))return!1;var t=o;void 0!=e.sortIndex&&e.sortIndex.length>0&&e.sortIndex.length>t&&(t=e.sortIndex[t][0]);var a,l=r.grid[t],d=void 0,s=void 0;if(0==Object.keys(r.chg).length)addDataObj(jQuery,l,"ROW_STATUS","D"),addDataObj(jQuery,r.chg,"0",l);else{a=0;for(var i=0;i<Object.keys(r.chg).length;i++)s=Object.keys(r.chg)[i],r.chg[s].uid==l.uid&&(a++,d=s);var c;c=void 0==s?0:1*s+1,0==a?(addDataObj(jQuery,l,"ROW_STATUS","D"),addDataObj(jQuery,r.chg,c,l)):"I"==l.ROW_STATUS?delete r.chg[d]:"U"==l.ROW_STATUS&&(l.ROW_STATUS="D")}return n.handsontable("alter","remove_row",Number(t)),!0};var d=function(e){var t=n.handsontable("getInstance"),a=e;void 0!=t.sortIndex&&t.sortIndex.length>0&&t.sortIndex.length>a&&(a=t.sortIndex[a][0]);var o,l=r.grid[a],d=0;if(0==Object.keys(r.chg).length)addDataObj(jQuery,l,"ROW_STATUS","U"),addDataObj(jQuery,r.chg,"0",l);else{if(void 0==l)return;d=0;for(var s=0;s<Object.keys(r.chg).length;s++)o=Object.keys(r.chg)[s],r.chg[o].uid==l.uid&&d++;var i;i=void 0==o?0:1*o+1,0==d&&(addDataObj(jQuery,l,"ROW_STATUS","U"),addDataObj(jQuery,r.chg,i,l))}};this.otherDefaultEventSetting=function(){var e=n.handsontable();e.handsontable("updateSettings",{onSelection:function(){o=arguments[0]},afterChange:function(e,t){null!=arguments[0]&&void 0!=arguments[0][0]&&arguments[0][0][2]!=arguments[0][0][3]&&"CHK"!=arguments[0][0][1]&&d(arguments[0][0][0])},afterRender:function(){a.chkAllColumnYn&&$("."+a.chkALlClassNm).on("click",function(){var e=function(e){var t=new Promise(function(t,n){for(var a=0;a<Object.keys(r.grid).length;a++)r.grid[a].CHK=e;t(e)});t.then(function(e){return $("."+a.chkALlClassNm)[0].checked!=e&&($("."+a.chkALlClassNm)[0].checked=e),e}).then(function(e){})};a.chkAllBool=$("."+a.chkALlClassNm)[0].checked,e(a.chkAllBool)})},rowHeaders:function(e){return 1==a.rowHeaders?(r.curPage-1)*r.perPage+e+1:void(0==a.rowHeaders)}})}}function customedRenderer(instance,td,row,col,prop,value,cellProperties){var code,desc;if("dropdown"!=cellProperties.type&&"autocomplete"!=cellProperties.type||null==value)"text"==cellProperties.type?Handsontable.renderers.TextRenderer.apply(this,arguments):"textHyperLink"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextHyperLink"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"htTextHyperLinkLeftAlign"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextHyperLinkLeftAlign"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"textCenter"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextCenter"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"date"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htDate"),Handsontable.renderers.AutocompleteRenderer.apply(this,arguments)):"numeric"==cellProperties.type?Handsontable.renderers.NumericRenderer.apply(this,arguments):"checkbox"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htCheckbox"),arguments[5]=void 0==arguments[5]?!1:arguments[5],Handsontable.renderers.CheckboxRenderer.apply(this,arguments)):"autocomplete"==cellProperties.type?Handsontable.renderers.AutocompleteRenderer.apply(this,arguments):"handsontable"==cellProperties.type?Handsontable.renderers.AutocompleteRenderer.apply(this,arguments):"password"==cellProperties.type?Handsontable.renderers.PasswordRenderer.apply(this,arguments):"dropdown"==cellProperties.type?Handsontable.renderers.AutocompleteRenderer.apply(this,arguments):"vssNmRender"==cellProperties.type&&("Departed"==instance.getDataAtCell(row,"PORT_SPMT_STTS")?(instance.view.wt.wtDom.addClass(td,"htTextHyperLink"),Handsontable.renderers.TextRenderer.apply(this,arguments)):Handsontable.renderers.TextRenderer.apply(this,arguments));else{if(instance.view.wt.wtDom.addClass(td,"htDropdown"),-1==value.indexOf(":")&&value.length>=3){var evalStr="instance.getData()[row]."+arguments[4]+"= ''";eval(evalStr)}Handsontable.renderers.TextRenderer.apply(this,arguments),code=value.match(/.+(?=\:)/gm),null!=code?(code=code.toString(),desc=value.replace(code,"").replace(":","").replace("'",""),td.textContent=desc):td.textContent=""}void 0!=td.textContent&&limitCharLength(td,cellProperties)}function measureText(e,t,n){var r=document.createElement("lDiv");document.body.appendChild(r),null!=n&&(r.style=n),r.style.fontSize=""+t+"px",r.style.position="absolute",r.style.left=-1e3,r.style.top=-1e3,r.innerHTML=e;var a={width:r.clientWidth,height:r.clientHeight};return document.body.removeChild(r),r=null,a}function limitCharLength(e,t){var n=e.textContent,r=measureText(n,"10",{font:"Arial"}),a=Math.round(e.clientWidth/1.5);void 0!=n&&r.width>a&&("password"!=t.type&&(n=getMaxTextByWidth(n,"10",{font:"Arial"},a)+".."),e.textContent=n)}function isUndefined(e){return"undefined"==typeof e?!0:!1}function isEmpty(e){return"undefined"==typeof e||0==(e+"").trim().length?!0:!1}function addUid(e){if(void 0!=e)for(var t=0;t<e.length;t++)addDataObj(jQuery,e[t],"uid",t)}function addDataObj(jQuery,dataObj,keyNm,keyVal){eval("jQuery.extend(dataObj, {"+keyNm+" : keyVal})")}function RealTypeOf(e){return"object"==typeof e?null===e?"null":e.constructor==(new Array).constructor?"array":e.constructor==(new Date).constructor?"date":e.constructor==(new RegExp).constructor?"regex":"object":typeof e}function FormatJSON(e,t){if(arguments.length<2)var t="";var n="    ",r=RealTypeOf(e);if("array"==r){if(0==e.length)return"[]";var a="["}else{var o=0;if($.each(e,function(){o++}),0==o)return"{}";var a="{"}var o=0;return $.each(e,function(e,l){switch(o>0&&(a+=","),a+="array"==r?"\n"+t+n:"\n"+t+n+'"'+e+'": ',RealTypeOf(l)){case"array":case"object":a+=FormatJSON(l,t+n);break;case"boolean":case"number":a+=l.toString();break;case"null":a+="null";break;case"string":a+='"'+l+'"';break;default:a+="TYPEOF: "+typeof l}o++}),a+="array"==r?"\n"+t+"]":"\n"+t+"}"}HandsontableHelper.prototype={constructor:HandsontableHelper,init:function(){var e=this.getHsc(),t=this.getMetaData(),n=e.handsontable();n.handsontable("updateSettings",{colHeaders:t.colHeaders,columns:t.columns,colWidths:t.colWidths,columnSorting:t.sortBool,fillHandle:null,currentRowClassName:"currentRow",currentColClassName:"currentCol",stretchH:"all",height:t.heightVal,multiSelect:!1,manualColumnResize:!0,fixedColumnsLeft:t.fixedColLeft,afterLoadData:function(){t.chkAllColumnYn&&void 0!=$("."+t.chkALlClassNm)[0]&&void 0==$("."+t.chkALlClassNm)[0].checked&&($("."+t.chkALlClassNm)[0].checked=!1)},cells:function(e,n,r){if(void 0==t.columns[n].renderer){var a={};return a.renderer=customedRenderer,1==t.readonlyBool?a.readOnly=t.readonlyBool:void 0!=t.columns[n].readOnly?a.readOnly=t.columns[n].readOnly:a.readOnly=t.readonlyBool,a}}}),this.otherDefaultEventSetting()}};