function addDsSet(obj,scopeRDataNm,ds_nm,grid_id,type){if(null!=obj&&null!=scopeRDataNm&&null!=ds_nm&&null!=grid_id&&null!=type&&""!=obj&&""!=scopeRDataNm&&""!=ds_nm&&""!=grid_id&&""!=type)if("CRUD"==type){var ds_org=eval("scopeRDataNm."+ds_nm),ds_aft=eval("$('#"+grid_id+"').jqxGrid('getrows')");if(""==ds_org||""==ds_aft)return;eval("$.extend(obj, {"+ds_nm+": ds_aft})"),ds_nm+="_org",eval("$.extend(obj, {"+ds_nm+": ds_org})")}else if("NOR"==type){var ds_aft=eval("$('#"+grid_id+"').jqxGrid('getrows')");if(""==ds_aft)return;eval("$.extend(obj, {"+ds_nm+": ds_aft})")}}function dsSet(obj,ds_nm,ds_aft,ds_org){null!=obj&&null!=ds_nm&&null!=ds_aft&&""!=obj&&""!=ds_nm&&""!=ds_aft&&(eval("$.extend(obj, {"+ds_nm+": ds_aft})"),null!=ds_org&&(ds_nm+="_org_",eval("$.extend(obj, {"+ds_nm+": ds_org})")))}function addParamSet(e){for(var t="",r=0;r<e.length;r++)t=t+"&"+e[r];return t}function jqxGridRender($scope,gridNm,mappingDataObj,datafieldsObj,columnCfgObj,widthVal,heightVal,readyFunc){gridNm="#"+gridNm;var source={datatype:"json",datafields:datafieldsObj,localdata:eval("$scope."+mappingDataObj)},dataAdapter=new $.jqx.dataAdapter(source);$(gridNm).jqxGrid({width:widthVal,height:heightVal,source:dataAdapter,columns:columnCfgObj,ready:function(){eval(readyFunc)}})}function jqxGridUpdateHandler(event,jQuery,jSonObj,gridNm){var args=event.args,selectedrowindex=args.rowindex,curRowData=jQuery("#"+gridNm).jqxGrid("getrows")[selectedrowindex];if(args.value!=eval("curRowData."+args.datafield)){$("#"+gridNm).jqxGrid("setcellvalue",selectedrowindex,args.datafield,args.value);var cnt=0;if(0==Object.keys(jSonObj).length)addDataObj(jQuery,curRowData,"ROW_STATUS","U"),addDataObj(jQuery,jSonObj,Object.keys(jSonObj).length,curRowData);else{cnt=0;for(var i=0;i<Object.keys(jSonObj).length;i++)jSonObj[i].uid==curRowData.uid&&cnt++;0==cnt&&(addDataObj(jQuery,curRowData,"ROW_STATUS","U"),addDataObj(jQuery,jSonObj,Object.keys(jSonObj).length,curRowData))}}}function jqxGridInsertHandler(e,t,r,a){var n={};addDataObj(t,n,"ROW_STATUS","I"),addDataObj(t,r,Object.keys(r).length,n),t("#"+a).jqxGrid("addrow",null,n)}function jqxGridDeleteHandler(e,t,r,a){var n=$("#"+a).jqxGrid("getselectedrowindex")-1,o=t("#"+a).jqxGrid("getrows")[n],l=$("#"+a).jqxGrid("getrowid",n);if(0==Object.keys(r).length)addDataObj(t,o,"ROW_STATUS","D"),addDataObj(t,r,Object.keys(r).length,o);else{cnt=0;for(var d=0;d<Object.keys(r).length;d++)r[d].uid==o.uid&&cnt++;0==cnt?(addDataObj(t,o,"ROW_STATUS","D"),addDataObj(t,r,Object.keys(r).length,o)):"I"==o.ROW_STATUS?delete r[0]:"U"==o.ROW_STATUS&&(o.ROW_STATUS="D")}t("#"+a).jqxGrid("deleterow",l)}function handsonGridInsertHandler(jQuery,$scope,jSonObj,insertDO,chkAllYn){"undefined"==typeof insertDO&&(insertDO={}),"undefined"==typeof chkAllYn&&(chkAllYn="N");for(var gridDataObjStr=jSonObj+".grid",chgDataObjStr=jSonObj+".chg",orgDataObjStr=jSonObj+".org",newDataObj=insertDO,maxUid=Object.keys(eval(orgDataObjStr)).length,curRow,maxTempUid=void 0,maxRow=void 0,i=0;i<Object.keys(eval(chgDataObjStr)).length;i++)curRow=Object.keys(eval(chgDataObjStr))[i],maxRow=curRow,0<=eval(chgDataObjStr)[curRow].uid&&(maxTempUid=eval(chgDataObjStr)[curRow].uid);var nextUid;nextUid=void 0==maxTempUid?maxUid:maxTempUid+1;var nextRow;nextRow=void 0==maxRow?0:1*maxRow+1,addDataObj(jQuery,newDataObj,"uid",nextUid),addDataObj(jQuery,newDataObj,"ROW_STATUS","I"),"Y"==chkAllYn&&addDataObj(jQuery,newDataObj,"CHK",null),addDataObj(jQuery,eval(gridDataObjStr),Object.keys(eval(gridDataObjStr)).length,newDataObj),addDataObj(jQuery,eval(chgDataObjStr),nextRow,newDataObj)}function handsonGridDeleteHandler(jQuery,$scope,jSonObj,selRow,hsContainer){var gridDataObjStr=jSonObj+".grid",chgDataObjStr=jSonObj+".chg",curRowData=eval(gridDataObjStr)[selRow],sameRow=void 0,curRow=void 0,cnt;if(0==Object.keys(eval(chgDataObjStr)).length)addDataObj(jQuery,curRowData,"ROW_STATUS","D"),addDataObj(jQuery,eval(chgDataObjStr),"0",curRowData);else{cnt=0;for(var i=0;i<Object.keys(eval(chgDataObjStr)).length;i++)curRow=Object.keys(eval(chgDataObjStr))[i],eval(chgDataObjStr)[curRow].uid==curRowData.uid&&(cnt++,sameRow=curRow);var nextRow;nextRow=void 0==curRow?0:1*curRow+1,0==cnt?(addDataObj(jQuery,curRowData,"ROW_STATUS","D"),addDataObj(jQuery,eval(chgDataObjStr),nextRow,curRowData)):"I"==curRowData.ROW_STATUS?delete eval(chgDataObjStr)[sameRow]:"U"==curRowData.ROW_STATUS&&(curRowData.ROW_STATUS="D")}hsContainer.handsontable("alter","remove_row",Number(selRow))}function handsonGridUpdateHandler(e,t,r,a,n,o){n.handsontable("getInstance").sortIndex.length>0&&n.handsontable("getInstance").sortIndex.length>a&&(a=n.handsontable("getInstance").sortIndex[a][0]);var l=t[a],d=0,i=void 0;if(0==Object.keys(r).length)addDataObj(e,l,"ROW_STATUS","U"),addDataObj(e,r,"0",l);else{if(void 0==l)return;d=0;for(var c=0;c<Object.keys(r).length;c++)i=Object.keys(r)[c],r[i].uid==l.uid&&(d++,sameRow=i);var s;s=void 0==i?0:1*i+1,0==d&&(addDataObj(e,l,"ROW_STATUS","U"),addDataObj(e,r,s,l))}}function addDataObj(jQuery,dataObj,keyNm,keyVal){eval("jQuery.extend(dataObj, {"+keyNm+": keyVal})")}function addDataMapObj(jQuery,dataObj,keyVal){eval("jQuery.extend(dataObj, keyVal)")}function codeDataInitializer(codeObj,codeColNm,descColNm){if(void 0==codeObj)return"";for(var codeString="",tempCosdeString="",tempDescString="",tempString="",i=0;i<codeObj.length;i++)0!=i&&(codeString+="|| "),tempCosdeString=eval("codeObj["+i+"]."+codeColNm),tempDescString=eval("codeObj["+i+"]."+descColNm),null==tempCosdeString&&null==tempDescString?tempCosdeString="":tempString=(null==tempCosdeString?"":tempCosdeString)+":"+(null==tempDescString?"":tempDescString),codeString=codeString+""+tempString;return codeString}function addUid(e){if(void 0!=e)for(var t=0;t<e.length;t++)addDataObj(jQuery,e[t],"uid",t)}function measureText(e,t,r){var a=document.createElement("lDiv");document.body.appendChild(a),null!=r&&(a.style=r),a.style.fontSize=""+t+"px",a.style.position="absolute",a.style.left=-1e3,a.style.top=-1e3,a.innerHTML=e;var n={width:a.clientWidth,height:a.clientHeight};return document.body.removeChild(a),a=null,n}function getMaxTextByWidth(e,t,r,a){for(var n,o,l=0;l<e.length;l++)if(n=e.substring(0,e.length-l),o=measureText(n,t,r),o.width+3<=a)return n;return e}function customedRenderer(instance,td,row,col,prop,value,cellProperties){var code,desc;if("dropdown"!=cellProperties.type&&"autocomplete"!=cellProperties.type||null==value)"text"==cellProperties.type?Handsontable.renderers.TextRenderer.apply(this,arguments):"textHyperLink"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextHyperLink"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"htTextHyperLinkLeftAlign"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextHyperLinkLeftAlign"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"textCenter"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htTextCenter"),Handsontable.renderers.TextRenderer.apply(this,arguments)):"date"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htDate"),Handsontable.renderers.AutocompleteRenderer.apply(this,arguments)):"numeric"==cellProperties.type?Handsontable.renderers.NumericRenderer.apply(this,arguments):"checkbox"==cellProperties.type?(instance.view.wt.wtDom.addClass(td,"htCheckbox"),arguments[5]=void 0==arguments[5]?!1:arguments[5],Handsontable.renderers.CheckboxRenderer.apply(this,arguments)):"autocomplete"==cellProperties.type?Handsontable.renderers.AutocompleteRenderer.apply(this,arguments):"handsontable"==cellProperties.type?Handsontable.renderers.AutocompleteRenderer.apply(this,arguments):"password"==cellProperties.type?Handsontable.renderers.PasswordRenderer.apply(this,arguments):"dropdown"==cellProperties.type&&Handsontable.renderers.AutocompleteRenderer.apply(this,arguments);else{if(instance.view.wt.wtDom.addClass(td,"htDropdown"),-1==value.indexOf(":")&&value.length>=3){var evalStr="instance.getData()[row]."+arguments[4]+"= ''";eval(evalStr)}Handsontable.renderers.TextRenderer.apply(this,arguments),code=value.match(/.+(?=\:)/gm),null!=code?(code=code.toString(),desc=value.replace(code,"").replace(":","").replace("'",""),td.textContent=desc):td.textContent=""}var displayVal=td.textContent,charactorSize=measureText(displayVal,"10",{font:"Arial"}),displayCharNo=Math.round(td.clientWidth/1.5);void 0!=displayVal&&charactorSize.width>displayCharNo&&("password"!=cellProperties.type&&(displayVal=getMaxTextByWidth(displayVal,"10",{font:"Arial"},displayCharNo)+".."),td.textContent=displayVal);var highlight,eStr="highlight = instance.getData()[row].HIGHLIGHT;";eval(eStr),"Y"==highlight&&$(td).css({background:"#FFEFEF"})}function handsonGridRender(gridData,colHeaders,colWidths,columns,curRowForGrid,hsContainer,$scope,heightVal,readonlyBool,rowHeaders,sortBool,fixedColLeft){("undefined"==typeof fixedColLeft||""==fixedColLeft)&&(fixedColLeft=1),"undefined"==typeof readonlyBool&&(readonlyBool=!0),"undefined"==typeof sortBool&&(sortBool=!0),"undefined"==typeof rowHeaders&&(rowHeaders=!0);for(var gridDataObjStr=gridData+".grid",chgDataObjStr=gridData+".chg",chkAllColumnYn=!1,chkAllBool=!1,chkALlClassNm="",afterRender=!1,i=0;i<columns.length;i++)if("CHK"==columns[i].data){chkAllColumnYn=!0;var chkAllHeaderStr="<input type='checkbox' class='checkAll' />";chkALlClassNm="cls_"+hsContainer.selector.replace("#",""),colHeaders[i]="<input type='checkbox' class='"+chkALlClassNm+"' />";break}hsContainer.handsontable({colHeaders:colHeaders,columns:columns,colWidths:colWidths,columnSorting:sortBool,fillHandle:null,currentRowClassName:"currentRow",currentColClassName:"currentCol",stretchH:"all",height:heightVal,multiSelect:!1,rowHeaders:rowHeaders,manualColumnResize:!0,fixedColumnsLeft:fixedColLeft,afterChange:function(){null!=arguments[0]&&arguments[0][0][2]!=arguments[0][0][3]&&"CHK"!=arguments[0][0][1]&&handsonGridUpdateHandler(jQuery,eval(gridDataObjStr),eval(chgDataObjStr),arguments[0][0][0],hsContainer,$scope)},cells:function(e,t,r){if(void 0==columns[t].renderer){var a={};return a.renderer=customedRenderer,1==readonlyBool?a.readOnly=readonlyBool:void 0!=columns[t].readOnly?a.readOnly=columns[t].readOnly:a.readOnly=readonlyBool,a}},onSelection:function(){eval(curRowForGrid+" = '"+arguments[0]+"'")},afterRender:function(isForced){chkAllColumnYn&&($("."+chkALlClassNm).on("click",function(){chkAllBool=$("."+chkALlClassNm)[0].checked,chkAllBool=void 0==chkAllBool?!1:chkAllBool;for(var i=0;i<Object.keys(eval(gridDataObjStr)).length;i++)eval(gridDataObjStr)[i].CHK=chkAllBool;afterRender=!0}),afterRender&&($("."+chkALlClassNm)[0].checked=chkAllBool))},afterLoadData:function(){chkAllColumnYn&&void 0!=$("."+chkALlClassNm)[0]&&($("."+chkALlClassNm)[0].checked=!1,afterRender=!1)}})}function exceptionHandler(e,t,r,a){"undefined"==typeof r&&(r="Y");var n=window.location.pathname.split("/"),o="";if(n.length<3)for(var l=2;l<n.length;l++)o+="/"+n[l];else for(var l=3;l<n.length;l++)o+="/"+n[l];return $.cookie("CUR_PAGE",encodeURI(o),{expires:1,path:"/"}),$.cookie("CUR_USR_ID",encodeURI(getCookie("USR_ID")),{expires:1,path:"/"}),"0"!=e.ERRORCODE?"99999"==e.ERRORCODE?(alert(e.ERRORMSG),window.location.replace(gWebContext+"/CMM_MAIN.do"),!0):"-5"==e.ERRORCODE?(bootbox.alert(e.ERRORMSG,function(){"undefined"!=typeof a&&window.location.href!=window.opener.location.href?a.close():location.replace(gWebContext+"/web/jsp/cmm/CMM_LOGIN.jsp")}),!0):(bootbox.alert(e.ERRORMSG),!0):("Y"==r&&bootbox.alert(t+" was successfully completed."),!1)}function getUTF8Length(e){for(var t=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);128>a?t++:t+=a>127&&2048>a?2:3}return t}function byteCount(e){return encodeURI(e).split(/%..|./).length-1}function lengthCheck(do_chg,jsonObj){for(var columnNm,maxLength,curLength,curRow,i=0;i<Object.keys(jsonObj).length;i++){columnNm=Object.keys(jsonObj)[i],maxLength=eval("jsonObj."+columnNm);for(var j=0;j<Object.keys(do_chg).length;j++)if(curRow=Object.keys(do_chg)[j],"D"!=do_chg[curRow].ROW_STATUS&&void 0!=eval("do_chg["+curRow+"]."+columnNm)&&(curLength=eval("do_chg["+curRow+"]."+columnNm).length,curLength>maxLength))return bootbox.alert("Please check the maximum length of "+columnNm),!0}return!1}function lengthCheckByRow($scope,str_do_row,curRow,arryObj,hsc){for(var columnVal,columnId,columnNm,maxLength,curLength,curRow,colArr,focusColmn,focusRow,i=0;i<arryObj.length;i++)if(columnVal=arryObj[i],colArr=columnVal.split("||"),columnId=colArr[0],columnNm=colArr[1],maxLength=colArr[2],focusColmn=colArr[3],void 0!=eval(str_do_row+".chg["+curRow+"]."+columnId)&&(curLength=eval(str_do_row+".chg["+curRow+"]."+columnId).length,curLength>maxLength)){for(var curUid=eval(str_do_row+".chg["+curRow+"].uid"),gridDO=eval(str_do_row+".grid"),j=0;j<gridDO.length;j++)gridDO[j].uid==curUid&&(focusRow=j);return bootbox.alert("Please check the maximum length of"+columnNm,function(){hsc.handsontable("selectCell",parseInt(focusRow),parseInt(focusColmn))}),!0}return!1}function a0Chk(e){e.value=e.value.replace(/[^a-zA-Z0-9]/g,"")}function mandantoryColumnCheck(do_chg,arryObj){for(var columnNm,curLength,curRow,i=0;i<Object.keys(arryObj).length;i++){columnNm=arryObj[i];for(var j=0;j<Object.keys(do_chg).length;j++)if(curRow=Object.keys(do_chg)[j],"D"!=do_chg[curRow].ROW_STATUS){if(void 0==eval("do_chg["+curRow+"]."+columnNm))return bootbox.alert(columnNm+" column is the mandatory value to be entered."),!0;if(curLength=eval("do_chg["+curRow+"]."+columnNm).length,0>=curLength||":"==eval("do_chg["+curRow+"]."+columnNm))return bootbox.alert(columnNm+" column is the mandatory value to be entered."),!0}}return!1}function mandantoryColumnCheckByRow($scope,str_do_row,curRow,arryObj,hsc){for(var columnVal,columnId,columnNm,curLength,colArr,focusColmn,focusRow,checkBool=!1,k=0;k<Object.keys(arryObj).length;k++){if(checkBool=!1,columnVal=arryObj[k],colArr=columnVal.split(":"),columnId=colArr[0],columnNm=colArr[1],focusColmn=colArr[2],void 0==columnId||void 0==columnNm||void 0==focusColmn||""==columnId||""==columnNm||""==focusColmn)return;if(void 0==eval(str_do_row+".chg["+curRow+"]."+columnId)?checkBool=!0:(curLength=eval(str_do_row+".chg["+curRow+"]."+columnId).length,0>=curLength&&(checkBool=!0)),checkBool){for(var curUid=eval(str_do_row+".chg["+curRow+"].uid"),gridDO=eval(str_do_row+".grid"),j=0;j<gridDO.length;j++)gridDO[j].uid==curUid&&(focusRow=j);return bootbox.alert(columnNm+" column is the mandatory value to be entered.",function(){hsc.handsontable("selectCell",parseInt(focusRow),parseInt(focusColmn))}),!0}}return!1}function fromToDateColumnCheck(e,t,r,a){for(var n,o,l,d=a.split(r),i=e.split(r),c=t.split(r),s=0;s<d.length;s++)"MM"==d[s]&&(o=s),"DD"==d[s]&&(l=s),"yyyy"==d[s]&&(n=s);var u=new Date;u.setUTCFullYear(1*i[n]),u.setUTCMonth(1*i[o]-1),u.setUTCDate(1*i[l]);var h=new Date;return h.setUTCFullYear(1*c[n]),h.setUTCMonth(1*c[o]-1),h.setUTCDate(1*c[l]),u>h?!1:!0}function setMenuAuth($http,$scope,jQuery,initFunc){var initFuncYn="N";"undefined"!=typeof initFunc&&(initFuncYn="Y");var ctrUrl=gWebContext+"/commonCtr.do",dataObj={},paramDataObj={};addDataObj(jQuery,paramDataObj,"SVC_ID","selectMenuAuth"),addDataObj(jQuery,dataObj,"paramDataObj",paramDataObj),$http.post(ctrUrl,dataObj).success(function(returnData){exceptionHandler(returnData.RESULT,"","N")||($scope.do_trackAuth=returnData.do_trackAuth,$scope.do_uptAuth=returnData.do_uptAuth,$scope.do_rptAuth=returnData.do_rptAuth,$scope.do_adminAuth=returnData.do_adminAuth,$scope.do_todosAuth=returnData.do_todosAuth,$scope.do_user_info=returnData.VARIABLE_MAP,"Y"==initFuncYn&&eval(initFunc))}).error(function(e,t,r,a){alert("error: "+t)})}function logOutFunc(e){null!=$.cookie("CUR_PAGE")&&$.removeCookie("CUR_PAGE",{path:"/"});var t=gWebContext+"/logout.do";e.get(t).success(function(){window.setTimeout(function(){location.href=gWebContext+"/web/jsp/cmm/CMM_LOGIN.jsp"},50)}).error(function(e,t,r,a){return window.setTimeout(function(){location.href=gWebContext+"/web/jsp/cmm/CMM_LOGIN.jsp"},50),t})}function setDataObj(jQuery,$scope,dataObjStr){var tempDataObj={};addDataObj(jQuery,tempDataObj,"org",{}),addDataObj(jQuery,tempDataObj,"grid",{}),addDataObj(jQuery,tempDataObj,"chg",{}),addDataMapObj(jQuery,eval(dataObjStr),tempDataObj)}function returnDataHandler($scope,hsc,curDataObjStr,returnDO){var hsi=hsc.handsontable("getInstance");returnDO=void 0==returnDO?[]:returnDO,addUid(returnDO);var tempDOStr=curDataObjStr+".chg = {}";eval(tempDOStr);var orgDataObj=new Object;orgDataObj=JSON.parse(JSON.stringify(returnDO)),tempDOStr=curDataObjStr+".org = orgDataObj",eval(tempDOStr),tempDOStr=curDataObjStr+".grid = returnDO",eval(tempDOStr);var evalReset="hsi.loadData(null)";eval(evalReset);var evalStr="hsi.loadData("+tempDOStr+")";eval(evalStr),hsi.render()}function gridReadOnlyByRowHandler(e,t,r,a){t.handsontable({cells:function(e,t,n){var o={};return o.renderer=customedRenderer,void 0!=n&&e==r&&(o.readOnly=a),o}})}function gridReadOnlyToggleHandler(e,t,r,a,n,o,l){if(0==$("#"+n).attr("disabled")||void 0==$("#"+n).attr("disabled")){t.handsontable({cells:function(e,t,r){var a={};return a.readOnly=!0,a.renderer=customedRenderer,a}}),$("#"+n).attr("disabled",!0);for(var d=0;d<o.length;d++)$("#"+o[d]).hide();for(var d=0;d<l.length;d++)$("#"+l[d]).attr("disabled",!0)}else{t.handsontable({cells:function(e,t,n){for(var o={},l=0;l<a.length;l++)void 0!=r[e]&&n==a[l]&&(o.readOnly=!0);return o.renderer=customedRenderer,o}}),$("#"+n).attr("disabled",!1);for(var d=0;d<o.length;d++)$("#"+o[d]).show();for(var d=0;d<l.length;d++)$("#"+l[d]).attr("disabled",!1)}}function componentReadOnlyToggleHandler(e,t){if(0==$("#"+e).attr("disabled")||void 0==$("#"+e).attr("disabled")){for(var r=0;r<t.length;r++)$("#"+t[r]).attr("disabled",!0);$("#"+e).attr("disabled",!0)}else{for(var r=0;r<t.length;r++)$("#"+t[r]).attr("disabled",!1);$("#"+e).attr("disabled",!1)}}function cfn_objIsNull(e){return Object.keys(e).length>0?!1:!0}function cfn_undfToNull(e){var t="";return void 0!=e&&(t=e),t}function cfn_chkCount(e){for(var t=0,r=0;r<e.length;r++)1==e[r].CHK&&t++;return t}function getCodeFromName($scope,jQuery,dataObjStr,compareVal){for(var returnVal,i=0;i<Object.keys(eval(dataObjStr)).length;i++)if(eval(dataObjStr)[i].NAME==compareVal){returnVal=eval(dataObjStr)[i].CODE;break}return returnVal}function getCodeVal(e,t){var r="";if(""!=e){var a=e.indexOf(t);a>1&&(r=e.substring(0,a).trim())}return r}function getNameVal(e,t){var r="";if(""!=e){var a=e.indexOf(t)+1;a>1&&(r=e.substring(a,100).trim())}return r}function excelLoadHandler(e,t,r,a){a.readFile(e.excelFile,e.showPreview).then(function(t){e.sheets=t.sheets})}function DownloadJSON2CSV(e){for(var t="object"!=typeof e?JSON.parse(e):e,r="",a="",n="",o="",l=0;l<t.length;l++){var d="";if(0==l)for(var i in t[l])""!=d&&(d+=","),d+=JSON.stringify(t[l][i]);else for(var c=0;c<Object.keys(t[0]).length;c++)a=Object.keys(t[0])[c],0!=c&&(d+=","),n=JSON.stringify(void 0!=t[l][a]?t[l][a]:""),d+=n;r+=d+"\r\n"}if("Microsoft Internet Explorer"!=navigator.appName)o="data:text/csv;charset=utf-8,"+escape(r),window.open(o);else{var s=window.open("","csv","");s.document.body.innerHTML="<pre>"+r,o="data:text/csv;charset=utf-8,"}}function handsontableToJsonHandler(e,t,r){for(var a=[],n={},o="",l=t.handsontable("getColHeader"),d=(t.handsontable("getRowHeader"),0);d<Object.keys(l).length;d++)o=t.handsontable("getInstance").getSettings().columns[d].data,"CHK"!=o&&addDataObj(jQuery,n,o,l[d]);a.push(JSON.parse(JSON.stringify(n)));for(var d=0;d<Object.keys(r).length;d++){a.push(JSON.parse(JSON.stringify(r[d]))),void 0!=a[a.length-1].uid&&delete a[a.length-1].uid,delete a[a.length-1].CHK;for(var i=0;i<Object.keys(l).length;i++)void 0!=a[a.length-1].uid}return a}function jsonToCSVStrHandler(e){for(var t="object"!=typeof e?JSON.parse(e):e,r="",a="",n="",o=0;o<t.length;o++){var l="";if(0==o)for(var d in t[o])""!=l&&(l+=","),l+=JSON.stringify(t[o][d]);else for(var i=0;i<Object.keys(t[0]).length;i++)a=Object.keys(t[0])[i],0!=i&&(l+=","),n=JSON.stringify(void 0!=t[o][a]?t[o][a]:""),l+=n;r+=l+"\r\n"}return r}function isIE(){return"Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)}function exportToCSV(e,t,r,a,n,o){if(r.length>6e3)return void bootbox.alert("There are too many data(rows) to be downloaded in CSV format.");var l=handsontableToJsonHandler(e,t,r),d=jsonToCSVStrHandler(l),i="data:text/csv;charset=utf-8,"+escape(d);if(isIE()){var c={IsIe:function(){return-1!=navigator.appVersion.indexOf("MSIE")},Navigator:navigator.appVersion,Version:function(){var e=999;return-1!=navigator.appVersion.indexOf("MSIE")&&(e=parseFloat(navigator.appVersion.split("MSIE")[1])),e}};if(c.IsIe&&c.Version()<=9)return void bootbox.alert("csv download function does not support Internet Explorer version 9 or lower.");document.createElement("a");if(window.navigator.msSaveOrOpenBlob){var s=new Blob([d]);window.navigator.msSaveOrOpenBlob(s,o)}}else{var u=document.createElement("a");u.innerHTML="Export to CSV",u.setAttribute("download",o),u.href=i,document.body.appendChild(u),u.click()}}function downloadWithName(e,t){function r(e,t){if(e.fireEvent)e.fireEvent("on"+t);else{var r=document.createEvent("Events");r.initEvent(t,!0,!1),e.dispatchEvent(r)}}var a=document.createElement("a");a.download=t,a.href=e,r(a,"click")}function getCookie(e){e+="=";var t=document.cookie,r=t.indexOf(e),a="";if(-1!=r){r+=e.length;var n=t.indexOf(";",r);-1==n&&(n=t.length),a=t.substring(r,n)}return unescape(a)}function cfn_myInfoOpen(e){alert(e)}function cfn_chkPw(e){var t=/^.{6,20}$/;return t.test(e)}function postRequestPopupHandler(e,t,r,a,n){"undefined"==typeof n&&(n="N");var o=document.createElement("form");o.setAttribute("method","post"),o.setAttribute("action",e);var l,d;if("Y"==n){var i=e.split("/");d=i[i.length-1].replace(/[_.\/]/g,""),l=d}else l=guid();o.setAttribute("target",l);for(var c,s=0;s<Object.keys(t).length;s++)curColumn=Object.keys(t)[s],c=document.createElement("input"),c.setAttribute("type","hidden"),c.setAttribute("id",curColumn),c.setAttribute("name",curColumn),c.setAttribute("value",t[curColumn]),o.appendChild(c);document.body.appendChild(o);var u=screen.availWidth,h=screen.availHeight,g=(u-r)/2,m=(h-a)/2;window.open(e,l,"scrollbars=yes,menubar=no,height="+a+",width="+r+",left="+g+",top="+m+",resizable=yes,toolbar=no,status=no"),o.submit()}function guid(){function e(e){var t=(Math.random().toString(16)+"000000000").substr(2,8);return e?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return e()+e()+e()+e()}function authHandling(e,t){if("Y"==t.VARIABLE_MAP.PERMS_YN)"Y"!=t.VARIABLE_MAP.MODI_YN&&e(".cudAuthCtr").remove();else{var r=window.location.pathname.split("/"),a="";if(r.length<3)for(var n=2;n<r.length;n++)a+="/"+r[n];else for(var n=3;n<r.length;n++)a+="/"+r[n];a!=getCookie("CUR_PAGE")?location.replace(gWebContext+"/web"+getCookie("CUR_PAGE")):location.replace(gWebContext+"/web/jsp/cmm/CMM_LOGIN.jsp")}return"Y"==t.VARIABLE_MAP.MODI_YN?!0:!1}function formattedDate(e){var t=e.toISOString();return result=t.replace(/^(\d{4})\-(\d{2})\-(\d{2}).*$/,"$2/$3/$1"),result}function subtractDate(e,t){return void 0!=t&&e.setDate(e.getDate()-t),e}function isDate(e){var t=e;if(""==t)return!1;var r=/^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,a=t.match(r);if(null==a)return!1;if(dtMonth=a[1],dtDay=a[3],dtYear=a[5],dtMonth<1||dtMonth>12)return!1;if(dtDay<1||dtDay>31)return!1;if((4==dtMonth||6==dtMonth||9==dtMonth||11==dtMonth)&&31==dtDay)return!1;if(2==dtMonth){var n=dtYear%4==0&&(dtYear%100!=0||dtYear%400==0);if(dtDay>29||29==dtDay&&!n)return!1}return!0}function isTwoObjDiffer(e,t){for(var r,a=0;a<Object.keys(e).length;a++)if(r=Object.keys(e)[a],e[r]!=t[r])return!1;return!0}function differenceInDays(e,t){var r=e.split("/"),a=t.split("/"),n=new Date(r[2],r[0],r[1]),o=new Date(a[2],a[0],a[1]),l=864e5,d=o.getTime()-n.getTime(),i=d/l;return Math.floor(i)}function isAlpha(e){var t=/[^a-zA-Z]/;return!t.test(e)}jQuery.fn.extend({numberOnly:function(){return this.each(function(){try{var e=$(this),t=17,r=86,a=!1;e.css("ime-mode","disabled"),e.keydown(function(n){var o=e.val().length,l=n.keyCode,d=l>57?String.fromCharCode(l-48):String.fromCharCode(l),i=/^[0-9]+$/;if(l>=112&&113>=l||1==l||8==l||9==l||13==l||46==l||37==l||38==l||39==l||40==l)return!0;if(l==t)return a=!0,!0;if(1==a&&l==r)return a=!1,!0;var c=e.val().length;return i.test(d)?!0:(o!=c&&e.val(e.val().substring(0,c-1)),!1)}),e.focus(function(){e.val(e.val().replace(/,/g,""))})}catch(n){alert("[common.js's numberFormat] "+n.description)}})}});