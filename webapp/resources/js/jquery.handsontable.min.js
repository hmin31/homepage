var Handsontable={extension:{},plugins:{},helper:{}};!function(t,e,o){"use strict";function n(){this.refCounter=0,this.init()}function i(){function t(){var t=this;t.registerTimeout("enableObserveChanges",function(){t.updateSettings({observeChanges:!0})},0)}function e(t){return function(e,o){return e[1]===o[1]?0:null===e[1]?1:null===o[1]?-1:e[1]<o[1]?t?-1:1:e[1]>o[1]?t?1:-1:0}}function o(t){return function(e,o){if(e[1]===o[1])return 0;if(null===e[1])return 1;if(null===o[1])return-1;var n=new Date(e[1]),i=new Date(o[1]);return i>n?t?-1:1:n>i?t?1:-1:0}}function n(t){return"undefined"!=typeof t.sortColumn}var i=this;this.init=function(e){var o,n,r=this,l=r.getSettings().columnSorting;if(r.sortingEnabled=!!l,r.sortingEnabled){r.sortIndex=[];var c=s.call(r);"undefined"!=typeof c?(o=c.sortColumn,n=c.sortOrder):(o=l.column,n=l.sortOrder),i.sortByColumn.call(r,o,n),r.sort=function(){var t=Array.prototype.slice.call(arguments);return i.sortByColumn.apply(r,t)},"undefined"==typeof r.getSettings().observeChanges&&t.call(r),"afterInit"==e&&(a.call(r),r.addHook("afterCreateRow",i.afterCreateRow),r.addHook("afterRemoveRow",i.afterRemoveRow),r.addHook("afterLoadData",i.init))}else delete r.sort,r.removeHook("afterCreateRow",i.afterCreateRow),r.removeHook("afterRemoveRow",i.afterRemoveRow),r.removeHook("afterLoadData",i.init)},this.setSortingColumn=function(t,e){var o=this;return"undefined"==typeof t?(delete o.sortColumn,void delete o.sortOrder):(o.sortColumn===t&&"undefined"==typeof e?o.sortOrder=!o.sortOrder:o.sortOrder="undefined"!=typeof e?e:!0,void(o.sortColumn=t))},this.sortByColumn=function(t,e){var o=this;i.setSortingColumn.call(o,t,e),"undefined"!=typeof o.sortColumn&&(o.PluginHooks.run("beforeColumnSort",o.sortColumn,o.sortOrder),i.sort.call(o),o.render(),r.call(o),o.PluginHooks.run("afterColumnSort",o.sortColumn,o.sortOrder))};var r=function(){var t=this,e={};"undefined"!=typeof t.sortColumn&&(e.sortColumn=t.sortColumn),"undefined"!=typeof t.sortOrder&&(e.sortOrder=t.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&t.PluginHooks.run("persistentStateSave","columnSorting",e)},s=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","columnSorting",e),e.value},a=function(){function t(){var t=o.view.TBODY.querySelector("tr").querySelectorAll("th");return t.length}function e(e){var n=o.view.wt.wtDom.closest(e,"TH");return o.view.wt.wtDom.index(n)-t()}var o=this;o.rootElement.on("click.handsontable",".columnSorting",function(t){if(o.view.wt.wtDom.hasClass(t.target,"columnSorting")){var n=e(t.target);i.sortByColumn.call(o,n)}})};this.sort=function(){var t=this;if("undefined"!=typeof t.sortOrder){t.sortingEnabled=!1,t.sortIndex.length=0;for(var n=this.colOffset(),i=0,r=this.countRows()-t.getSettings().minSpareRows;r>i;i++)this.sortIndex.push([i,t.getDataAtCell(i,this.sortColumn+n)]);var s,a=t.getCellMeta(0,t.sortColumn);switch(a.type){case"date":s=o;break;default:s=e}this.sortIndex.sort(s(t.sortOrder));for(var i=this.sortIndex.length;i<t.countRows();i++)this.sortIndex.push([i,t.getDataAtCell(i,this.sortColumn+n)]);t.sortingEnabled=!0}},this.translateRow=function(t){var e=this;return e.sortingEnabled&&e.sortIndex&&e.sortIndex.length&&e.sortIndex[t]?e.sortIndex[t][0]:t},this.onBeforeGetSet=function(t){var e=this;t.row=i.translateRow.call(e,t.row)},this.untranslateRow=function(t){var e=this;if(e.sortingEnabled&&e.sortIndex&&e.sortIndex.length)for(var o=0;o<e.sortIndex.length;o++)if(e.sortIndex[o][0]==t)return o},this.getColHeader=function(t,e){this.getSettings().columnSorting&&this.view.wt.wtDom.addClass(e.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(t,e){var o=this;if(n(o)){for(var i=0;i<o.sortIndex.length;i++)o.sortIndex[i][0]>=t&&(o.sortIndex[i][0]+=e);for(var i=0;e>i;i++)o.sortIndex.splice(t+i,0,[t+i,o.getData()[t+i][o.sortColumn+o.colOffset()]]);r.call(o)}},this.afterRemoveRow=function(t,e){var o=this;if(n(o)){var s=i.translateRow.call(o,t);o.sortIndex.splice(t,e);for(var a=0;a<o.sortIndex.length;a++)o.sortIndex[a][0]>s&&(o.sortIndex[a][0]-=e);r.call(o)}},this.afterChangeSort=function(t){var e=this,o=!1,n={};if(t){for(var r=0;r<t.length;r++)if(t[r][1]==e.sortColumn){o=!0,n.row=i.translateRow.call(e,t[r][0]),n.col=t[r][1];break}o&&setTimeout(function(){i.sort.call(e),e.render(),e.selectCell(i.untranslateRow.call(e,n.row),n.col)},0)}}}function r(){var e,o,n,i,r,s=document.createElement("DIV"),a=s.style;s.className="ghost",a.position="absolute",a.top="25px",a.left=0,a.width="10px",a.height="10px",a.backgroundColor="#CCC",a.opacity=.7;var l=function(){var t=this;t.PluginHooks.run("persistentStateSave","manualColumnPositions",t.manualColumnPositions)},c=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","manualColumnPositions",e),e.value},h=function(){var c=this;c.rootElement.on("mousemove.manualColumnMove",function(t){e&&(a.left=r+t.pageX-i+6+"px","none"===a.display&&(a.display="block"))}),c.rootElement.on("mouseup.manualColumnMove",function(){e&&(n>o&&n--,c.getSettings().rowHeaders&&(o--,n--),c.manualColumnPositions.splice(n,0,c.manualColumnPositions.splice(o,1)[0]),t(".manualColumnMover.active").removeClass("active"),e=!1,c.forceFullRender=!0,c.view.render(),a.display="none",l.call(c),c.PluginHooks.run("afterColumnMove",o,n))}),c.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(t){var l=t.currentTarget,h=c.view.wt.wtDom.closest(l,"TH");o=c.view.wt.wtDom.index(h)+c.colOffset(),n=o,e=!0,i=t.pageX;var u=c.$table[0];u.parentNode.appendChild(s),a.width=c.view.wt.wtDom.outerWidth(h)+"px",a.height=c.view.wt.wtDom.outerHeight(u)+"px",r=parseInt(c.view.wt.wtDom.offset(h).left-c.view.wt.wtDom.offset(u).left,10),a.left=r+6+"px"}),c.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(e){var t=c.view.THEAD.querySelector(".manualColumnMover.active");t&&c.view.wt.wtDom.removeClass(t,"active"),n=c.view.wt.wtDom.index(this)+c.colOffset();var o=c.view.THEAD.querySelectorAll("th"),i=o[n].querySelector(".manualColumnMover");c.view.wt.wtDom.addClass(i,"active")}}),c.addHook("afterDestroy",u)},u=function(){var t=this;t.rootElement.off("mouseup.manualColumnMove"),t.rootElement.off("mousemove.manualColumnMove"),t.rootElement.off("mousedown.manualColumnMove"),t.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(t){var e=this,o=!!this.getSettings().manualColumnMove;if(o){var n=this.getSettings().manualColumnMove,i=c.call(e);"undefined"!=typeof i?this.manualColumnPositions=i:n instanceof Array?this.manualColumnPositions=n:this.manualColumnPositions=[],e.forceFullRender=!0,"afterInit"==t&&(h.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else u.call(this),this.manualColumnPositions=[]},this.modifyCol=function(t){return this.getSettings().manualColumnMove?("undefined"==typeof this.manualColumnPositions[t]&&(this.manualColumnPositions[t]=t),this.manualColumnPositions[t]):t},this.getColHeader=function(t,e){if(this.getSettings().manualColumnMove){var o=document.createElement("DIV");o.className="manualColumnMover",e.firstChild.appendChild(o)}}}function s(){function e(t){a=this,i=t;var e=this.view.wt.wtTable.getCoords(t)[1];if(e>=0){r=e;var o=this.view.wt.wtDom.offset(this.rootElement[0]).left,n=this.view.wt.wtDom.offset(t).left;u=n-o-6,d.style.left=u+parseInt(this.view.wt.wtDom.outerWidth(t),10)+"px",this.rootElement[0].appendChild(d)}}function o(){var t=this;h=parseInt(this.view.wt.wtDom.outerWidth(i),10),t.view.wt.wtDom.addClass(d,"active"),g.height=t.view.wt.wtDom.outerHeight(t.$table[0])+"px",n=t}var n,i,r,s,a,l,c,h,u,d=document.createElement("DIV"),p=document.createElement("DIV"),f=document.createElement("DIV"),g=f.style;d.className="manualColumnResizer",p.className="manualColumnResizerHandle",d.appendChild(p),f.className="manualColumnResizerLine",d.appendChild(f);var m=t(document);m.mousemove(function(t){n&&(s=h+(t.pageX-c),l=C(r,s),d.style.left=u+s+"px")}),m.mouseup(function(){n&&(a.view.wt.wtDom.removeClass(d,"active"),n=!1,l!=h&&(a.forceFullRender=!0,a.view.render(),w.call(a),a.PluginHooks.run("afterColumnResize",r,l)),e.call(a,i))});var w=function(){var t=this;t.PluginHooks.run("persistentStateSave","manualColumnWidths",t.manualColumnWidths)},y=function(){var t=this,e={};return t.PluginHooks.run("persistentStateLoad","manualColumnWidths",e),e.value},v=function(){var t=this,i=0,s=null;this.rootElement.on("mouseenter.handsontable","th",function(o){n||e.call(t,o.currentTarget)}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){null==s&&(s=setTimeout(function(){i>=2&&(l=t.determineColumnWidth.call(t,r),C(r,l),t.forceFullRender=!0,t.view.render(),t.PluginHooks.run("afterColumnResize",r,l)),i=0,s=null},500)),i++}),this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){c=e.pageX,o.call(t),l=h})};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(t){var e=this,o=!!this.getSettings().manualColumnResize;if(o){var n=this.getSettings().manualColumnResize,i=y.call(e);"undefined"!=typeof i?this.manualColumnWidths=i:n instanceof Array?this.manualColumnWidths=n:this.manualColumnWidths=[],"afterInit"==t&&(v.call(this),e.forceFullRender=!0,e.render())}};var C=function(t,e){return e=Math.max(e,20),t=a.PluginHooks.execute("modifyCol",t),a.manualColumnWidths[t]=e,e};this.getColWidth=function(t,e){this.getSettings().manualColumnResize&&this.manualColumnWidths[t]&&(e.width=this.manualColumnWidths[t])}}function a(t){var o,n=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(o)},i=function(){var n=e.localStorage[t+"__persistentStateKeys"],i="string"==typeof n?JSON.parse(n):void 0;o=i?i:[]},r=function(){o=[],n()};i(),this.saveValue=function(i,r){e.localStorage[t+"_"+i]=JSON.stringify(r),-1==o.indexOf(i)&&(o.push(i),n())},this.loadValue=function(o,n){o="undefined"!=typeof o?o:n;var i=e.localStorage[t+"_"+o];return"undefined"==typeof i?void 0:JSON.parse(i)},this.reset=function(o){e.localStorage.removeItem(t+"_"+o)},this.resetAll=function(){for(var n=0;n<o.length;n++)e.localStorage.removeItem(t+"_"+o[n]);r()}}function l(){this.boundaries=null,this.callback=null}function c(){this.maxOuts=10}function h(e,o){var n;this.instance=e,this.settings=o,this.wtDom=this.instance.wtDom,this.main=document.createElement("div"),n=this.main.style,n.position="absolute",n.top=0,n.left=0;for(var i=0;5>i;i++){var r=document.createElement("DIV");r.className="wtBorder "+(o.className||""),n=r.style,n.backgroundColor=o.border.color,n.height=o.border.width+"px",n.width=o.border.width+"px",this.main.appendChild(r)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width="5px",this.cornerStyle.height="5px",this.cornerStyle.border="2px solid #FFF",this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.appendChild(this.main);var s=!1,a=t(document.body);a.on("mousedown.walkontable."+e.guid,function(){s=!0}),a.on("mouseup.walkontable."+e.guid,function(){s=!1}),t(this.main.childNodes).on("mouseenter",function(o){if(s&&e.getSetting("hideBorderOnMouseDownOver")){o.preventDefault(),o.stopImmediatePropagation();var n=this.getBoundingClientRect(),i=t(this);i.hide();var r=function(t){return t.clientY<Math.floor(n.top)?!0:t.clientY>Math.ceil(n.top+n.height)?!0:t.clientX<Math.floor(n.left)?!0:t.clientX>Math.ceil(n.left+n.width)?!0:void 0};a.on("mousemove.border."+e.guid,function(t){r(t)&&(a.off("mousemove.border."+e.guid),i.show())})}})}function u(){this.offset=0,this.total=0,this.fixedCount=0}function d(t){this.instance=t}function p(){this.cache=[]}function f(){this.countTH=0}function g(t,e,o,n){var i,r=0;for(d.apply(this,arguments),this.containerSizeFn=e,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.remainingSize=0,this.strategy=n;;){if(i=o(r),void 0===i)break;if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+i))break;this.cellSizes.push(i),this.cellSizesSum+=i,this.cellCount++,r++}var s=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-s}function m(t){var e=this,o=[];if(this.guid="wt_"+C(),this.wtDom=new y,t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new P(this,t.table),this.wtScroll=new T(this),this.wtViewport=t.cloneSource.wtViewport):(this.wtSettings=new A(this,t),this.wtTable=new P(this,t.table),this.wtScroll=new T(this),this.wtViewport=new O(this),this.wtScrollbars=new H(this),this.wtWheel=new M(this),this.wtEvent=new v(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;i>n;n++)o.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(t,n){e.wtDom.fastInnerText(n,o[t])}])}this.selections={};var r=this.getSetting("selections");if(r)for(var s in r)r.hasOwnProperty(s)&&(this.selections[s]=new k(this,r[s]));this.drawn=!1,this.drawInterrupted=!1}function w(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000";var o,n=this,i=0,r=0,s=n.clone.wtTable.holder.parentNode;t(document.body).on("mousemove."+this.instance.guid,function(t){n.instance.wtTable.holder.parentNode&&(t.clientX-i>-5&&t.clientX-i<5&&t.clientY-r>-5&&t.clientY-r<5||(i=t.clientX,r=t.clientY,y.prototype.addClass(s,"wtDebugHidden"),y.prototype.removeClass(s,"wtDebugVisible"),clearTimeout(o),o=setTimeout(function(){y.prototype.removeClass(s,"wtDebugHidden"),y.prototype.addClass(s,"wtDebugVisible")},1e3)))})}function y(){}function v(e){var o=this;this.instance=e,this.wtDom=this.instance.wtDom;var n,i=[null,null],r=[null,null],s=function(t){var e=o.parentCell(t.target);o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerMouseDown",t,t.target):e.TD&&"TD"===e.TD.nodeName&&o.instance.hasSetting("onCellMouseDown")&&o.instance.getSetting("onCellMouseDown",t,e.coords,e.TD),2!==t.button&&e.TD&&"TD"===e.TD.nodeName&&(i[0]=e.TD,clearTimeout(r[0]),r[0]=setTimeout(function(){i[0]=null},1e3))},a=function(t){if(o.instance.hasSetting("onCellMouseOver")){var e=o.instance.wtTable.TABLE,i=o.wtDom.closest(t.target,["TD","TH"],e);i&&i!==n&&o.wtDom.isChildOf(i,e)&&(n=i,"TD"===i.nodeName&&o.instance.getSetting("onCellMouseOver",t,o.instance.wtTable.getCoords(i),i))}},l=function(t){if(2!==t.button){var e=o.parentCell(t.target);e.TD===i[0]&&e.TD===i[1]?(o.wtDom.hasClass(t.target,"corner")?o.instance.getSetting("onCellCornerDblClick",t,e.coords,e.TD):e.TD&&o.instance.getSetting("onCellDblClick",t,e.coords,e.TD),i[0]=null,i[1]=null):e.TD===i[0]&&(i[1]=e.TD,clearTimeout(r[1]),r[1]=setTimeout(function(){i[1]=null},500))}};t(this.instance.wtTable.holder).on("mousedown",s),t(this.instance.wtTable.TABLE).on("mouseover",a),t(this.instance.wtTable.holder).on("mouseup",l)}function C(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+t()+t()}function b(){}function S(t,e,o){d.apply(this,arguments),this.containerSizeFn=e,this.sizeAtIndex=o,this.cellSizesSum=0,this.cellSizes=[],this.cellCount=0,this.remainingSize=-(1/0)}function T(t){this.instance=t}function R(){}function E(t){this.instance=t,this.init(),this.clone=this.makeClone("corner")}function x(t){this.instance=t,this.type="horizontal",this.cellSize=50,this.init(),this.clone=this.makeClone("left")}function D(t){this.instance=t,this.type="vertical",this.cellSize=23,this.init(),this.clone=this.makeClone("top")}function H(t){this.instance=t,t.getSetting("nativeScrollbars")?(t.update("scrollbarWidth",t.wtDom.getScrollbarWidth()),t.update("scrollbarHeight",t.wtDom.getScrollbarWidth()),this.vertical=new D(t),this.horizontal=new x(t),this.corner=new E(t),t.getSetting("debug")&&(this.debug=new w(t)),this.registerListeners()):(this.vertical=new $(t),this.horizontal=new G(t))}function k(t,e){this.instance=t,this.settings=e,this.selected=[],e.border&&(this.border=new h(t,e))}function A(t,e){var o=this;this.instance=t,this.defaults={table:void 0,debug:!1,scrollH:"auto",scrollV:"auto",nativeScrollbars:!1,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(t,e,n){var i=o.getSetting("data",t,e);o.instance.wtDom.fastInnerText(n,void 0===i||null===i?"":i)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onScrollVertically:null,onScrollHorizontally:null,scrollbarWidth:10,scrollbarHeight:10},this.settings={};for(var n in this.defaults)if(this.defaults.hasOwnProperty(n))if(void 0!==e[n])this.settings[n]=e[n];else{if(void 0===this.defaults[n])throw new Error('A required setting "'+n+'" was not provided');this.settings[n]=this.defaults[n]}}function P(t,e){this.instance=t,this.TABLE=e,this.wtDom=this.instance.wtDom,this.wtDom.removeTextNodes(this.TABLE);var o=this.TABLE.parentNode;if(!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var n=document.createElement("DIV");n.className="wtSpreader",o&&o.insertBefore(n,this.TABLE),n.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,o=this.spreader.parentNode,!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var i=document.createElement("DIV");i.className="wtHider",o&&o.insertBefore(i,this.spreader),i.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",o=this.hider.parentNode,!o||1!==o.nodeType||!this.wtDom.hasClass(o,"wtHolder")){var r=document.createElement("DIV");r.style.position="relative",r.className="wtHolder",o&&o.insertBefore(r,this.hider),r.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.oldCellCache=new p,this.currentCellCache=new p,this.rowFilter=new b,this.columnFilter=new f,this.verticalRenderReverse=!1}function O(o){if(this.instance=o,this.resetSettings(),this.instance.getSetting("nativeScrollbars")){var n=this;t(e).on("resize",function(){n.clientHeight=n.getWorkspaceHeight()})}}function M(e){e.getSetting("nativeScrollbars")||t(e.wtTable.spreader).on("mousewheel",function(t,o,n,i){n||i||!o||(i=o),(n||i)&&(i>0&&0===e.getSetting("offsetRow")||0>i&&e.wtTable.isLastRowFullyVisible()||0>n&&0===e.getSetting("offsetColumn")||n>0&&e.wtTable.isLastColumnFullyVisible()||(clearTimeout(e.wheelTimeout),e.wheelTimeout=setTimeout(function(){i?e.wtScrollbars.vertical.visible&&e.scrollVertical(-Math.ceil(i)).draw():n&&e.wtScrollbars.horizontal.visible&&e.scrollHorizontal(Math.ceil(n)).draw()},0),t.preventDefault()))})}Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var e=this.length>>>0,o=Number(arguments[1])||0;for(o=0>o?Math.ceil(o):Math.floor(o),0>o&&(o+=e);e>o;o++)if(o in this&&this[o]===t)return o;return-1}),Array.prototype.filter||(Array.prototype.filter=function(t,e){function o(t){return/NodeList/i.test(t.item)}function n(t){for(var e=[],o=0,n=t.length;n>o;o++)e[o]=t[o];return e}if("undefined"==typeof this||null===this)throw new TypeError;if("function"!=typeof t)throw new TypeError;e=e||this,o(e)&&(e=n(e));var i,r,s=e.length,a=[];for(i=0;s>i;i+=1)e.hasOwnProperty(i)&&(r=e[i],t.call(e,r,i,e)&&a.push(r));return a}),"undefined"==typeof WeakMap&&!function(){var t=Object.defineProperty;try{var o=!0;t(function(){},"foo",{})}catch(n){o=!1}var i=+new Date%1e9,r=function(){this.name="__st"+(1e9*Math.random()>>>0)+(i++ +"__"),o||(this._wmCache=[])};o?r.prototype={set:function(e,o){var n=e[this.name];n&&n[0]===e?n[1]=o:t(e,this.name,{value:[e,o],writable:!0})},get:function(t){var e;return(e=t[this.name])&&e[0]===t?e[1]:void 0},"delete":function(t){this.set(t,void 0)}}:r.prototype={set:function(t,e){if("undefined"!=typeof t&&"undefined"!=typeof e){for(var o=0,n=this._wmCache.length;n>o;o++)if(this._wmCache[o].key==t)return void(this._wmCache[o].value=e);this._wmCache.push({key:t,value:e})}},get:function(t){if("undefined"!=typeof t)for(var e=0,o=this._wmCache.length;o>e;e++)if(this._wmCache[e].key==t)return this._wmCache[e].value},"delete":function(t){if("undefined"!=typeof t)for(var e=0,o=this._wmCache.length;o>e;e++)this._wmCache[e].key==t&&Array.prototype.slice.call(this._wmCache,e,1)}},e.WeakMap=r}(),o.activeGuid=null,o.Core=function(n,i){function r(){var t=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,t=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==t&&(t=!0,this.onQueueEmpty())}}}function s(e,o,n){function i(){var i;e.length&&(i=m.PluginHooks.execute("beforeChange",e,o),"function"==typeof i?t.when(result).then(function(){n()}):i===!1&&e.splice(0,e.length)),"function"!=typeof i&&n()}var s=new r;s.onQueueEmpty=i;for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var l=e[a][0],c=u.propToCol(e[a][1]),h=m.runHooksAndReturn("modifyCol",c),d=m.getCellMeta(l,h);"numeric"===d.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(e[a][3])&&(e[a][3]=numeral().unformat(e[a][3]||"0")),m.getCellValidator(d)&&(s.addValidatorToQueue(),m.validateCell(e[a][3],d,function(t,o){return function(n){if("boolean"!=typeof n)throw new Error("Validation error: result is not boolean");n===!1&&o.allowInvalid===!1&&(e.splice(t,1),o.valid=!0,--t),s.removeValidatorFormQueue()}}(a,d),o))}s.checkIfQueueIsEmpty()}function a(t,e){var o=t.length-1;if(!(0>o)){for(;o>=0;o--)if(null!==t[o]){if(h.settings.minSpareRows)for(;t[o][0]>m.countRows()-1;)u.createRow();if("array"===m.dataType&&h.settings.minSpareCols)for(;u.propToCol(t[o][1])>m.countCols()-1;)u.createCol();u.set(t[o][0],t[o][1],t[o][3])}else t.splice(o,1);m.forceFullRender=!0,d.adjustRowsAndCols(),p.refreshBorders(null,!0),m.PluginHooks.run("afterChange",t,e||"edit")}}function l(e,o,n){return"object"==typeof e?e:t.isPlainObject(n)?n:[[e,o,n]]}function c(t){if(t.hasOwnProperty("type")){var e,n={};if("object"==typeof t.type)e=t.type;else if("string"==typeof t.type&&(e=o.cellTypes[t.type],void 0===e))throw new Error('You declared cell type "'+t.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&(n[i]=e[i]);return n}}var h,u,d,p,f,g,m=this,w=function(){};o.helper.extend(w.prototype,N.prototype),o.helper.extend(w.prototype,i),o.helper.extend(w.prototype,c(i)),this.rootElement=n;var y=t(document.documentElement),v=t(document.body);this.guid="ht_"+o.helper.randomString(),this.rootElement[0].id||(this.rootElement[0].id=this.guid),h={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new w,settingsFromDOM:{},selStart:new o.SelectionPoint,selEnd:new o.SelectionPoint,isPopulated:null,scrollable:null,extensions:{},firstRun:!0},d={alter:function(t,e,n,i,r){var s;switch(n=n||1,t){case"insert_row":s=u.createRow(e,n),s&&(h.selStart.exists()&&h.selStart.row()>=e?(h.selStart.row(h.selStart.row()+s),p.transformEnd(s,0)):p.refreshBorders());break;case"insert_col":if(s=u.createCol(e,n)){if(o.helper.isArray(m.getSettings().colHeaders)){var a=[e,0];a.length+=s,Array.prototype.splice.apply(m.getSettings().colHeaders,a)}h.selStart.exists()&&h.selStart.col()>=e?(h.selStart.col(h.selStart.col()+s),p.transformEnd(0,s)):p.refreshBorders()}break;case"remove_row":u.removeRow(e,n),h.cellSettings.splice(e,n),d.adjustRowsAndCols(),p.refreshBorders();break;case"remove_col":u.removeCol(e,n);for(var l=0,c=u.getAll().length;c>l;l++)l in h.cellSettings&&h.cellSettings[l].splice(e,n);o.helper.isArray(m.getSettings().colHeaders)&&("undefined"==typeof e&&(e=-1),m.getSettings().colHeaders.splice(e,n)),h.columnSettings.splice(e,n),d.adjustRowsAndCols(),p.refreshBorders();break;default:throw new Error('There is no such action "'+t+'"')}r||d.adjustRowsAndCols()},adjustRowsAndCols:function(){var t,e,o,n=m.countEmptyRows(!0);if(e=m.countRows(),e<h.settings.minRows)for(t=0;t<h.settings.minRows-e;t++)u.createRow(m.countRows(),1,!0);if(n<h.settings.minSpareRows)for(;n<h.settings.minSpareRows&&m.countRows()<h.settings.maxRows;n++)u.createRow(m.countRows(),1,!0);if(o=m.countEmptyCols(!0),!h.settings.columns&&m.countCols()<h.settings.minCols)for(;m.countCols()<h.settings.minCols;o++)u.createCol(m.countCols(),1,!0);if(!h.settings.columns&&"array"===m.dataType&&o<h.settings.minSpareCols)for(;o<h.settings.minSpareCols&&m.countCols()<h.settings.maxCols;o++)u.createCol(m.countCols(),1,!0);if(h.settings.enterBeginsEditing)for(;(h.settings.minRows||h.settings.minSpareRows)&&m.countRows()>h.settings.minRows&&h.settings.minSpareRows&&n>h.settings.minSpareRows;n--)u.removeRow();if(h.settings.enterBeginsEditing&&!h.settings.columns)for(;(h.settings.minCols||h.settings.minSpareCols)&&m.countCols()>h.settings.minCols&&h.settings.minSpareCols&&o>h.settings.minSpareCols;o--)u.removeCol();var i=m.countRows(),r=m.countCols();if((0===i||0===r)&&p.deselect(),h.selStart.exists()){var s,a=h.selStart.row(),l=h.selStart.col(),c=h.selEnd.row(),d=h.selEnd.col();a>i-1?(a=i-1,s=!0,c>a&&(c=a)):c>i-1&&(c=i-1,s=!0,a>c&&(a=c)),l>r-1?(l=r-1,s=!0,d>l&&(d=l)):d>r-1&&(d=r-1,s=!0,l>d&&(l=d)),s&&m.selectCell(a,l,c,d)}},populateFromArray:function(t,e,n,i,r){var s,a,l,c,u=[],d={};if(a=e.length,0===a)return!1;var p,f,g,w;switch(r){case"shift_down":for(p=n?n.col-t.col+1:0,f=n?n.row-t.row+1:0,e=o.helper.translateRowsToColumns(e),l=0,c=e.length,g=Math.max(c,p);g>l;l++)if(c>l){for(s=0,a=e[l].length;f-a>s;s++)e[l].push(e[l][s%a]);e[l].unshift(t.col+l,t.row,0),m.spliceCol.apply(m,e[l])}else e[l%c][0]=t.col+l,m.spliceCol.apply(m,e[l%c]);break;case"shift_right":for(p=n?n.col-t.col+1:0,f=n?n.row-t.row+1:0,s=0,a=e.length,w=Math.max(a,f);w>s;s++)if(a>s){for(l=0,c=e[s].length;p-c>l;l++)e[s].push(e[s][l%c]);e[s].unshift(t.row+s,t.col,0),m.spliceRow.apply(m,e[s])}else e[s%a][0]=t.row+s,m.spliceRow.apply(m,e[s%a]);break;case"overwrite":default:for(d.row=t.row,d.col=t.col,s=0;a>s&&!(n&&d.row>n.row||!h.settings.minSpareRows&&d.row>m.countRows()-1||d.row>=h.settings.maxRows);s++){for(d.col=t.col,c=e[s]?e[s].length:0,l=0;c>l&&!(n&&d.col>n.col||!h.settings.minSpareCols&&d.col>m.countCols()-1||d.col>=h.settings.maxCols);l++)m.getCellMeta(d.row,d.col).readOnly||u.push([d.row,d.col,e[s][l]]),d.col++,n&&l===c-1&&(l=-1);d.row++,n&&s===a-1&&(s=-1)}m.setDataAtCell(u,null,null,i||"populateFromArray")}},getCornerCoords:function(e){function o(e,o,n){function i(t){return t[n]}return Array.prototype.map?e.apply(Math,o.map(i)):e.apply(Math,t.map(o,i))}return{TL:{row:o(Math.min,e,"row"),col:o(Math.min,e,"col")},BR:{row:o(Math.max,e,"row"),col:o(Math.max,e,"col")}}},getCellsAtCoords:function(t,e){var o,n,i=d.getCornerCoords([t,e]),r=[];for(o=i.TL.row;o<=i.BR.row;o++)for(n=i.TL.col;n<=i.BR.col;n++)r.push(m.view.getCellAtCoords({row:o,col:n}));return r}},this.selection=p={inProgress:!1,begin:function(){m.selection.inProgress=!0},finish:function(){var t=m.getSelected();m.PluginHooks.run("afterSelectionEnd",t[0],t[1],t[2],t[3]),m.PluginHooks.run("afterSelectionEndByProp",t[0],m.colToProp(t[1]),t[2],m.colToProp(t[3])),m.selection.inProgress=!1},isInProgress:function(){return m.selection.inProgress},setRangeStart:function(t){h.selStart.coords(t),p.setRangeEnd(t)},setRangeEnd:function(t,e){m.selection.begin(),h.selEnd.coords(t),h.settings.multiSelect||h.selStart.coords(t),m.view.wt.selections.current.clear(),m.view.wt.selections.current.add(h.selStart.arr()),m.view.wt.selections.area.clear(),p.isMultiple()&&(m.view.wt.selections.area.add(h.selStart.arr()),m.view.wt.selections.area.add(h.selEnd.arr())),(h.settings.currentRowClassName||h.settings.currentColClassName)&&(m.view.wt.selections.highlight.clear(),m.view.wt.selections.highlight.add(h.selStart.arr()),m.view.wt.selections.highlight.add(h.selEnd.arr())),m.PluginHooks.run("afterSelection",h.selStart.row(),h.selStart.col(),h.selEnd.row(),h.selEnd.col()),m.PluginHooks.run("afterSelectionByProp",h.selStart.row(),u.colToProp(h.selStart.col()),h.selEnd.row(),u.colToProp(h.selEnd.col())),e!==!1&&m.view.scrollViewport(t),p.refreshBorders()},refreshBorders:function(t,e){var o=!0;e||f.destroyEditor(t),o&&(m.view.render(),o=!0),o=!1,p.isSelected()&&!e&&f.prepareEditor()},isMultiple:function(){return!(h.selEnd.col()===h.selStart.col()&&h.selEnd.row()===h.selStart.row())},transformStart:function(t,e,o){h.selStart.row()+t>m.countRows()-1?o&&h.settings.minSpareRows>0?m.alter("insert_row",m.countRows()):h.settings.autoWrapCol&&(t=1-m.countRows(),e=h.selStart.col()+e==m.countCols()-1?1-m.countCols():1):h.settings.autoWrapCol&&h.selStart.row()+t<0&&h.selStart.col()+e>=0&&(t=m.countRows()-1,e=h.selStart.col()+e==0?m.countCols()-1:-1),h.selStart.col()+e>m.countCols()-1?o&&h.settings.minSpareCols>0?m.alter("insert_col",m.countCols()):h.settings.autoWrapRow&&(t=h.selStart.row()+t==m.countRows()-1?1-m.countRows():1,e=1-m.countCols()):h.settings.autoWrapRow&&h.selStart.col()+e<0&&h.selStart.row()+t>=0&&(t=h.selStart.row()+t==0?m.countRows()-1:-1,e=m.countCols()-1);var n=m.countRows(),i=m.countCols(),r={row:h.selStart.row()+t,col:h.selStart.col()+e};r.row<0?r.row=0:r.row>0&&r.row>=n&&(r.row=n-1),r.col<0?r.col=0:r.col>0&&r.col>=i&&(r.col=i-1),p.setRangeStart(r)},transformEnd:function(t,e){if(h.selEnd.exists()){var o=m.countRows(),n=m.countCols(),i={row:h.selEnd.row()+t,col:h.selEnd.col()+e};i.row<0?i.row=0:i.row>0&&i.row>=o&&(i.row=o-1),i.col<0?i.col=0:i.col>0&&i.col>=n&&(i.col=n-1),p.setRangeEnd(i)}},isSelected:function(){return h.selEnd.exists()},inInSelection:function(t){if(!p.isSelected())return!1;var e=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]);return e.TL.row<=t.row&&e.BR.row>=t.row&&e.TL.col<=t.col&&e.BR.col>=t.col},deselect:function(){p.isSelected()&&(m.selection.inProgress=!1,h.selEnd=new o.SelectionPoint,m.view.wt.selections.current.clear(),m.view.wt.selections.area.clear(),f.destroyEditor(),p.refreshBorders(),m.PluginHooks.run("afterDeselect"))},selectAll:function(){h.settings.multiSelect&&(p.setRangeStart({row:0,col:0}),p.setRangeEnd({row:m.countRows()-1,col:m.countCols()-1},!1))},empty:function(){if(p.isSelected()){var t,e,o=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]),n=[];for(t=o.TL.row;t<=o.BR.row;t++)for(e=o.TL.col;e<=o.BR.col;e++)m.getCellMeta(t,e).readOnly||n.push([t,e,""]);
m.setDataAtCell(n)}}},this.autofill=g={handle:null,init:function(){g.handle?g.handle.disabled=!1:g.handle={}},disable:function(){g.handle.disabled=!0},selectAdjacent:function(){var t,e,o,n,i;t=p.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),e=u.getAll();t:for(o=t[2]+1;o<m.countRows();o++){for(i=t[1];i<=t[3];i++)if(e[o][i])break t;(e[o][t[1]-1]||e[o][t[3]+1])&&(n=o)}n&&(m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([t[0],t[1]]),m.view.wt.selections.fill.add([n,t[3]]),g.apply())},apply:function(){var t,e,o,n,i;g.handle.isDragged=0,t=m.view.wt.selections.fill.getCorners(),t&&(m.view.wt.selections.fill.clear(),e=p.isMultiple()?m.view.wt.selections.area.getCorners():m.view.wt.selections.current.getCorners(),t[0]===e[0]&&t[1]<e[1]?(o={row:t[0],col:t[1]},n={row:t[2],col:e[1]-1}):t[0]===e[0]&&t[3]>e[3]?(o={row:t[0],col:e[3]+1},n={row:t[2],col:t[3]}):t[0]<e[0]&&t[1]===e[1]?(o={row:t[0],col:t[1]},n={row:e[0]-1,col:t[3]}):t[2]>e[2]&&t[1]===e[1]&&(o={row:e[2]+1,col:t[1]},n={row:t[2],col:t[3]}),o&&(i=SheetClip.parse(u.getText(h.selStart.coords(),h.selEnd.coords())),m.PluginHooks.run("beforeAutofill",o,n,i),d.populateFromArray(o,i,n,"autofill"),p.setRangeStart({row:t[0],col:t[1]}),p.setRangeEnd({row:t[2],col:t[3]})))},showBorder:function(t){t.row=t[0],t.col=t[1];var e=d.getCornerCoords([h.selStart.coords(),h.selEnd.coords()]);if("horizontal"!==h.settings.fillHandle&&(e.BR.row<t.row||e.TL.row>t.row))t=[t.row,e.BR.col];else{if("vertical"===h.settings.fillHandle)return;t=[e.BR.row,t.col]}m.view.wt.selections.fill.clear(),m.view.wt.selections.fill.add([h.selStart.coords().row,h.selStart.coords().col]),m.view.wt.selections.fill.add([h.selEnd.coords().row,h.selEnd.coords().col]),m.view.wt.selections.fill.add(t),m.view.render()}},this.init=function(){m.PluginHooks.run("beforeInit"),this.view=new o.TableView(this),f=new o.EditorManager(m,h,p,u),this.updateSettings(h.settings,!0),this.parseSettingsFromDOM(),this.forceFullRender=!0,this.view.render(),"object"==typeof h.firstRun&&(m.PluginHooks.run("afterChange",h.firstRun[0],h.firstRun[1]),h.firstRun=!1),m.PluginHooks.run("afterInit")},this.validateCell=function(t,e,o,n){var i=m.getCellValidator(e);"[object RegExp]"===Object.prototype.toString.call(i)&&(i=function(t){return function(e,o){o(t.test(e))}}(i)),"function"==typeof i?(t=m.PluginHooks.execute("beforeValidate",t,e.row,e.prop,n),setTimeout(function(){i.call(e,t,function(i){e.valid=i,i=m.PluginHooks.execute("afterValidate",i,t,e.row,e.prop,n),o(i)})})):(e.valid=!0,o(!0))},this.setDataAtCell=function(t,e,o,n){var i,r,c,h=l(t,e,o),d=[];for(i=0,r=h.length;r>i;i++){if("object"!=typeof h[i])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[i][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=u.colToProp(h[i][1]),d.push([h[i][0],c,u.get(h[i][0],c),h[i][2]])}n||"object"!=typeof t||(n=e),s(d,n,function(){a(d,n)})},this.setDataAtRowProp=function(t,e,o,n){var i,r,c=l(t,e,o),h=[];for(i=0,r=c.length;r>i;i++)h.push([c[i][0],c[i][1],u.get(c[i][0],c[i][1]),c[i][2]]);n||"object"!=typeof t||(n=e),s(h,n,function(){a(h,n)})},this.listen=function(){o.activeGuid=m.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){o.activeGuid=null},this.isListening=function(){return o.activeGuid===m.guid},this.destroyEditor=function(t){p.refreshBorders(t)},this.populateFromArray=function(t,e,o,n,i,r,s){if("object"!=typeof o||"object"!=typeof o[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return d.populateFromArray({row:t,col:e},o,"number"==typeof n?{row:n,col:i}:null,r,s)},this.spliceCol=function(t,e,o){return u.spliceCol.apply(u,arguments)},this.spliceRow=function(t,e,o){return u.spliceRow.apply(u,arguments)},this.getCornerCoords=function(t){return d.getCornerCoords(t)},this.getSelected=function(){return p.isSelected()?[h.selStart.row(),h.selStart.col(),h.selEnd.row(),h.selEnd.col()]:void 0},this.parseSettingsFromDOM=function(){var t=this.rootElement.css("overflow");if("scroll"===t||"auto"===t?(this.rootElement[0].style.overflow="visible",h.settingsFromDOM.overflow=t):(void 0===h.settings.width||void 0===h.settings.height)&&(h.settingsFromDOM.overflow="auto"),void 0===h.settings.width?h.settingsFromDOM.width=this.rootElement.width():h.settingsFromDOM.width=void 0,h.settingsFromDOM.height=void 0,void 0===h.settings.height&&("scroll"===h.settingsFromDOM.overflow||"auto"===h.settingsFromDOM.overflow)){var o=this.rootElement[0].cloneNode(!1),n=this.rootElement[0].parentNode;if(n){o.removeAttribute("id"),n.appendChild(o);var i=parseInt(o.clientHeight,10),r=parseInt(e.getComputedStyle(o,null).getPropertyValue("paddingTop"),10)||0,s=parseInt(e.getComputedStyle(o,null).getPropertyValue("paddingBottom"),10)||0,a=i-r-s;isNaN(a)&&o.currentStyle&&(a=parseInt(o.currentStyle.height,10)),a>0&&(h.settingsFromDOM.height=a),n.removeChild(o)}}},this.render=function(){m.view&&(m.forceFullRender=!0,m.parseSettingsFromDOM(),p.refreshBorders(null,!0))},this.loadData=function(t){function e(){h.cellSettings.length=0}if("object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else{if(null!==t)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof t+" given)");t=[];for(var n,i=0,r=h.settings.startRows;r>i;i++){n=[];for(var s=0,a=h.settings.startCols;a>s;s++)n.push(null);t.push(n)}}h.isPopulated=!1,w.prototype.data=t,h.settings.dataSchema instanceof Array||t[0]instanceof Array?m.dataType="array":"function"==typeof h.settings.dataSchema?m.dataType="function":m.dataType="object",u=new o.DataMap(m,h,w),e(),d.adjustRowsAndCols(),m.PluginHooks.run("afterLoadData"),h.firstRun?h.firstRun=[null,"loadData"]:(m.PluginHooks.run("afterChange",null,"loadData"),m.render()),h.isPopulated=!0},this.getData=function(t,e,o,n){return"undefined"==typeof t?u.getAll():u.getRange({row:t,col:e},{row:o,col:n},u.DESTINATION_RENDERER)},this.getCopyableData=function(t,e,o,n){return u.getCopyableText({row:t,col:e},{row:o,col:n})},this.updateSettings=function(t,e){var n,i;if("undefined"!=typeof t.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if("undefined"!=typeof t.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(n in t)"data"!==n&&(void 0!==m.PluginHooks.hooks[n]||void 0!==m.PluginHooks.legacy[n]?("function"==typeof t[n]||o.helper.isArray(t[n]))&&m.PluginHooks.add(n,t[n]):(!e&&t.hasOwnProperty(n)&&(w.prototype[n]=t[n]),o.extension[n]&&(h.extensions[n]=new o.extension[n](m,t[n]))));if(void 0===t.data&&void 0===h.settings.data?m.loadData(null):void 0!==t.data?m.loadData(t.data):void 0!==t.columns&&u.createMap(),i=m.countCols(),h.cellSettings.length=0,i>0){var r,s;for(n=0;i>n;n++)h.columnSettings[n]=o.helper.columnFactory(w,h.columnsSettingConflicts),r=h.columnSettings[n].prototype,w.prototype.columns&&(s=w.prototype.columns[n],o.helper.extend(r,s),o.helper.extend(r,c(s)))}"undefined"!=typeof t.fillHandle&&(g.handle&&t.fillHandle===!1?g.disable():g.handle||t.fillHandle===!1||g.init()),"undefined"!=typeof t.className&&(w.prototype.className&&m.rootElement.removeClass(w.prototype.className),t.className&&m.rootElement.addClass(t.className)),e||m.PluginHooks.run("afterUpdateSettings"),d.adjustRowsAndCols(),m.view&&!h.firstRun&&(m.forceFullRender=!0,p.refreshBorders(null,!0))},this.getValue=function(){var t=m.getSelected();if(w.prototype.getValue){if("function"==typeof w.prototype.getValue)return w.prototype.getValue.call(m);if(t)return m.getData()[t[0]][w.prototype.getValue]}else if(t)return m.getDataAtCell(t[0],t[1])},this.getSettings=function(){return h.settings},this.getSettingsFromDOM=function(){return h.settingsFromDOM},this.clear=function(){p.selectAll(),p.empty()},this.alter=function(t,e,o,n,i){d.alter(t,e,o,n,i)},this.getCell=function(t,e){return m.view.getCellAtCoords({row:t,col:e})},this.colToProp=function(t){return u.colToProp(t)},this.propToCol=function(t){return u.propToCol(t)},this.getDataAtCell=function(t,e){return u.get(t,u.colToProp(e))},this.getDataAtRowProp=function(t,e){return u.get(t,e)},this.getDataAtCol=function(t){return[].concat.apply([],u.getRange({row:0,col:t},{row:h.settings.data.length-1,col:t},u.DESTINATION_RENDERER))},this.getDataAtProp=function(t){return[].concat.apply([],u.getRange({row:0,col:u.propToCol(t)},{row:h.settings.data.length-1,col:u.propToCol(t)},u.DESTINATION_RENDERER))},this.getDataAtRow=function(t){return h.settings.data[t]},this.getCellMeta=function(t,e){function n(t){var e={row:t};return m.PluginHooks.execute("beforeGet",e),e.row}function i(t){return o.PluginHooks.execute(m,"modifyCol",t)}var r,s=u.colToProp(e);if(t=n(t),e=i(e),"undefined"==typeof h.columnSettings[e]&&(h.columnSettings[e]=o.helper.columnFactory(w,h.columnsSettingConflicts)),h.cellSettings[t]||(h.cellSettings[t]=[]),h.cellSettings[t][e]||(h.cellSettings[t][e]=new h.columnSettings[e]),r=h.cellSettings[t][e],r.row=t,r.col=e,r.prop=s,r.instance=m,m.PluginHooks.run("beforeGetCellMeta",t,e,r),o.helper.extend(r,c(r)),r.cells){var a=r.cells.call(r,t,e,s);a&&(o.helper.extend(r,a),o.helper.extend(r,c(a)))}return m.PluginHooks.run("afterGetCellMeta",t,e,r),r};var C=o.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(t,e){var n=C.call(this,t,e);return o.renderers.getRenderer(n)},this.getCellEditor=o.helper.cellMethodLookupFactory("editor"),this.getCellValidator=o.helper.cellMethodLookupFactory("validator"),this.validateCells=function(t){var e=new r;e.onQueueEmpty=t;for(var o=m.countRows()-1;o>=0;){for(var n=m.countCols()-1;n>=0;)e.addValidatorToQueue(),m.validateCell(m.getDataAtCell(o,n),m.getCellMeta(o,n),function(){e.removeValidatorFormQueue()},"validateCells"),n--;o--}e.checkIfQueueIsEmpty()},this.getRowHeader=function(t){if(void 0===t){for(var e=[],o=0,n=m.countRows();n>o;o++)e.push(m.getRowHeader(o));return e}return"[object Array]"===Object.prototype.toString.call(h.settings.rowHeaders)&&void 0!==h.settings.rowHeaders[t]?h.settings.rowHeaders[t]:"function"==typeof h.settings.rowHeaders?h.settings.rowHeaders(t):h.settings.rowHeaders&&"string"!=typeof h.settings.rowHeaders&&"number"!=typeof h.settings.rowHeaders?t+1:h.settings.rowHeaders},this.hasRowHeaders=function(){return!!h.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==h.settings.colHeaders&&null!==h.settings.colHeaders)return!!h.settings.colHeaders;for(var t=0,e=m.countCols();e>t;t++)if(m.getColHeader(t))return!0;return!1},this.getColHeader=function(t){if(void 0===t){for(var e=[],n=0,i=m.countCols();i>n;n++)e.push(m.getColHeader(n));return e}return t=o.PluginHooks.execute(m,"modifyCol",t),h.settings.columns&&h.settings.columns[t]&&h.settings.columns[t].title?h.settings.columns[t].title:"[object Array]"===Object.prototype.toString.call(h.settings.colHeaders)&&void 0!==h.settings.colHeaders[t]?h.settings.colHeaders[t]:"function"==typeof h.settings.colHeaders?h.settings.colHeaders(t):h.settings.colHeaders&&"string"!=typeof h.settings.colHeaders&&"number"!=typeof h.settings.colHeaders?o.helper.spreadsheetColumnLabel(t):h.settings.colHeaders},this._getColWidthFromSettings=function(t){var e=m.getCellMeta(0,t),o=e.width;if((void 0===o||o===h.settings.width)&&(o=e.colWidths),void 0!==o&&null!==o){switch(typeof o){case"object":o=o[t];break;case"function":o=o(t)}"string"==typeof o&&(o=parseInt(o,10))}return o},this.getColWidth=function(t){t=o.PluginHooks.execute(m,"modifyCol",t);var e={width:m._getColWidthFromSettings(t)};return e.width||(e.width=50),m.PluginHooks.run("afterGetColWidth",t,e),e.width},this.countRows=function(){return h.settings.data.length},this.countCols=function(){return"object"===m.dataType||"function"===m.dataType?h.settings.columns&&h.settings.columns.length?h.settings.columns.length:u.colToPropCache.length:"array"===m.dataType?h.settings.columns&&h.settings.columns.length?h.settings.columns.length:h.settings.data&&h.settings.data[0]&&h.settings.data[0].length?h.settings.data[0].length:0:void 0},this.rowOffset=function(){return m.view.wt.getSetting("offsetRow")},this.colOffset=function(){return m.view.wt.getSetting("offsetColumn")},this.countVisibleRows=function(){return m.view.wt.drawn?m.view.wt.wtTable.rowStrategy.countVisible():-1},this.countVisibleCols=function(){return m.view.wt.drawn?m.view.wt.wtTable.columnStrategy.countVisible():-1},this.countEmptyRows=function(t){for(var e=m.countRows()-1,o=0;e>=0;){if(u.get(e,0),m.isEmptyRow(u.getVars.row))o++;else if(t)break;e--}return o},this.countEmptyCols=function(t){if(m.countRows()<1)return 0;for(var e=m.countCols()-1,o=0;e>=0;){if(m.isEmptyCol(e))o++;else if(t)break;e--}return o},this.isEmptyRow=function(t){return h.settings.isEmptyRow.call(m,t)},this.isEmptyCol=function(t){return h.settings.isEmptyCol.call(m,t)},this.selectCell=function(t,e,o,n,i){if("number"!=typeof t||0>t||t>=m.countRows())return!1;if("number"!=typeof e||0>e||e>=m.countCols())return!1;if("undefined"!=typeof o){if("number"!=typeof o||0>o||o>=m.countRows())return!1;if("number"!=typeof n||0>n||n>=m.countCols())return!1}return h.selStart.coords({row:t,col:e}),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),m.listen(),"undefined"==typeof o?p.setRangeEnd({row:t,col:e},i):p.setRangeEnd({row:o,col:n},i),m.selection.finish(),!0},this.selectCellByProp=function(t,e,o,n,i){return arguments[1]=u.propToCol(arguments[1]),"undefined"!=typeof arguments[3]&&(arguments[3]=u.propToCol(arguments[3])),m.selectCell.apply(m,arguments)},this.deselectCell=function(){p.deselect()},this.destroy=function(){m.clearTimeouts(),m.view&&m.view.wt.destroy(),m.rootElement.empty(),m.rootElement.removeData("handsontable"),m.rootElement.off(".handsontable"),t(e).off("."+m.guid),y.off("."+m.guid),v.off("."+m.guid),m.PluginHooks.run("afterDestroy")},this.getActiveEditor=function(){return f.getActiveEditor()},this.getInstance=function(){return m.rootElement.data("handsontable")},function(){m.PluginHooks=new o.PluginHookClass;var t=m.PluginHooks.run,e=m.PluginHooks.execute;m.PluginHooks.run=function(e,n,i,r,s,a){t.call(this,m,e,n,i,r,s,a),o.PluginHooks.run(m,e,n,i,r,s,a)},m.PluginHooks.execute=function(t,n,i,r,s,a){var l=o.PluginHooks.execute(m,t,n,i,r,s,a),c=e.call(this,m,t,l,i,r,s,a);return"undefined"==typeof c?l:c},m.addHook=function(){m.PluginHooks.add.apply(m.PluginHooks,arguments)},m.addHookOnce=function(){m.PluginHooks.once.apply(m.PluginHooks,arguments)},m.removeHook=function(){m.PluginHooks.remove.apply(m.PluginHooks,arguments)},m.runHooks=function(){m.PluginHooks.run.apply(m.PluginHooks,arguments)},m.runHooksAndReturn=function(){return m.PluginHooks.execute.apply(m.PluginHooks,arguments)}}(),this.timeouts={},this.registerTimeout=function(t,e,o){clearTimeout(this.timeouts[t]),this.timeouts[t]=setTimeout(e,o||0)},this.clearTimeouts=function(){for(var t in this.timeouts)this.timeouts.hasOwnProperty(t)&&clearTimeout(this.timeouts[t])},this.version="0.10.5"};var N=function(){};N.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:function(t){for(var e,o=0,n=this.countCols();n>o;o++)if(e=this.getDataAtCell(t,o),""!==e&&null!==e&&"undefined"!=typeof e)return!1;return!0},isEmptyCol:function(t){for(var e,o=0,n=this.countRows();n>o;o++)if(e=this.getDataAtCell(o,t),""!==e&&null!==e&&"undefined"!=typeof e)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",fragmentSelection:!1,readOnly:!1,nativeScrollbars:!1,type:"text",copyable:!0,debug:!1},o.DefaultSettings=N,t.fn.handsontable=function(t){var e,n,i,r,s,a=this.first(),l=a.data("handsontable");if("string"!=typeof t)return s=t||{},l?l.updateSettings(s):(l=new o.Core(a,s),a.data("handsontable",l),l.init()),a;if(i=[],arguments.length>1)for(e=1,n=arguments.length;n>e;e++)i.push(arguments[e]);if(l){if("undefined"==typeof l[t])throw new Error("Handsontable do not provide action: "+t);r=l[t].apply(l,i)}return r},function(t){function e(){function t(t){return null!==t&&!o(t)&&("string"==typeof t||"number"==typeof t)}function e(t){return null!==t&&("object"==typeof t||"function"==typeof t)}function o(t){return t!==t}var n={arrayMap:[],weakMap:new WeakMap};return{get:function(o){return t(o)?n.arrayMap[o]:e(o)?n.weakMap.get(o):void 0},set:function(o,i){if(t(o))n.arrayMap[o]=i;else{if(!e(o))throw new Error("Invalid key type");n.weakMap.set(o,i)}},"delete":function(o){t(o)?delete n.arrayMap[o]:e(o)&&n.weakMap["delete"](o)}}}t.MultiMap||(t.MultiMap=e)}(e),o.TableView=function(n){var i=this,r=t(e),s=t(document.documentElement);this.instance=n,this.settings=n.getSettings(),this.settingsFromDOM=n.getSettingsFromDOM(),n.rootElement.data("originalStyle",n.rootElement[0].getAttribute("style")),n.rootElement.addClass("handsontable");var a=document.createElement("TABLE");a.className="htCore",this.THEAD=document.createElement("THEAD"),a.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),a.appendChild(this.TBODY),n.$table=t(a),n.rootElement.prepend(n.$table),n.rootElement.on("mousedown.handsontable",function(t){i.isTextSelectionAllowed(t.target)||(c(),t.preventDefault(),e.focus())}),s.on("keyup."+n.guid,function(t){n.selection.isInProgress()&&!t.shiftKey&&n.selection.finish()});var l;s.on("mouseup."+n.guid,function(t){n.selection.isInProgress()&&1===t.which&&n.selection.finish(),l=!1,n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0),o.helper.isOutsideInput(document.activeElement)&&n.unlisten()}),s.on("mousedown."+n.guid,function(t){var e=t.target;if(e!==i.wt.wtTable.spreader)for(;e!==document.documentElement;){if(null===e)return;if(e===n.rootElement[0]||"HANDSONTABLE-TABLE"===e.nodeName)return;e=e.parentNode}i.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}),n.rootElement.on("mousedown.handsontable",".dragdealer",function(){n.destroyEditor()}),n.$table.on("selectstart",function(t){i.settings.fragmentSelection||t.preventDefault()});var c=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},h={debug:function(){return i.settings.debug},table:a,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return i.settings.fixedColumnsLeft},fixedRowsTop:function(){return i.settings.fixedRowsTop},rowHeaders:function(){return n.hasRowHeaders()?[function(t,e){i.appendRowHeader(t,e)}]:[]},columnHeaders:function(){return n.hasColHeaders()?[function(t,e){i.appendColHeader(t,e)}]:[]},columnWidth:n.getColWidth,cellRenderer:function(t,e,o){var n=i.instance.colToProp(e),r=i.instance.getCellMeta(t,e),s=i.instance.getCellRenderer(r),a=i.instance.getDataAtRowProp(t,n);s(i.instance,o,t,e,n,a,r),i.instance.PluginHooks.run("afterRenderer",o,t,e,n,a,r)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&!n.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&n.selection.isMultiple()}}},highlight:{highlightRowClassName:i.settings.currentRowClassName,highlightColumnClassName:i.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return i.settings.fragmentSelection},onCellMouseDown:function(t,e,o){n.listen(),l=!0;var i={row:e[0],col:e[1]};2===t.button&&n.selection.inInSelection(i)||(t.shiftKey?n.selection.setRangeEnd(i):n.selection.setRangeStart(i)),n.PluginHooks.run("afterOnCellMouseDown",t,e,o)},onCellMouseOver:function(t,e,o){var i={row:e[0],col:e[1]};l?n.selection.setRangeEnd(i):n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(e)),n.PluginHooks.run("afterOnCellMouseOver",t,e,o)},onCellCornerMouseDown:function(t){n.autofill.handle.isDragged=1,t.preventDefault(),n.PluginHooks.run("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(){n.autofill.selectAdjacent()},beforeDraw:function(t){i.beforeRender(t)},onDraw:function(t){i.onDraw(t)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")}};n.PluginHooks.run("beforeInitWalkontable",h),this.wt=new m(h),r.on("resize."+n.guid,function(){n.registerTimeout("resizeTimeout",function(){n.parseSettingsFromDOM();var t=i.getWidth(),e=i.getHeight();(h.width!==t||h.height!==e)&&(n.forceFullRender=!0,i.render(),h.width=t,h.height=e)},60)}),t(i.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(t){t.target===i.wt.wtTable.spreader&&3===t.which&&t.stopPropagation()}),s.on("click."+n.guid,function(){i.settings.observeDOMVisibility&&i.wt.drawInterrupted&&(i.instance.forceFullRender=!0,i.render())})},o.TableView.prototype.isTextSelectionAllowed=function(t){return o.helper.isInput(t)?!0:this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(t,this.TBODY)?!0:!1},o.TableView.prototype.isCellEdited=function(){var t=this.instance.getActiveEditor();return t&&t.isOpened()},o.TableView.prototype.getWidth=function(){var t=void 0!==this.settings.width?this.settings.width:this.settingsFromDOM.width;return"function"==typeof t?t():t},o.TableView.prototype.getHeight=function(){var t=void 0!==this.settings.height?this.settings.height:this.settingsFromDOM.height;return"function"==typeof t?t():t},o.TableView.prototype.beforeRender=function(t){t&&(this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender),this.wt.update("width",this.getWidth()),this.wt.update("height",this.getHeight()))},o.TableView.prototype.onDraw=function(t){t&&this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)},o.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.rootElement.triggerHandler("render.handsontable")},o.TableView.prototype.getCellAtCoords=function(t){var e=this.wt.wtTable.getCell([t.row,t.col]);return 0>e?null:e},o.TableView.prototype.scrollViewport=function(t){this.wt.scrollViewport([t.row,t.col])},o.TableView.prototype.appendRowHeader=function(t,e){if(t>-1)this.wt.wtDom.fastInnerHTML(e,this.instance.getRowHeader(t));else{var o=document.createElement("DIV");o.className="relative",this.wt.wtDom.fastInnerText(o," "),this.wt.wtDom.empty(e),e.appendChild(o)}},o.TableView.prototype.appendColHeader=function(t,e){var o=document.createElement("DIV"),n=document.createElement("SPAN");o.className="relative",n.className="colHeader",this.wt.wtDom.fastInnerHTML(n,this.instance.getColHeader(t)),o.appendChild(n),this.wt.wtDom.empty(e),e.appendChild(o),this.instance.PluginHooks.run("afterGetColHeader",t,e)},o.TableView.prototype.maximumVisibleElementWidth=function(t){var e=this.wt.wtViewport.getWorkspaceWidth();return this.settings.nativeScrollbars?e:e-t},o.TableView.prototype.maximumVisibleElementHeight=function(t){var e=this.wt.wtViewport.getWorkspaceHeight();return this.settings.nativeScrollbars?e:e-t},function(t){function e(t){var e,o;o={},e=t,this.getInstance=function(t){return t.guid in o||(o[t.guid]=new e(t)),o[t.guid]}}var o={},n=new WeakMap;t.editors={registerEditor:function(t,i){var r=new e(i);"string"==typeof t&&(o[t]=r),n.set(i,r)},getEditor:function(t,e){var i;if("function"==typeof t)n.get(t)||this.registerEditor(null,t),i=n.get(t);else{if("string"!=typeof t)throw Error('Only strings and functions can be passed as "editor" parameter ');i=o[t]}if(!i)throw Error('No editor registered under name "'+t+'"');return i.getInstance(e)}}}(o),function(e){e.EditorManager=function(o,n,i){var r,s=this,a=t(document),l=e.helper.keyCode,c=function(){function t(t){if(o.isListening()&&(n.settings.beforeOnKeyDown&&n.settings.beforeOnKeyDown.call(o,t),o.PluginHooks.run("beforeKeyDown",t),!t.isImmediatePropagationStopped()&&(n.lastKeyCode=t.keyCode,i.isSelected()))){var a=(t.ctrlKey||t.metaKey)&&!t.altKey;if(!(r.isWaiting()||e.helper.isMetaKey(t.keyCode)||a||s.isEditorOpened()))return s.openEditor(""),void t.stopPropagation();var c=t.shiftKey?i.setRangeEnd:i.setRangeStart;switch(t.keyCode){case l.A:if(a){i.selectAll(),t.preventDefault(),t.stopPropagation();break}case l.ARROW_UP:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),u(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case l.ARROW_DOWN:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),d(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case l.ARROW_RIGHT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),p(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case l.ARROW_LEFT:s.isEditorOpened()&&!r.isWaiting()&&s.closeEditorAndSaveChanges(a),f(t.shiftKey),t.preventDefault(),t.stopPropagation();break;case l.TAB:var g="function"==typeof n.settings.tabMoves?n.settings.tabMoves(t):n.settings.tabMoves;t.shiftKey?i.transformStart(-g.row,-g.col):i.transformStart(g.row,g.col,!0),t.preventDefault(),t.stopPropagation();break;case l.BACKSPACE:case l.DELETE:i.empty(t),s.prepareEditor(),t.preventDefault();break;case l.F2:s.openEditor(),t.preventDefault();break;case l.ENTER:s.isEditorOpened()?(r.state!==e.EditorState.WAITING&&s.closeEditorAndSaveChanges(a),h(t.shiftKey)):o.getSettings().enterBeginsEditing?s.openEditor():h(t.shiftKey),t.preventDefault(),t.stopImmediatePropagation();break;case l.ESCAPE:s.isEditorOpened()&&s.closeEditorAndRestoreOriginalValue(a),t.preventDefault();break;case l.HOME:c(t.ctrlKey||t.metaKey?{row:0,col:n.selStart.col()}:{row:n.selStart.row(),col:0}),t.preventDefault(),t.stopPropagation();break;case l.END:c(t.ctrlKey||t.metaKey?{row:o.countRows()-1,col:n.selStart.col()}:{row:n.selStart.row(),col:o.countCols()-1}),t.preventDefault(),t.stopPropagation();break;case l.PAGE_UP:i.transformStart(-o.countVisibleRows(),0),o.view.wt.scrollVertical(-o.countVisibleRows()),o.view.render(),t.preventDefault(),t.stopPropagation();break;case l.PAGE_DOWN:i.transformStart(o.countVisibleRows(),0),o.view.wt.scrollVertical(o.countVisibleRows()),o.view.render(),t.preventDefault(),t.stopPropagation()}}}function c(){s.openEditor()}function h(t){var e="function"==typeof n.settings.enterMoves?n.settings.enterMoves(event):n.settings.enterMoves;t?i.transformStart(-e.row,-e.col):i.transformStart(e.row,e.col,!0)}function u(t){t?i.transformEnd(-1,0):i.transformStart(-1,0)}function d(t){t?i.transformEnd(1,0):i.transformStart(1,0)}function p(t){t?i.transformEnd(0,1):i.transformStart(0,1)}function f(t){t?i.transformEnd(0,-1):i.transformStart(0,-1)}a.on("keydown.handsontable."+o.guid,t),o.view.wt.update("onCellDblClick",c),o.addHook("afterDestroy",function(){a.off("keydown.handsontable."+o.guid)})};this.destroyEditor=function(t){this.closeEditor(t)},this.getActiveEditor=function(){return r},this.prepareEditor=function(){if(r&&r.isWaiting())return void this.closeEditor(!1,!1,function(t){t&&s.prepareEditor()});var t=n.selStart.row(),i=n.selStart.col(),a=o.colToProp(i),l=o.getCell(t,i),c=o.getDataAtCell(t,i),h=o.getCellMeta(t,i),u=o.getCellEditor(h);r=e.editors.getEditor(u,o),r.prepare(t,i,a,l,c,h)},this.isEditorOpened=function(){return r.isOpened()},this.openEditor=function(t){r.cellProperties.readOnly||r.beginEditing(t)},this.closeEditor=function(t,e,o){r?r.finishEditing(t,e,o):o&&o(!1)},this.closeEditorAndSaveChanges=function(t){return this.closeEditor(!1,t)},this.closeEditorAndRestoreOriginalValue=function(t){return this.closeEditor(!0,t)},c()}}(o),function(t){var e={};t.renderers={registerRenderer:function(t,o){e[t]=o},getRenderer:function(t){if("function"==typeof t)return t;if("string"!=typeof t)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(t in e))throw Error('No editor registered under name "'+t+'"');return e[t]}}}(o),o.Dom=new y,o.helper.isPrintableChar=function(t){return 32==t||t>=48&&57>=t||t>=96&&111>=t||t>=186&&192>=t||t>=219&&222>=t||t>=226||t>=65&&90>=t},o.helper.isMetaKey=function(t){var e=o.helper.keyCode,n=[e.ARROW_DOWN,e.ARROW_UP,e.ARROW_LEFT,e.ARROW_RIGHT,e.HOME,e.END,e.DELETE,e.BACKSPACE,e.F1,e.F2,e.F3,e.F4,e.F5,e.F6,e.F7,e.F8,e.F9,e.F10,e.F11,e.F12,e.TAB,e.PAGE_DOWN,e.PAGE_UP,e.ENTER,e.ESCAPE,e.SHIFT,e.CAPS_LOCK,e.ALT];return-1!=n.indexOf(t)},o.helper.isCtrlKey=function(t){var e=o.helper.keyCode;return-1!=[e.CONTROL_LEFT,224,e.COMMAND_LEFT,e.COMMAND_RIGHT].indexOf(t)},o.helper.stringify=function(t){switch(typeof t){case"string":case"number":return t+"";case"object":return null===t?"":t.toString();case"undefined":return"";default:return t.toString()}},o.helper.spreadsheetColumnLabel=function(t){for(var e,o=t+1,n="";o>0;)e=(o-1)%26,n=String.fromCharCode(65+e)+n,o=parseInt((o-e)/26,10);return n},o.helper.isNumeric=function(t){var e=typeof t;return"number"==e?!isNaN(t)&&isFinite(t):"string"==e?t.length?1==t.length?/\d/.test(t):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(t):!1:"object"==e?!(!t||"number"!=typeof t.valueOf()||t instanceof Date):!1},o.helper.isArray=function(t){return null!==Object.prototype.toString.call(t).match(/array/i)},o.helper.isDescendant=function(t,e){for(var o=e.parentNode;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},o.helper.randomString=function(){return C()},o.helper.inherit=function(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t},o.helper.extend=function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])},o.helper.getPrototypeOf=function(t){var e;if("object"==typeof t.__proto__)e=t.__proto__;else{var o,n=t.constructor;"function"==typeof t.constructor&&(o=n,delete t.constructor&&(n=t.constructor,t.constructor=o)),e=n?n.prototype:null}return e},o.helper.columnFactory=function(t,e){function n(){}o.helper.inherit(n,t);for(var i=0,r=e.length;r>i;i++)n.prototype[e[i]]=void 0;return n},o.helper.translateRowsToColumns=function(t){var e,o,n,i,r=[],s=0;for(e=0,o=t.length;o>e;e++)for(n=0,i=t[e].length;i>n;n++)n==s&&(r.push([]),s++),r[n].push(t[e][n]);return r},o.helper.to2dArray=function(t){for(var e=0,o=t.length;o>e;)t[e]=[t[e]],e++},o.helper.extendArray=function(t,e){for(var o=0,n=e.length;n>o;)t.push(e[o]),o++},o.helper.isInput=function(t){var e=["INPUT","SELECT","TEXTAREA"];return e.indexOf(t.nodeName)>-1},o.helper.isOutsideInput=function(t){return o.helper.isInput(t)&&-1==t.className.indexOf("handsontableInput")},o.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},o.helper.isObject=function(t){return"[object Object]"==Object.prototype.toString.call(t)},o.helper.isArray=function(t){
return Array.isArray?Array.isArray(t):"[object Array]"==Object.prototype.toString.call(t)},o.helper.pivot=function(t){var e=[];if(!t||0==t.length||!t[0]||0==t[0].length)return e;for(var o=t.length,n=t[0].length,i=0;o>i;i++)for(var r=0;n>r;r++)e[r]||(e[r]=[]),e[r][i]=t[i][r];return e},o.helper.proxy=function(t,e){return function(){return t.apply(e,arguments)}},o.helper.cellMethodLookupFactory=function(t,e){function n(t){var e=o.cellTypes[t];if("undefined"==typeof e)throw new Error('You declared cell type "'+t+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return e}return e="undefined"==typeof e?!0:e,function(i,r){return function s(i){if(i){if(i.hasOwnProperty(t)&&i[t])return i[t];if(i.hasOwnProperty("type")&&i.type){var r;if("string"!=typeof i.type)throw new Error("Cell type must be a string ");if(r=n(i.type),r.hasOwnProperty(t))return r[t];if(e)return}return s(o.helper.getPrototypeOf(i))}}("number"==typeof i?this.getCellMeta(i,r):i)}},o.helper.toString=function(t){return""+t},o.SelectionPoint=function(){this._row=null,this._col=null},o.SelectionPoint.prototype.exists=function(){return null!==this._row},o.SelectionPoint.prototype.row=function(t){return void 0!==t&&(this._row=t),this._row},o.SelectionPoint.prototype.col=function(t){return void 0!==t&&(this._col=t),this._col},o.SelectionPoint.prototype.coords=function(t){return void 0!==t&&(this._row=t.row,this._col=t.col),{row:this._row,col:this._col}},o.SelectionPoint.prototype.arr=function(t){return void 0!==t&&(this._row=t[0],this._col=t[1]),[this._row,this._col]},function(e){e.DataMap=function(t,e,o){this.instance=t,this.priv=e,this.GridSettings=o,this.dataSource=this.instance.getSettings().data,this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.getVars={},this.setVars={}},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var o;if(t.isPlainObject(e)){o={};for(var n in e)e.hasOwnProperty(n)&&(t.isPlainObject(e[n])?o[n]=this.recursiveDuckSchema(e[n]):o[n]=null)}else o=[];return o},e.DataMap.prototype.recursiveDuckColumns=function(e,o,n){var i,r;if("undefined"==typeof o&&(o=0,n=""),t.isPlainObject(e))for(r in e)e.hasOwnProperty(r)&&(null===e[r]?(i=n+r,this.colToPropCache.push(i),this.propToColCache.set(i,o),o++):o=this.recursiveDuckColumns(e[r],o,r+"."));return o},e.DataMap.prototype.createMap=function(){if("undefined"==typeof this.getSchema())throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");var t,e,o=this.getSchema();this.colToPropCache=[],this.propToColCache=new MultiMap;var n=this.instance.getSettings().columns;if(n)for(t=0,e=n.length;e>t;t++)"undefined"!=typeof n[t].data&&(this.colToPropCache[t]=n[t].data,this.propToColCache.set(n[t].data,t));else this.recursiveDuckColumns(o)},e.DataMap.prototype.colToProp=function(t){return t=e.PluginHooks.execute(this.instance,"modifyCol",t),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var o;return o="undefined"!=typeof this.propToColCache.get(t)?this.propToColCache.get(t):t,o=e.PluginHooks.execute(this.instance,"modifyCol",o)},e.DataMap.prototype.getSchema=function(){var t=this.instance.getSettings().dataSchema;return t?"function"==typeof t?t():t:this.duckSchema},e.DataMap.prototype.createRow=function(e,o,n){var i,r,s=this.instance.countCols(),a=0;o||(o=1),("number"!=typeof e||e>=this.instance.countRows())&&(e=this.instance.countRows()),r=e;for(var l=this.instance.getSettings().maxRows;o>a&&this.instance.countRows()<l;){if("array"===this.instance.dataType){i=[];for(var c=0;s>c;c++)i.push(null)}else i="function"===this.instance.dataType?this.instance.getSettings().dataSchema(e):t.extend(!0,{},this.getSchema());e===this.instance.countRows()?this.dataSource.push(i):this.dataSource.splice(e,0,i),a++,r++}return this.instance.PluginHooks.run("afterCreateRow",e,a,n),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,o,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var i,r,s=this.instance.countRows(),a=this.dataSource,l=0;o||(o=1),r=t;for(var c=this.instance.getSettings().maxCols;o>l&&this.instance.countCols()<c;){if(i=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(var h=0;s>h;h++)"undefined"==typeof a[h]&&(a[h]=[]),a[h].push(null);this.priv.columnSettings.push(i)}else{for(var h=0;s>h;h++)a[h].splice(r,0,null);this.priv.columnSettings.splice(r,0,i)}l++,r++}return this.instance.PluginHooks.run("afterCreateCol",t,l,n),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(t,e){e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countRows()+t)%this.instance.countRows();var o=this.physicalRowsToLogical(t,e),n=this.instance.PluginHooks.execute("beforeRemoveRow",t,e);if(n!==!1){var i=this.dataSource,r=i.filter(function(t,e){return-1==o.indexOf(e)});i.length=0,Array.prototype.push.apply(i,r),this.instance.PluginHooks.run("afterRemoveRow",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,e){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");e||(e=1),"number"!=typeof t&&(t=-e),t=(this.instance.countCols()+t)%this.instance.countCols();var o=this.instance.PluginHooks.execute("beforeRemoveCol",t,e);if(o!==!1){for(var n=this.dataSource,i=0,r=this.instance.countRows();r>i;i++)n[i].splice(t,e);this.priv.columnSettings.splice(t,e),this.instance.PluginHooks.run("afterRemoveCol",t,e),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return e.helper.to2dArray(i),this.instance.populateFromArray(o,t,i,null,null,"spliceCol"),s},e.DataMap.prototype.spliceRow=function(t,o,n){var i=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtRow(t),s=r.slice(o,o+n),a=r.slice(o+n);e.helper.extendArray(i,a);for(var l=0;n>l;)i.push(null),l++;return this.instance.populateFromArray(t,o,[i],null,null,"spliceRow"),s},e.DataMap.prototype.get=function(t,e){if(this.getVars.row=t,this.getVars.prop=e,this.instance.PluginHooks.run("beforeGet",this.getVars),"string"==typeof this.getVars.prop&&this.getVars.prop.indexOf(".")>-1){var o=this.getVars.prop.split("."),n=this.dataSource[this.getVars.row];if(!n)return null;for(var i=0,r=o.length;r>i;i++)if(n=n[o[i]],"undefined"==typeof n)return null;return n}return"function"==typeof this.getVars.prop?this.getVars.prop(this.dataSource.slice(this.getVars.row,this.getVars.row+1)[0]):this.dataSource[this.getVars.row]?this.dataSource[this.getVars.row][this.getVars.prop]:null};var o=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(t,e){return o.call(this.instance,t,this.propToCol(e))?this.get(t,e):""},e.DataMap.prototype.set=function(t,e,o,n){if(this.setVars.row=t,this.setVars.prop=e,this.setVars.value=o,this.instance.PluginHooks.run("beforeSet",this.setVars,n||"datamapGet"),"string"==typeof this.setVars.prop&&this.setVars.prop.indexOf(".")>-1){for(var i=this.setVars.prop.split("."),r=this.dataSource[this.setVars.row],s=0,a=i.length-1;a>s;s++)r=r[i[s]];r[i[s]]=this.setVars.value}else"function"==typeof this.setVars.prop?this.setVars.prop(this.dataSource.slice(this.setVars.row,this.setVars.row+1)[0],this.setVars.value):this.dataSource[this.setVars.row][this.setVars.prop]=this.setVars.value},e.DataMap.prototype.physicalRowsToLogical=function(t,e){for(var o=this.instance.countRows(),n=(o+t)%o,i=[],r=e;o>n&&r;)this.get(n,0),i.push(this.getVars.row),r--,n++;return i},e.DataMap.prototype.clear=function(){for(var t=0;t<this.instance.countRows();t++)for(var e=0;e<this.instance.countCols();e++)this.set(t,this.colToProp(e),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(t,e,o){var n,i,r,s,a,l=[],c=o===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.max(t.row,e.row),s=Math.max(t.col,e.col),n=Math.min(t.row,e.row);i>=n;n++){for(a=[],r=Math.min(t.col,e.col);s>=r;r++)a.push(c.call(this,n,this.colToProp(r)));l.push(a)}return l},e.DataMap.prototype.getText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(t,e){return SheetClip.stringify(this.getRange(t,e,this.DESTINATION_CLIPBOARD_GENERATOR))}}(o),function(t){t.renderers.cellDecorator=function(t,e,o,n,i,r,s){s.readOnly&&t.view.wt.wtDom.addClass(e,s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName&&t.view.wt.wtDom.addClass(e,s.invalidCellClassName),!r&&s.placeholder&&t.view.wt.wtDom.addClass(e,s.placeholderCellClassName)}}(o),function(t){var e=function(e,o,n,i,r,s,a){t.renderers.cellDecorator.apply(this,arguments),!s&&a.placeholder&&(s=a.placeholder);var l=t.helper.stringify(s);if(a.rendererTemplate){e.view.wt.wtDom.empty(o);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=e.getDataAtRow(n),o.appendChild(c)}else e.view.wt.wtDom.fastInnerText(o,l)};t.renderers.TextRenderer=e,t.renderers.registerRenderer("text",e)}(o),function(t){var e=document.createElement("DIV");e.className="htAutocompleteWrapper";var o=document.createElement("DIV");o.className="htAutocompleteArrow",o.appendChild(document.createTextNode("▼"));var n=function(n,i,r,s,a,l,c){var h=(e.cloneNode(!0),o.cloneNode(!0));t.renderers.TextRenderer(n,i,r,s,a,l,c),i.appendChild(h),t.Dom.addClass(i,"htAutocomplete"),i.firstChild||i.appendChild(document.createTextNode(" ")),n.acArrowListener||(n.acArrowListener=function(){n.view.wt.getSetting("onCellDblClick")},n.rootElement.on("mousedown.htAutocompleteArrow",".htAutocompleteArrow",n.acArrowListener),n.addHookOnce("afterDestroy",function(){this.rootElement.off("mousedown.htAutocompleteArrow")}))};t.AutocompleteRenderer=n,t.renderers.AutocompleteRenderer=n,t.renderers.registerRenderer("autocomplete",n)}(o),function(e){var o=document.createElement("INPUT");o.className="htCheckboxRendererInput",o.type="checkbox",o.setAttribute("autocomplete","off");var n=function(n,i,r,s,a,l,c){"undefined"==typeof c.checkedTemplate&&(c.checkedTemplate=!0),"undefined"==typeof c.uncheckedTemplate&&(c.uncheckedTemplate=!1),n.view.wt.wtDom.empty(i);var h=o.cloneNode(!1);l===c.checkedTemplate||l===e.helper.stringify(c.checkedTemplate)?(h.checked=!0,i.appendChild(h)):l===c.uncheckedTemplate||l===e.helper.stringify(c.uncheckedTemplate)?i.appendChild(h):null===l?(h.className+=" noValue",i.appendChild(h)):n.view.wt.wtDom.fastInnerText(i,"#bad value#");var u=t(h);c.readOnly?u.on("click",function(t){t.preventDefault()}):(u.on("mousedown",function(t){t.stopPropagation()}),u.on("mouseup",function(t){t.stopPropagation()}),u.on("change",function(){this.checked?n.setDataAtRowProp(r,a,c.checkedTemplate):n.setDataAtRowProp(r,a,c.uncheckedTemplate)})),n.CheckboxRenderer&&n.CheckboxRenderer.beforeKeyDownHookBound||(n.CheckboxRenderer={beforeKeyDownHookBound:!0},n.addHook("beforeKeyDown",function(o){if(o.keyCode==e.helper.keyCode.SPACE)for(var i,r,s,a=n.getSelected(),l={row:Math.min(a[0],a[2]),col:Math.min(a[1],a[3])},c={row:Math.max(a[0],a[2]),col:Math.max(a[1],a[3])},h=l.row;h<=c.row;h++)for(var u=c.col;u<=c.col;u++)if(i=n.getCell(h,u),s=n.getCellMeta(h,u),r=i.querySelectorAll("input[type=checkbox]"),r.length>0&&!s.readOnly){o.isImmediatePropagationStopped()||(o.stopImmediatePropagation(),o.preventDefault());for(var d=0,p=r.length;p>d;d++)r[d].checked=!r[d].checked,t(r[d]).trigger("change")}}))};e.CheckboxRenderer=n,e.renderers.CheckboxRenderer=n,e.renderers.registerRenderer("checkbox",n)}(o),function(t){var e=function(e,o,n,i,r,s,a){t.helper.isNumeric(s)&&("undefined"!=typeof a.language&&numeral.language(a.language),s=numeral(s).format(a.format||"0"),e.view.wt.wtDom.addClass(o,"htNumeric")),t.renderers.TextRenderer(e,o,n,i,r,s,a)};t.NumericRenderer=e,t.renderers.NumericRenderer=e,t.renderers.registerRenderer("numeric",e)}(o),function(t){var e=function(t,e,n,i,r,s,a){o.renderers.TextRenderer.apply(this,arguments),s=e.innerHTML;var l,c=a.hashLength||s.length,h=a.hashSymbol||"*";for(l="";l.split(h).length-1<c;l+=h);t.view.wt.wtDom.fastInnerHTML(e,l)};t.PasswordRenderer=e,t.renderers.PasswordRenderer=e,t.renderers.registerRenderer("password",e)}(o),function(t){function e(e,o,n,i,r,s,a){t.renderers.cellDecorator.apply(this,arguments),t.Dom.fastInnerHTML(o,s)}t.renderers.registerRenderer("html",e),t.renderers.HtmlRenderer=e}(o),function(t){function e(e){this.instance=e,this.state=t.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},e.prototype._fireCallbacks=function(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)},e.prototype.init=function(){},e.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},e.prototype.setValue=function(t){throw Error("Editor setValue() method unimplemented")},e.prototype.open=function(){throw Error("Editor open() method unimplemented")},e.prototype.close=function(){throw Error("Editor close() method unimplemented")},e.prototype.prepare=function(e,o,n,i,r,s){this.TD=i,this.row=e,this.col=o,this.prop=n,this.originalValue=r,this.cellProperties=s,this.state=t.EditorState.VIRGIN},e.prototype.extend=function(){function t(){o.apply(this,arguments)}function e(t,e){function o(){}return o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t,t}var o=this.constructor;return e(t,o)},e.prototype.saveValue=function(t,e){if(e){var o=this.instance.getSelected();this.instance.populateFromArray(o[0],o[1],t,o[2],o[3],"edit")}else this.instance.populateFromArray(this.row,this.col,t,null,null,"edit")},e.prototype.beginEditing=function(e){this.state==t.EditorState.VIRGIN&&(this.instance.view.scrollViewport({row:this.row,col:this.col}),this.instance.view.render(),this.state=t.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(t.helper.stringify(e)),this.open(),this._opened=!0,this.focus(),this.instance.view.render())},e.prototype.finishEditing=function(e,o,n){if(n){var i=this._closeCallback;this._closeCallback=function(t){i&&i(t),n(t)}}if(!this.isWaiting()){if(this.state==t.EditorState.VIRGIN){var r=this;return void setTimeout(function(){r._fireCallbacks(!0)})}if(this.state==t.EditorState.EDITING){if(e)return void this.cancelChanges();var s=[[String.prototype.trim.call(this.getValue())]];if(this.state=t.EditorState.WAITING,this.saveValue(s,o),this.instance.getCellValidator(this.cellProperties)){var r=this;this.instance.addHookOnce("afterValidate",function(e){r.state=t.EditorState.FINISHED,r.discardEditor(e)})}else this.state=t.EditorState.FINISHED,this.discardEditor(!0)}}},e.prototype.cancelChanges=function(){this.state=t.EditorState.FINISHED,this.discardEditor()},e.prototype.discardEditor=function(e){this.state===t.EditorState.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=t.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=t.EditorState.VIRGIN,this._fireCallbacks(!0)))},e.prototype.isOpened=function(){return this._opened},e.prototype.isWaiting=function(){return this.state===t.EditorState.WAITING},t.editors.BaseEditor=e}(o),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.init=function(){this.createElements(),this.bindEvents()},o.prototype.getValue=function(){return this.TEXTAREA.value},o.prototype.setValue=function(t){this.TEXTAREA.value=t};var n=function(t){var o=this,n=o.getActiveEditor(),i=e.helper.keyCode,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if(t.target===n.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case i.ARROW_RIGHT:n.wtDom.getCaretPosition(n.TEXTAREA)!==n.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case i.ARROW_LEFT:0!==n.wtDom.getCaretPosition(n.TEXTAREA)&&t.stopImmediatePropagation();break;case i.ENTER:var s=n.instance.getSelected(),a=!(s[0]===s[2]&&s[1]===s[3]);(r&&!a||t.altKey)&&(n.isOpened()?(n.setValue(n.getValue()+"\n"),n.focus()):n.beginEditing(n.originalValue+"\n"),t.stopImmediatePropagation()),t.preventDefault();break;case i.A:case i.X:case i.C:case i.V:if(r){t.stopImmediatePropagation();break}case i.BACKSPACE:case i.DELETE:case i.HOME:case i.END:t.stopImmediatePropagation()}}};o.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",n)},o.prototype.close=function(){this.textareaParentStyle.display="none",document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",n)},o.prototype.focus=function(){this.TEXTAREA.focus(),this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},o.prototype.createElements=function(){this.$body=t(document.body),this.wtDom=new y,this.TEXTAREA=document.createElement("TEXTAREA"),this.$textarea=t(this.TEXTAREA),this.wtDom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var o=this;e.PluginHooks.add("afterRender",function(){o.instance.registerTimeout("refresh_editor_dimensions",function(){o.refreshDimensions()},0)})},o.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.instance.getCell(this.row,this.col),this.TD)){var o=t(this.TD),n=this.wtDom.offset(this.TD),i=this.wtDom.offset(this.instance.rootElement[0]),r=this.instance.rootElement.scrollTop(),s=this.instance.rootElement.scrollLeft(),a=n.top-i.top+r-1,l=n.left-i.left+s-1,c=this.instance.getSettings(),h=c.rowHeaders===!1?0:1,u=c.colHeaders===!1?0:1;0>a&&(a=0),0>l&&(l=0),h>0&&parseInt(o.css("border-top-width"),10)>0&&(a+=1),u>0&&parseInt(o.css("border-left-width"),10)>0&&(l+=1),this.textareaParentStyle.top=a+"px",this.textareaParentStyle.left=l+"px";var d=o.width(),p=this.instance.view.maximumVisibleElementWidth(l)-10,f=o.outerHeight()-4,g=this.instance.view.maximumVisibleElementHeight(a)-5;parseInt(o.css("border-top-width"),10)>0&&(f-=1),parseInt(o.css("border-left-width"),10)>0&&h>0&&(d-=1),this.$textarea.autoResize({minHeight:Math.min(f,g),maxHeight:g,minWidth:Math.min(d,p),maxWidth:p,animate:!1,extraSpace:0}),this.textareaParentStyle.display="block"}},o.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(t){t.stopPropagation()}),this.$textarea.on("paste.editor",function(t){t.stopPropagation()})},e.editors.TextEditor=o,e.editors.registerEditor("text",e.editors.TextEditor)}(o),function(e){var o=e.editors.BaseEditor.prototype.extend();o.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&t(e).trigger("click")},o.prototype.finishEditing=function(){},o.prototype.init=function(){},o.prototype.open=function(){},o.prototype.close=function(){},o.prototype.getValue=function(){},o.prototype.setValue=function(){},o.prototype.focus=function(){},e.editors.CheckboxEditor=o,e.editors.registerEditor("checkbox",o)}(o),function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.init=function(){if(!t.datepicker)throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?");e.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var o=this;this.instance.addHook("afterDestroy",function(){o.destroyElements()})},o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=99,document.body.appendChild(this.datePicker),this.$datePicker=t(this.datePicker);var o=this,n={dateFormat:"yy-mm-dd",showButtonPanel:!0,changeMonth:!0,changeYear:!0,onSelect:function(t){o.setValue(t),o.finishEditing(!1)}};this.$datePicker.datepicker(n),this.$datePicker.on("mousedown",function(t){t.stopPropagation()}),this.hideDatepicker()},o.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy"),this.$datePicker.remove()},o.prototype.open=function(){e.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},o.prototype.finishEditing=function(t,o){this.hideDatepicker(),e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},o.prototype.showDatepicker=function(){var e=t(this.TD),o=e.offset();this.datePickerStyle.top=o.top+e.height()+"px",this.datePickerStyle.left=o.left+"px";var n={defaultDate:this.originalValue||void 0};t.extend(n,this.cellProperties),this.$datePicker.datepicker("option",n),this.originalValue&&this.$datePicker.datepicker("setDate",this.originalValue),this.datePickerStyle.display="block"},o.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"},e.editors.DateEditor=o,e.editors.registerEditor("date",o)}(o),function(e){var o=e.editors.TextEditor.prototype.extend();o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var o=document.createElement("DIV");o.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(o),this.$htContainer=t(o),this.$htContainer.handsontable()},o.prototype.prepare=function(o,n,i,r,s,a){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var l=this,c={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var t=this.getValue();void 0!==t&&l.setValue(t),l.instance.destroyEditor()},beforeOnKeyDown:function(t){var o=this;switch(t.keyCode){case e.helper.keyCode.ESCAPE:l.instance.destroyEditor(!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ENTER:var n=o.getSelected(),i=this.getDataAtCell(n[0],n[1]);void 0!==i&&l.setValue(i),l.instance.destroyEditor();break;case e.helper.keyCode.ARROW_UP:o.getSelected()&&0==o.getSelected()[0]&&!l.cellProperties.strict&&(o.deselectCell(),l.instance.listen(),l.focus(),t.preventDefault(),t.stopImmediatePropagation())}}};this.cellProperties.handsontable&&(c=t.extend(c,a.handsontable)),this.$htContainer.handsontable("destroy"),this.$htContainer.handsontable(c)};var n=function(t){if(!t.isImmediatePropagationStopped()){var o=this.getActiveEditor(),n=o.$htContainer.handsontable("getInstance");if(t.keyCode==e.helper.keyCode.ARROW_DOWN){if(n.getSelected()){var i=n.getSelected()[0],r=i<n.countRows()-1?i+1:i;n.selectCell(r,0)}else n.selectCell(0,0);t.preventDefault(),t.stopImmediatePropagation()}}};o.prototype.open=function(){this.instance.addHook("beforeKeyDown",n),e.editors.TextEditor.prototype.open.apply(this,arguments),this.$htContainer.handsontable("render"),this.cellProperties.strict?(this.$htContainer.handsontable("selectCell",0,0),this.$textarea[0].style.visibility="hidden"):(this.$htContainer.handsontable("deselectCell"),this.$textarea[0].style.visibility="visible"),this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)},o.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},o.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},o.prototype.beginEditing=function(t){var o=this.instance.getSettings().onBeginEditing;o&&o()===!1||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},o.prototype.finishEditing=function(t,o){if(this.$htContainer.handsontable("isListening")&&this.instance.listen(),this.$htContainer.handsontable("getSelected")){var n=this.$htContainer.handsontable("getInstance").getValue();void 0!==n&&this.setValue(n)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},e.editors.HandsontableEditor=o,e.editors.registerEditor("handsontable",o)}(o),function(t){var e=t.editors.HandsontableEditor.prototype.extend();e.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},e.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments),this.$htContainer.addClass("autocompleteEditor")},e.prototype.bindEvents=function(){var e=this;this.$textarea.on("keydown.autocompleteEditor",function(o){t.helper.isMetaKey(o.keyCode)&&-1==[t.helper.keyCode.BACKSPACE,t.helper.keyCode.DELETE].indexOf(o.keyCode)?o.keyCode==t.helper.keyCode.ENTER&&e.cellProperties.strict!==!0&&e.$htContainer.handsontable("deselectCell"):setTimeout(function(){e.queryChoices(e.$textarea.val())})}),this.$htContainer.on("mouseleave",function(){e.cellProperties.strict===!0&&e.highlightBestMatchingChoice()}),this.$htContainer.on("mouseenter",function(){e.$htContainer.handsontable("deselectCell")}),t.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};var o;e.prototype.open=function(){t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.$textarea[0].style.visibility="visible",this.focus();var e=this.$htContainer.handsontable("getInstance"),n=this;e.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(t,e,o,i,r){var s=this.getCellMeta(e,o).filteringCaseSensitive===!0,a=s?r.indexOf(this.query):r.toLowerCase().indexOf(n.query.toLowerCase());if(-1!=a){var l=r.substr(a,n.query.length);t.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}),o=function(e){var o=this;e.keyCode==t.helper.keyCode.ARROW_UP&&o.getSelected()&&0==o.getSelected()[0]&&(parent.cellProperties.strict||o.deselectCell(),parent.instance.listen(),parent.focus(),e.preventDefault(),e.stopImmediatePropagation())},e.addHook("beforeKeyDown",o),this.queryChoices(this.TEXTAREA.value)},e.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",o),t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},e.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var o=this;this.cellProperties.source(e,function(t){o.updateChoicesList(t)})}else if(t.helper.isArray(this.cellProperties.source)){var n;if(e&&this.cellProperties.filter!==!1){var i=this.cellProperties.filteringCaseSensitive===!0,r=e.toLowerCase();n=this.cellProperties.source.filter(function(t){return i?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(r)})}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},e.prototype.updateChoicesList=function(e){this.choices=e,this.$htContainer.handsontable("loadData",t.helper.pivot([e])),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(),this.focus()},e.prototype.highlightBestMatchingChoice=function(){var t=this.findBestMatchingChoice();"undefined"==typeof t&&this.cellProperties.allowInvalid===!1&&(t=0),"undefined"==typeof t?this.$htContainer.handsontable("deselectCell"):this.$htContainer.handsontable("selectCell",t,0)},e.prototype.findBestMatchingChoice=function(){for(var t,e,o,n={},i=this.getValue().length,r=0,s=this.choices.length;s>r;r++)t=this.choices[r],e=i>0?t.indexOf(this.getValue()):t===this.getValue()?0:-1,-1!=e&&(o=t.length-e-i,("undefined"==typeof n.indexOfValue||n.indexOfValue>e||n.indexOfValue==e&&n.charsLeft>o)&&(n.indexOfValue=e,n.charsLeft=o,n.index=r));return n.index},t.editors.AutocompleteEditor=e,t.editors.registerEditor("autocomplete",e)}(o),function(e){var o=e.editors.TextEditor.prototype.extend(),n=new y;o.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.$textarea=t(this.TEXTAREA),n.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=o,e.editors.registerEditor("password",o)}(o),function(t){var e=t.editors.BaseEditor.prototype.extend();e.prototype.init=function(){this.select=document.createElement("SELECT"),t.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement[0].appendChild(this.select)},e.prototype.prepare=function(){t.editors.BaseEditor.prototype.prepare.apply(this,arguments);var e,o=this.cellProperties.selectOptions;e="function"==typeof o?this.prepareOptions(o(this.row,this.col,this.prop)):this.prepareOptions(o),t.Dom.empty(this.select);for(var n in e)if(e.hasOwnProperty(n)){var i=document.createElement("OPTION");i.value=n,t.Dom.fastInnerHTML(i,e[n]),this.select.appendChild(i)}},e.prototype.prepareOptions=function(e){var o={};if(t.helper.isArray(e))for(var n=0,i=e.length;i>n;n++)o[e[n]]=e[n];else"object"==typeof e&&(o=e);return o},e.prototype.getValue=function(){return this.select.value},e.prototype.setValue=function(t){this.select.value=t};var o=function(e){var o=this,n=o.getActiveEditor();switch(e.keyCode){case t.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),e.stopImmediatePropagation(),e.preventDefault();break;case t.helper.keyCode.ARROW_DOWN:var r=n.select.find("option:selected").next();1==r.length&&r.prop("selected",!0),e.stopImmediatePropagation(),e.preventDefault()}};e.prototype.open=function(){var e=t.Dom.outerWidth(this.TD),n=t.Dom.outerHeight(this.TD),i=t.Dom.offset(this.instance.rootElement[0]),r=t.Dom.offset(this.TD);this.select.style.height=n+"px",this.select.style.minWidth=e+"px",this.select.style.top=r.top-i.top+"px",this.select.style.left=r.left-i.left-2+"px",this.select.style.display="",this.instance.addHook("beforeKeyDown",o)},e.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",o)},e.prototype.focus=function(){this.select.focus()},t.editors.SelectEditor=e,t.editors.registerEditor("select",e)}(o),function(t){var e=t.editors.AutocompleteEditor.prototype.extend();e.prototype.prepare=function(){t.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},t.editors.DropdownEditor=e,t.editors.registerEditor("dropdown",e)}(o),o.NumericValidator=function(t,e){null===t&&(t=""),e(/^-?\d*\.?\d*$/.test(t))};var I=function(t,e){var o=t,n="string"==typeof o?o.toLowerCase():null;return function(t){for(var i=!1,r=0,s=t.length;s>r;r++){if(o===t[r]){i=!0;break}if(n===t[r].toLowerCase()){i=!0;break}}e(i)}};o.AutocompleteValidator=function(t,e){this.strict&&this.source?"function"==typeof this.source?this.source(t,I(t,e)):I(t,e)(this.source):e(!0)},o.AutocompleteCell={
editor:o.editors.AutocompleteEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.CheckboxCell={editor:o.editors.CheckboxEditor,renderer:o.renderers.CheckboxRenderer},o.TextCell={editor:o.editors.TextEditor,renderer:o.renderers.TextRenderer},o.NumericCell={editor:o.editors.TextEditor,renderer:o.renderers.NumericRenderer,validator:o.NumericValidator,dataType:"number"},o.DateCell={editor:o.editors.DateEditor,renderer:o.renderers.AutocompleteRenderer},o.HandsontableCell={editor:o.editors.HandsontableEditor,renderer:o.renderers.AutocompleteRenderer},o.PasswordCell={editor:o.editors.PasswordEditor,renderer:o.renderers.PasswordRenderer,copyable:!1},o.DropdownCell={editor:o.editors.DropdownEditor,renderer:o.renderers.AutocompleteRenderer,validator:o.AutocompleteValidator},o.cellTypes={text:o.TextCell,textCenter:o.TextCell,textHyperLink:o.TextCell,htTextHyperLinkLeftAlign:o.TextCell,date:o.DateCell,numeric:o.NumericCell,checkbox:o.CheckboxCell,autocomplete:o.AutocompleteCell,handsontable:o.HandsontableCell,password:o.PasswordCell,dropdown:o.DropdownCell},o.cellLookup={validator:{numeric:o.NumericValidator,autocomplete:o.AutocompleteValidator}},function(t){function e(n){return this.filter(e.resizableFilterSelector).each(function(){new o(t(this),n)}),this}function o(o,n){this.clones||(this.config=t.extend({},e.defaults,n),this.el=o,this.nodeName=o[0].nodeName.toLowerCase(),this.previousScrollTop=null,"original"===n.maxWidth&&(n.maxWidth=o.width()),"original"===n.minWidth&&(n.minWidth=o.width()),"original"===n.maxHeight&&(n.maxHeight=o.height()),"original"===n.minHeight&&(n.minHeight=o.height()),"textarea"===this.nodeName&&o.css({resize:"none",overflowY:"none"}),o.data("AutoResizer",this),this.createClone(),this.injectClone(),this.bind())}e.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500},e.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"],e.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"},e.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]",e.AutoResizer=o,t.fn.autoResize=e,o.prototype={bind:function(){var e=t.proxy(function(){return this.check(),!0},this);this.unbind(),this.el.bind("keyup.autoResize",e).bind("change.autoResize",e),this.check(null,!0)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var o=this.el,n=this,i=this.config;this.clones=t(),("original"!==i.minHeight||"original"!==i.maxHeight)&&(this.hClone=o.clone().height("auto"),this.clones=this.clones.add(this.hClone)),("original"!==i.minWidth||"original"!==i.maxWidth)&&(this.wClone=t("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"}),this.clones=this.clones.add(this.wClone)),t.each(e.cloneCSSProperties,function(t,e){n.clones.css(e,o.css(e))}),this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(e.cloneCSSValues).css("overflowY","scroll")},check:function(t,e){var o=this.config,n=this.wClone,i=this.hClone,r=this.el,s=r.val();if(n){n.text(s);var a=n.outerWidth(),l=a+o.extraSpace>=o.minWidth?a+o.extraSpace:o.minWidth,c=r.width();l=Math.min(l,o.maxWidth),(c>l&&l>=o.minWidth||l>=o.minWidth&&l<=o.maxWidth)&&(o.onResize.call(r),r.scrollLeft(0),o.animate&&!e?r.stop(1,1).animate({width:l},o.animate):r.width(l))}if(i){l&&i.width(l),i.height(0).val(s).scrollTop(1e4);var h=i[0].scrollTop+o.extraSpace;if(this.previousScrollTop===h)return;this.previousScrollTop=h,h>=o.maxHeight&&(h=o.maxHeight),h<o.minHeight&&(h=o.minHeight),h==o.maxHeight&&l==o.maxWidth?r.css("overflowY","scroll"):r.css("overflowY","hidden"),o.onResize.call(r),o.animate&&!e?r.stop(1,1).animate({height:h},o.animate):r.height(h)}},destroy:function(){this.unbind(),this.el.removeData("AutoResizer"),this.clones.remove(),delete this.el,delete this.hClone,delete this.wClone,delete this.clones},injectClone:function(){(e.cloneContainer||(e.cloneContainer=t("<arclones/>").appendTo("body"))).empty().append(this.clones)}}}(jQuery),function(t){function e(t){return t.split('"').length-1}t.SheetClip={parse:function(t){var o,n,i,r,s,a,l,c=[],h=0;for(i=t.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),o=0,n=i.length;n>o;o+=1){for(i[o]=i[o].split("	"),r=0,s=i[o].length;s>r;r+=1)c[h]||(c[h]=[]),a&&0===r?(l=c[h].length-1,c[h][l]=c[h][l]+"\n"+i[o][0],a&&1&e(i[o][0])&&(a=!1,c[h][l]=c[h][l].substring(0,c[h][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[o][r].indexOf('"')?(c[h].push(i[o][r].substring(1).replace(/""/g,'"')),a=!0):(c[h].push(i[o][r].replace(/""/g,'"')),a=!1);a||(h+=1)}return c},stringify:function(t){var e,o,n,i,r,s="";for(e=0,o=t.length;o>e;e+=1){for(n=0,i=t[e].length;i>n;n+=1)n>0&&(s+="	"),r=t[e][n],s+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;s+="\n"}return s}}}(e);var V=function(){var t;return{getInstance:function(){return t?t.hasBeenDestroyed()&&t.init():t=new n,t.refCounter++,t}}}();n.prototype.init=function(){var t,e,o=this;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this.listenerElement=document.documentElement,e=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",t=this.elDiv.style,t.position="fixed",t.top="-10000px",t.left="-10000px",e.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",t=this.elTextarea.style,t.width="10000px",t.height="10000px",t.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof t.opacity&&(t.opacity=0)),this.keydownListener=function(t){var e=!1;if(t.metaKey?e=!0:t.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(e=!0),e){if(document.activeElement!==o.elTextarea&&(""!=o.getSelectionText()||-1!=["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;o.selectNodeText(o.elTextarea),setTimeout(function(){o.selectNodeText(o.elTextarea)},0)}!e||67!==t.keyCode&&86!==t.keyCode&&88!==t.keyCode||(88===t.keyCode?setTimeout(function(){o.triggerCut(t)},0):86===t.keyCode&&setTimeout(function(){o.triggerPaste(t)},0))},this._bindEvent(this.listenerElement,"keydown",this.keydownListener)},n.prototype.selectNodeText=function(t){t.select()},n.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},n.prototype.copyable=function(t){if("string"!=typeof t&&void 0===t.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=t},n.prototype.onCut=function(t){this.cutCallbacks.push(t)},n.prototype.onPaste=function(t){this.pasteCallbacks.push(t)},n.prototype.removeCallback=function(t){var e,o;for(e=0,o=this.copyCallbacks.length;o>e;e++)if(this.copyCallbacks[e]===t)return this.copyCallbacks.splice(e,1),!0;for(e=0,o=this.cutCallbacks.length;o>e;e++)if(this.cutCallbacks[e]===t)return this.cutCallbacks.splice(e,1),!0;for(e=0,o=this.pasteCallbacks.length;o>e;e++)if(this.pasteCallbacks[e]===t)return this.pasteCallbacks.splice(e,1),!0;return!1},n.prototype.triggerCut=function(t){var e=this;e.cutCallbacks&&setTimeout(function(){for(var o=0,n=e.cutCallbacks.length;n>o;o++)e.cutCallbacks[o](t)},50)},n.prototype.triggerPaste=function(t,e){var o=this;o.pasteCallbacks&&setTimeout(function(){for(var n=(e||o.elTextarea.value).replace(/\n$/,""),i=0,r=o.pasteCallbacks.length;r>i;i++)o.pasteCallbacks[i](n,t)},50)},n.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&this.elDiv.parentNode.removeChild(this.elDiv),this._unbindEvent(this.listenerElement,"keydown",this.keydownListener))},n.prototype.hasBeenDestroyed=function(){return!this.refCounter},n.prototype._bindEvent=function(){return e.jQuery?function(e,o,n){t(e).on(o+".copypaste",n)}:function(t,e,o){t.addEventListener(e,o,!1)}}(),n.prototype._unbindEvent=function(){return e.jQuery?function(e,o,n){t(e).off(o+".copypaste",n)}:function(t,e,o){t.removeEventListener(e,o,!1)}}();var L;!function(t){function o(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function n(t,e){var i;for(var r in t)if(t.hasOwnProperty(r)){if(t[r]===e)return o(r)+"/";if("object"==typeof t[r]&&(i=n(t[r],e),""!=i))return o(r)+"/"+i}return""}function i(t,e){if(t===e)return"/";var o=n(t,e);if(""===o)throw new Error("Object not found in root");return"/"+o}function r(t){for(var e=0,o=y.length;o>e;e++)if(y[e].obj===t)return y[e]}function s(t,e){for(var o=0,n=t.observers.length;n>o;o++)if(t.observers[o].callback===e)return t.observers[o].observer}function a(t,e){for(var o=0,n=t.observers.length;n>o;o++)if(t.observers[o].observer===e)return void t.observers.splice(o,1)}function l(t,e){d(e),Object.observe?u(e,t):clearTimeout(e.next);var o=r(t);a(o,e)}function c(t,o){var n,a=[],l=t,c=r(t);if(c?n=s(c,o):(c=new v(t),y.push(c)),n)return n;if(Object.observe)n=function(e){u(n,t),h(n,t);for(var r=0,s=e.length;s>r;){if(("length"!==e[r].name||!S(e[r].object))&&"__Jasmine_been_here_before__"!==e[r].name){var c=e[r].type;switch(c){case"new":c="add";break;case"deleted":c="delete";break;case"updated":c="update"}w[c].call(e[r],a,i(l,e[r].object))}r++}a&&o&&o(a),n.patches=a,a=[]};else if(n={},c.value=JSON.parse(JSON.stringify(t)),o){n.callback=o,n.next=null;var p=this.intervals||[100,1e3,1e4,6e4],f=0,g=function(){d(n)},m=function(){clearTimeout(n.next),n.next=setTimeout(function(){g(),f=0,n.next=setTimeout(b,p[f++])},0)},b=function(){g(),f==p.length&&(f=p.length-1),n.next=setTimeout(b,p[f++])};"undefined"!=typeof e&&(e.addEventListener?(e.addEventListener("mousedown",m),e.addEventListener("mouseup",m),e.addEventListener("keydown",m)):(e.attachEvent("onmousedown",m),e.attachEvent("onmouseup",m),e.attachEvent("onkeydown",m))),n.next=setTimeout(b,p[f++])}return n.patches=a,n.object=t,c.observers.push(new C(o,n)),h(n,t)}function h(t,e){if(Object.observe){Object.observe(e,t);for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];n&&"object"==typeof n&&h(t,n)}}return t}function u(t,e){if(Object.observe){Object.unobserve(e,t);for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];n&&"object"==typeof n&&u(t,n)}}return t}function d(t){if(Object.observe)Object.deliverChangeRecords(t);else{for(var e,o=0,n=y.length;n>o;o++)if(y[o].obj===t.object){e=y[o];break}p(e.value,t.object,t.patches,"")}var i=t.patches;return i.length>0&&(t.patches=[],t.callback&&t.callback(i)),i}function p(t,e,n,i){for(var r=b(e),s=b(t),a=!1,l=!1,c=s.length-1;c>=0;c--){var h=s[c],u=t[h];if(e.hasOwnProperty(h)){var d=e[h];u instanceof Object?p(u,d,n,i+"/"+o(h)):u!=d&&(a=!0,n.push({op:"replace",path:i+"/"+o(h),value:d}),t[h]=d)}else n.push({op:"remove",path:i+"/"+o(h)}),delete t[h],l=!0}if(l||r.length!=s.length)for(var c=0;c<r.length;c++){var h=r[c];t.hasOwnProperty(h)||(n.push({op:"add",path:i+"/"+o(h),value:e[h]}),t[h]=JSON.parse(JSON.stringify(e[h])))}}function f(t,e){for(var o,n=!1,i=0,r=e.length;r>i;){o=e[i];for(var s=o.path.split("/"),a=t,l=1,c=s.length;;)if(S(a)){var h=parseInt(s[l],10);if(l++,l>=c){n=m[o.op].call(o,a,h,t);break}a=a[h]}else{var u=s[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),l++,l>=c){n=g[o.op].call(o,a,u,t);break}a=a[u]}i++}return n}var g={add:function(t,e){return t[e]=this.value,!0},remove:function(t,e){return delete t[e],!0},replace:function(t,e){return t[e]=this.value,!0},move:function(t,e,o){var n={op:"_get",path:this.from};return f(o,[n]),f(o,[{op:"remove",path:this.from}]),f(o,[{op:"add",path:this.path,value:n.value}]),!0},copy:function(t,e,o){var n={op:"_get",path:this.from};return f(o,[n]),f(o,[{op:"add",path:this.path,value:n.value}]),!0},test:function(t,e){return JSON.stringify(t[e])===JSON.stringify(this.value)},_get:function(t,e){this.value=t[e]}},m={add:function(t,e){return t.splice(e,0,this.value),!0},remove:function(t,e){return t.splice(e,1),!0},replace:function(t,e){return t[e]=this.value,!0},move:g.move,copy:g.copy,test:g.test,_get:g._get},w={add:function(t,e){var n={op:"add",path:e+o(this.name),value:this.object[this.name]};t.push(n)},"delete":function(t,e){var n={op:"remove",path:e+o(this.name)};t.push(n)},update:function(t,e){var n={op:"replace",path:e+o(this.name),value:this.object[this.name]};t.push(n)}},y=[];t.intervals;var v=function(){function t(t){this.observers=[],this.obj=t}return t}(),C=function(){function t(t,e){this.callback=t,this.observer=e}return t}();t.unobserve=l,t.observe=c,t.generate=d;var b;b=Object.keys?Object.keys:function(t){var e=[];for(var o in t)t.hasOwnProperty(o)&&e.push(o);return e};var S;S=Array.isArray?Array.isArray:function(t){return t.push&&"number"==typeof t.length},t.apply=f}(L||(L={})),"undefined"!=typeof exports&&(exports.apply=L.apply,exports.observe=L.observe,exports.unobserve=L.unobserve,exports.generate=L.generate),o.PluginHookClass=function(){function t(){this.hooks=e(),this.legacy=n}var e=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return t.prototype.add=function(t,e){if(o.helper.isArray(e))for(var i=0,r=e.length;r>i;i++)this.add(t,e[i]);else t in n&&(t=n[t]),"undefined"==typeof this.hooks[t]&&(this.hooks[t]=[]),-1==this.hooks[t].indexOf(e)&&this.hooks[t].push(e);return this},t.prototype.once=function(t,e){if(o.helper.isArray(e))for(var n=0,i=e.length;i>n;n++)e[n].runOnce=!0,this.add(t,e[n]);else e.runOnce=!0,this.add(t,e)},t.prototype.remove=function(t,e){var o=!1;if(t in n&&(t=n[t]),"undefined"!=typeof this.hooks[t])for(var i=0,r=this.hooks[t].length;r>i;i++)if(this.hooks[t][i]==e){delete this.hooks[t][i].runOnce,this.hooks[t].splice(i,1),o=!0;break}return o},t.prototype.run=function(t,e,o,i,r,s,a){if(e in n&&(e=n[e]),"undefined"!=typeof this.hooks[e])for(var l=Array.prototype.slice.call(this.hooks[e]),c=0,h=l.length;h>c;c++)l[c].call(t,o,i,r,s,a),l[c].runOnce&&this.remove(e,l[c])},t.prototype.execute=function(t,e,o,i,r,s,a){var l,c;if(e in n&&(e=n[e]),"undefined"!=typeof this.hooks[e]){c=Array.prototype.slice.call(this.hooks[e]);for(var h=0,u=c.length;u>h;h++)if(l=c[h].call(t,o,i,r,s,a),void 0!==l&&(o=l),c[h].runOnce&&this.remove(e,c[h]),l===!1)return!1}return o},t}(),o.PluginHooks=new o.PluginHookClass,function(t){function e(){function e(t){var e=document,o=this;o.table=e.createElement("table"),o.theadTh=e.createElement("th"),o.table.appendChild(e.createElement("thead")).appendChild(e.createElement("tr")).appendChild(o.theadTh),o.tableStyle=o.table.style,o.tableStyle.tableLayout="auto",o.tableStyle.width="auto",o.tbody=e.createElement("tbody"),o.table.appendChild(o.tbody),o.container=e.createElement("div"),o.container.className=t.rootElement[0].className+" hidden",o.containerStyle=o.container.style,o.container.appendChild(o.table)}var n=this,i=5;this.beforeInit=function(){var t=this;t.autoColumnWidths=[],t.getSettings().autoColumnSize!==!1?t.autoColumnSizeTmp||(t.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},t.addHook("beforeRender",o.determineIfChanged),t.addHook("afterGetColWidth",o.getColWidth),t.addHook("afterDestroy",o.afterDestroy),t.determineColumnWidth=n.determineColumnWidth):t.autoColumnSizeTmp&&(t.removeHook("beforeRender",o.determineIfChanged),t.removeHook("afterGetColWidth",o.getColWidth),t.removeHook("afterDestroy",o.afterDestroy),delete t.determineColumnWidth,n.afterDestroy.call(t))},this.determineIfChanged=function(t){t&&o.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(o){var n=this,r=n.autoColumnSizeTmp;r.container||e.call(r,n),r.container.className=n.rootElement[0].className+" htAutoColumnSize",r.table.className=n.$table[0].className;for(var s=n.countRows(),a={},l=0,c=0;s>c;c++){var h=t.helper.stringify(n.getDataAtCell(c,o)),u=h.length;u>l&&(l=u),a[u]||(a[u]={needed:i,strings:[]}),a[u].needed&&(a[u].strings.push({value:h,row:c}),a[u].needed--)}var d=n.getSettings();d.colHeaders&&n.view.appendColHeader(o,r.theadTh),n.view.wt.wtDom.empty(r.tbody);for(var p in a)if(a.hasOwnProperty(p))for(var f=0,g=a[p].strings.length;g>f;f++){var m=a[p].strings[f].row,w=n.getCellMeta(m,o);w.col=o,w.row=m;var y=n.getCellRenderer(w),v=document.createElement("tr"),C=document.createElement("td");y(n,C,m,o,n.colToProp(o),a[p].strings[f].value,w),c++,v.appendChild(C),r.tbody.appendChild(v)}var b=n.rootElement[0].parentNode;b.appendChild(r.container);var S=n.view.wt.wtDom.outerWidth(r.table);if(b.removeChild(r.container),!d.nativeScrollbars){var T=n.view.wt.wtViewport.getViewportWidth()-2;S>T&&(S=T)}return S},this.determineColumnsWidth=function(){var t=this,e=this.getSettings();if(e.autoColumnSize||!e.colWidths)for(var o=this.countCols(),i=0;o>i;i++)t._getColWidthFromSettings(i)||(this.autoColumnWidths[i]=n.determineColumnWidth.call(t,i))},this.getColWidth=function(t,e){this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e.width&&(e.width=this.autoColumnWidths[t])},this.afterDestroy=function(){var t=this;t.autoColumnSizeTmp&&t.autoColumnSizeTmp.container&&t.autoColumnSizeTmp.container.parentNode&&t.autoColumnSizeTmp.container.parentNode.removeChild(t.autoColumnSizeTmp.container),t.autoColumnSizeTmp=null}}var o=new e;t.PluginHooks.add("beforeInit",o.beforeInit),t.PluginHooks.add("afterUpdateSettings",o.beforeInit)}(o);var B=new i;o.PluginHooks.add("afterInit",function(){B.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){B.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("beforeGet",B.onBeforeGetSet),o.PluginHooks.add("beforeSet",B.onBeforeGetSet),o.PluginHooks.add("afterGetColHeader",B.getColHeader),function(e){function o(n,i){function r(){var o=t("body > .htContextMenu")[0];return o||(o=document.createElement("DIV"),e.Dom.addClass(o,"htContextMenu"),document.getElementsByTagName("body")[0].appendChild(o)),o}this.instance=n;var s=this;this.menu=r(),this.enabled=!0,this.bindMouseEvents(),this.bindTableEvents(),this.instance.addHook("afterDestroy",function(){s.destroy()}),this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(t,e){this.alter("insert_row",e.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(t,e){this.alter("insert_row",e.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:o.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(t,e){this.alter("insert_col",e.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(t,e){this.alter("insert_col",e.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:o.SEPARATOR,remove_row:{name:"Remove row",callback:function(t,e){var o=e.end.row()-e.start.row()+1;this.alter("remove_row",e.start.row(),o)}},remove_col:{name:"Remove column",callback:function(t,e){var o=e.end.col()-e.start.col()+1;this.alter("remove_col",e.start.col(),o)}},hsep3:o.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}},this.options={},e.helper.extend(this.options,this.defaultOptions),this.updateOptions(i)}function n(){var t=this,n=t.getSettings().contextMenu,i=e.helper.isObject(n)?n:{};n?(t.contextMenu||(t.contextMenu=new o(t,i)),t.contextMenu.enable(),e.helper.isArray(n)&&t.contextMenu.filterItems(n)):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}o.prototype.bindMouseEvents=function(){function n(n){n.preventDefault(),("TD"==n.target.nodeName||e.Dom.hasClass(n.target,"current")&&e.Dom.hasClass(n.target,"wtBorder"))&&(this.show(n.pageY,n.pageX),t(document).on("mousedown.htContextMenu",e.helper.proxy(o.prototype.close,this)))}this.instance.rootElement.on("contextmenu.htContextMenu",e.helper.proxy(n,this))},o.prototype.bindTableEvents=function(){var t=this;this._afterScrollCallback=function(){t.close()},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},o.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},o.prototype.performAction=function(){var e=t(this.menu).handsontable("getInstance"),n=e.getSelected()[0],i=e.getData()[n];if(i.disabled!==!0&&("function"!=typeof i.disabled||i.disabled.call(this.instance)!==!0)&&"function"==typeof i.callback){var r=this.instance.getSelected(),s=o.utils.normalizeSelection(r);i.callback.call(this.instance,i.key,s)}},o.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu"),t(document).off("mousedown.htContextMenu")},o.prototype.show=function(n,i){this.menu.style.display="block",t(this.menu).off("mousedown.htContextMenu").on("mousedown.htContextMenu",e.helper.proxy(this.performAction,this)),t(this.menu).handsontable({data:o.utils.convertItemsToArray(this.getItems()),colHeaders:!1,colWidths:[160],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],beforeKeyDown:e.helper.proxy(this.onBeforeKeyDown,this)}),this.bindTableEvents(),this.setMenuPosition(n,i),t(this.menu).handsontable("listen")},o.prototype.close=function(){this.hide(),t(document).off("mousedown.htContextMenu"),this.unbindTableEvents(),this.instance.listen()},o.prototype.hide=function(){this.menu.style.display="none",t(this.menu).handsontable("destroy")},o.prototype.renderer=function(n,i,r,s,a,l,c){function h(t){return new RegExp(o.SEPARATOR,"i").test(t.name)}function u(t,e){return t.disabled===!0||"function"==typeof t.disabled&&t.disabled.call(d.instance)===!0}var d=this,p=n.getData()[r],f=document.createElement("DIV");e.Dom.empty(i),i.appendChild(f),h(p)?e.Dom.addClass(i,"htSeparator"):e.Dom.fastInnerText(f,l),u(p,d.instance)?(e.Dom.addClass(i,"htDisabled"),t(f).on("mouseenter",function(){n.deselectCell()})):(e.Dom.removeClass(i,"htDisabled"),t(f).on("mouseenter",function(){n.selectCell(r,s)}))},o.prototype.onBeforeKeyDown=function(n){function i(t){var e=t.getCell(0,0);o.utils.isSeparator(e)||o.utils.isDisabled(e)?s(0,0,t):t.selectCell(0,0)}function r(t){var e=t.countRows()-1,n=t.getCell(e,0);o.utils.isSeparator(n)||o.utils.isDisabled(n)?a(e,0,t):t.selectCell(e,0)}function s(t,e,n){var i=t+1,r=i<n.countRows()?n.getCell(i,e):null;r&&(o.utils.isSeparator(r)||o.utils.isDisabled(r)?s(i,e,n):n.selectCell(i,e))}function a(t,e,n){var i=t-1,r=i>=0?n.getCell(i,e):null;r&&(o.utils.isSeparator(r)||o.utils.isDisabled(r)?a(i,e,n):n.selectCell(i,e))}var l=this,c=t(l.menu).handsontable("getInstance"),h=c.getSelected();switch(n.keyCode){case e.helper.keyCode.ESCAPE:l.close(),n.preventDefault(),n.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:c.getSelected()&&(l.performAction(),l.close());break;case e.helper.keyCode.ARROW_DOWN:h?s(h[0],h[1],c):i(c),n.preventDefault(),n.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:h?a(h[0],h[1],c):r(c),n.preventDefault(),n.stopImmediatePropagation()}},o.prototype.getItems=function(){function t(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var o={};t.prototype=this.options;for(var n in this.options.items)!this.options.items.hasOwnProperty(n)||this.itemsFilter&&-1==this.itemsFilter.indexOf(n)||(o[n]=new t(this.options.items[n]));return o},o.prototype.updateOptions=function(t){if(t=t||{},t.items)for(var o in t.items){var n={};t.items.hasOwnProperty(o)&&this.defaultOptions.items.hasOwnProperty(o)&&e.helper.isObject(t.items[o])&&(e.helper.extend(n,this.defaultOptions.items[o]),e.helper.extend(n,t.items[o]),t.items[o]=n)}e.helper.extend(this.options,t)},o.prototype.setMenuPosition=function(t,e){var o={top:t,topRelative:t-document.documentElement.scrollTop,left:e,leftRelative:e-document.documentElement.scrollLeft};this.menuFitsBelowCursor(o)?this.positionMenuBelowCursor(o):this.positionMenuAboveCursor(o),this.menuFitsOnRightOfCursor(o)?this.positionMenuOnRightOfCursor(o):this.positionMenuOnLeftOfCursor(o)},o.prototype.menuFitsBelowCursor=function(t){return t.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight},o.prototype.menuFitsOnRightOfCursor=function(t){return t.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth},o.prototype.positionMenuBelowCursor=function(t){this.menu.style.top=t.top+"px"},o.prototype.positionMenuAboveCursor=function(t){this.menu.style.top=t.top-this.menu.offsetHeight+"px"},o.prototype.positionMenuOnRightOfCursor=function(t){this.menu.style.left=t.left+"px"},o.prototype.positionMenuOnLeftOfCursor=function(t){this.menu.style.left=t.left-this.menu.offsetWidth+"px"},o.utils={},o.utils.convertItemsToArray=function(t){var e,o=[];for(var n in t)if(t.hasOwnProperty(n)){if("string"==typeof t[n])e={name:t[n]};else{if(t[n].visible===!1)continue;e=t[n]}e.key=n,o.push(e)}return o},o.utils.normalizeSelection=function(t){var o={start:new e.SelectionPoint,end:new e.SelectionPoint};return o.start.row(Math.min(t[0],t[2])),o.start.col(Math.min(t[1],t[3])),o.end.row(Math.max(t[0],t[2])),o.end.col(Math.max(t[1],t[3])),o},o.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},o.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},o.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},o.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.close(),this.unbindMouseEvents(),this.unbindTableEvents())},o.prototype.destroy=function(){this.close(),this.unbindMouseEvents(),this.unbindTableEvents(),this.isMenuEnabledByOtherHotInstance()||this.removeMenu()},o.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=t(".handsontable"),o=!1,n=0,i=e.length;i>n;n++){var r=t(e[n]).handsontable("getInstance");if(r&&r.getSettings().contextMenu){o=!0;break}}return o},o.prototype.removeMenu=function(){this.menu.parentNode&&this.menu.parentNode.removeChild(this.menu)},o.prototype.filterItems=function(t){this.itemsFilter=t},o.SEPARATOR="---------",e.PluginHooks.add("afterInit",n),e.PluginHooks.add("afterUpdateSettings",n),e.ContextMenu=o}(o),o.PluginHooks.add("beforeGetCellMeta",function(t,e,o){if(o.isWritable=!o.readOnly,o.autoComplete)throw new Error("Support for legacy autocomplete syntax was removed in Handsontable 0.10.0. Please remove the property named 'autoComplete' from your config. For replacement instructions, see wiki page https://github.com/warpech/jquery-handsontable/wiki/Migration-guide-to-0.10.x")});var _=new r;o.PluginHooks.add("beforeInit",_.beforeInit),o.PluginHooks.add("afterInit",function(){_.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){_.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColHeader",_.getColHeader),o.PluginHooks.add("modifyCol",_.modifyCol);var W=new s;o.PluginHooks.add("beforeInit",W.beforeInit),o.PluginHooks.add("afterInit",function(){W.init.call(this,"afterInit")}),o.PluginHooks.add("afterUpdateSettings",function(){W.init.call(this,"afterUpdateSettings")}),o.PluginHooks.add("afterGetColWidth",W.getColWidth),function(){function t(){var t=this,o=t.getSettings().observeChanges;o?(t.observer&&i.call(t),e.call(t),s.call(t)):o||i.call(t)}function e(){var t=this;t.observeChangesActive=!0,t.pauseObservingChanges=function(){t.observeChangesActive=!1},t.resumeObservingChanges=function(){t.observeChangesActive=!0},t.observedData=t.getData(),t.observer=L.observe(t.observedData,function(e){t.observeChangesActive&&(n.call(t,e),t.render()),t.runHooks("afterChangesObserved")})}function n(t){function e(t){var e;return e=n(t),e=o(e)}function o(t){var e=[];return t.filter(function(t){var o=i(t.path);if(-1!=["add","remove"].indexOf(t.op)&&!isNaN(o.col)){if(-1!=e.indexOf(o.col))return!1;e.push(o.col)}return!0})}function n(t){return t.filter(function(t){return!/[\/]length/gi.test(t.path)})}function i(t){var e=t.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(e[1],10),col:/^\d*$/.test(e[2])?parseInt(e[2],10):e[2]}}for(var r=this,s=e(t),a=0,l=s.length;l>a;a++){var c=s[a],h=i(c.path);switch(c.op){case"add":isNaN(h.col)?r.runHooks("afterCreateRow",h.row):r.runHooks("afterCreateCol",h.col);break;case"remove":isNaN(h.col)?r.runHooks("afterRemoveRow",h.row,1):r.runHooks("afterRemoveCol",h.col,1);break;case"replace":r.runHooks("afterChange",[h.row,h.col,null,c.value],"external")}}}function i(){var t=this;t.observer&&(r.call(t),a.call(t))}function r(){var t=this;L.unobserve(t.observedData,t.observer),delete t.observeChangesActive,delete t.pauseObservingChanges,delete t.resumeObservingChanges}function s(){var t=this;t.addHook("afterDestroy",i),t.addHook("afterCreateRow",l),t.addHook("afterRemoveRow",l),t.addHook("afterCreateCol",l),t.addHook("afterRemoveCol",l),t.addHook("afterChange",function(t,e){"loadData"!=e&&l.call(this)})}function a(){var t=this;t.removeHook("afterDestroy",i),t.removeHook("afterCreateRow",l),t.removeHook("afterRemoveRow",l),t.removeHook("afterCreateCol",l),t.removeHook("afterRemoveCol",l),t.removeHook("afterChange",l)}function l(){var t=this;t.pauseObservingChanges(),t.addHookOnce("afterChangesObserved",function(){t.resumeObservingChanges()})}o.PluginHooks.add("afterLoadData",t),o.PluginHooks.add("afterUpdateSettings",t)}(),function(t){function e(){function e(){var t=this;for(var e in r)r.hasOwnProperty(e)&&!n.call(t,e)&&t.PluginHooks.add(e,r[e])}function o(){var t=this;for(var e in r)r.hasOwnProperty(e)&&n.call(t,e)&&t.PluginHooks.remove(e,r[e])}function n(t){var e=this;return e.PluginHooks.hooks.hasOwnProperty(t)}var i=this;this.init=function(){var n=this,r=n.getSettings().persistentState;return i.enabled=!!r,i.enabled?(n.storage||(n.storage=new t(n.rootElement[0].id)),n.resetState=i.resetValue,void e.call(n)):void o.call(n)},this.saveValue=function(t,e){var o=this;o.storage.saveValue(t,e)},this.loadValue=function(t,e){var o=this;e.value=o.storage.loadValue(t)},this.resetValue=function(t){var e=this;"undefined"!=typeof t?e.storage.reset(t):e.storage.resetAll()};var r={persistentStateSave:i.saveValue,persistentStateLoad:i.loadValue,persistentStateReset:i.resetValue}}var n=new e;o.PluginHooks.add("beforeInit",n.init),o.PluginHooks.add("afterUpdateSettings",n.init)}(a),
function(e){e.UndoRedo=function(t){var o=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t,n){if(t){var i=new e.UndoRedo.ChangeAction(t);o.done(i)}}),t.addHook("afterCreateRow",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateRowAction(t,n);o.done(r)}}),t.addHook("beforeRemoveRow",function(t,n){var i=o.instance.getData();t=(i.length+t)%i.length;var r=i.slice(t,t+n),s=new e.UndoRedo.RemoveRowAction(t,r);o.done(s)}),t.addHook("afterCreateCol",function(t,n,i){if(!i){var r=new e.UndoRedo.CreateColumnAction(t,n);o.done(r)}}),t.addHook("beforeRemoveCol",function(n,i){var r=o.instance.getData();n=(o.instance.countCols()+n)%o.instance.countCols();for(var s=[],a=0,l=r.length;l>a;a++)s[a]=r[a].slice(n,n+i);var c;e.helper.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(n,n+s.length));var h=new e.UndoRedo.RemoveColumnAction(n,s,c);o.done(h)})},e.UndoRedo.prototype.done=function(t){this.ignoreNewActions||(this.doneActions.push(t),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var t=this.doneActions.pop();this.ignoreNewActions=!0;var e=this;t.undo(this.instance,function(){e.ignoreNewActions=!1,e.undoneActions.push(t)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var t=this.undoneActions.pop();this.ignoreNewActions=!0;var e=this;t.redo(this.instance,function(){e.ignoreNewActions=!1,e.doneActions.push(t)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(t){this.changes=t},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(e,o){for(var n=t.extend(!0,[],this.changes),i=0,r=n.length;r>i;i++)n[i].splice(3,1);e.addHookOnce("afterChange",o),e.setDataAtRowProp(n,null,null,"undo")},e.UndoRedo.ChangeAction.prototype.redo=function(e,o){for(var n=t.extend(!0,[],this.changes),i=0,r=n.length;r>i;i++)n[i].splice(2,1);e.addHookOnce("afterChange",o),e.setDataAtRowProp(n,null,null,"redo")},e.UndoRedo.CreateRowAction=function(t,e){this.index=t,this.amount=e},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(t,e){this.index=t,this.data=e},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(t,e){var o=[this.index,0];Array.prototype.push.apply(o,this.data),Array.prototype.splice.apply(t.getData(),o),t.addHookOnce("afterRender",e),t.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(t,e){this.index=t,this.amount=e},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.RemoveColumnAction=function(t,e,o){this.index=t,this.data=e,this.amount=this.data[0].length,this.headers=o},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(t,e){for(var o,n,i=0,r=t.getData().length;r>i;i++)o=t.getDataAtRow(i),n=[this.index,0],Array.prototype.push.apply(n,this.data[i]),Array.prototype.splice.apply(o,n);"undefined"!=typeof this.headers&&(n=[this.index,0],Array.prototype.push.apply(n,this.headers),Array.prototype.splice.apply(t.getSettings().colHeaders,n)),t.addHookOnce("afterRender",e),t.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount)}}(o),function(t){function e(){var e=this,s="undefined"==typeof e.getSettings().undo||e.getSettings().undo;s?e.undoRedo||(e.undoRedo=new t.UndoRedo(e),i(e),e.addHook("beforeKeyDown",o),e.addHook("afterChange",n)):e.undoRedo&&(delete e.undoRedo,r(e),e.removeHook("beforeKeyDown",o),e.removeHook("afterChange",n))}function o(t){var e=this,o=(t.ctrlKey||t.metaKey)&&!t.altKey;o&&(89===t.keyCode||t.shiftKey&&90===t.keyCode?(e.undoRedo.redo(),t.stopImmediatePropagation()):90===t.keyCode&&(e.undoRedo.undo(),t.stopImmediatePropagation()))}function n(t,e){var o=this;return"loadData"==e?o.undoRedo.clear():void 0}function i(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function r(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}t.PluginHooks.add("afterInit",e),t.PluginHooks.add("afterUpdateSettings",e)}(o),l.prototype.setBoundaries=function(t){this.boundaries=t},l.prototype.setCallback=function(t){this.callback=t},l.prototype.check=function(t,e){var o=0,n=0;e<this.boundaries.top?n=e-this.boundaries.top:e>this.boundaries.bottom&&(n=e-this.boundaries.bottom),t<this.boundaries.left?o=t-this.boundaries.left:t>this.boundaries.right&&(o=t-this.boundaries.right),this.callback(o,n)};var z,F=!1;if("undefined"!=typeof o){var U=function(t){var o=t.view.wt.wtScrollbars.vertical.scrollHandler;z=new l,o!==e&&(o?z.setBoundaries(o.getBoundingClientRect()):z.setBoundaries(t.$table[0].getBoundingClientRect()),z.setCallback(function(e,n){0>e?o?o.scrollLeft-=50:t.view.wt.scrollHorizontal(-1).draw():e>0&&(o?o.scrollLeft+=50:t.view.wt.scrollHorizontal(1).draw()),0>n?o?o.scrollTop-=20:t.view.wt.scrollVertical(-1).draw():n>0&&(o?o.scrollTop+=20:t.view.wt.scrollVertical(1).draw())}),F=!0)};o.PluginHooks.add("afterInit",function(){t(document).on("mouseup."+this.guid,function(){F=!1}),t(document).on("mousemove."+this.guid,function(t){F&&z.check(t.clientX,t.clientY)})}),o.PluginHooks.add("destroy",function(){t(document).off("."+this.guid)}),o.PluginHooks.add("afterOnCellMouseDown",function(){U(this)}),o.PluginHooks.add("afterOnCellCornerMouseDown",function(){U(this)}),o.plugins.DragToScroll=l}if(function(t,e,o){function n(n){function i(){n.isListening()&&n.selection.empty()}function r(t){if(n.isListening()&&n.selection.isSelected()){var e=t.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),i=o.parse(e),r=n.getSelected(),s=n.getCornerCoords([{row:r[0],col:r[1]},{row:r[2],col:r[3]}]),a=s.TL,l={row:Math.max(s.BR.row,i.length-1+s.TL.row),col:Math.max(s.BR.col,i[0].length-1+s.TL.col)};n.PluginHooks.once("afterChange",function(t,e){t&&t.length&&this.selectCell(a.row,a.col,l.row,l.col)}),n.populateFromArray(a.row,a.col,i,l.row,l.col,"paste",n.getSettings().pasteMode)}}function s(e){if(t.helper.isCtrlKey(e.keyCode)&&n.getSelected())return a.setCopyableText(),void e.stopImmediatePropagation();var o=(e.ctrlKey||e.metaKey)&&!e.altKey;e.keyCode==t.helper.keyCode.A&&o&&setTimeout(t.helper.proxy(a.setCopyableText,a))}this.copyPasteInstance=e.getInstance(),this.copyPasteInstance.onCut(i),this.copyPasteInstance.onPaste(r);var a=this;n.addHook("beforeKeyDown",s),this.destroy=function(){this.copyPasteInstance.removeCallback(i),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),n.removeHook("beforeKeyDown",s)},n.addHook("afterDestroy",t.helper.proxy(this.destroy,this)),this.triggerPaste=t.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=t.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=n.getSelected(),e=n.getSettings(),o=e.copyRowsLimit,i=e.copyColsLimit,r=Math.min(t[0],t[2]),s=Math.min(t[1],t[3]),a=Math.max(t[0],t[2]),l=Math.max(t[1],t[3]),c=Math.min(a,r+o-1),h=Math.min(l,s+i-1);n.copyPaste.copyPasteInstance.copyable(n.getCopyableData(r,s,c,h)),(a!==c||l!==h)&&n.PluginHooks.run("afterCopyLimit",a-r+1,l-s+1,o,i)}}function i(){var t=this,e=t.getSettings().copyPaste!==!1;e&&!t.copyPaste?t.copyPaste=new n(t):!e&&t.copyPaste&&(t.copyPaste.destroy(),delete t.copyPaste)}t.PluginHooks.add("afterInit",i),t.PluginHooks.add("afterUpdateSettings",i)}(o,V,SheetClip),function(t){function e(){var e=this,o=!!e.getSettings().search;o?e.search=new t.Search(e):delete e.search}t.Search=function(e){this.query=function(o,n,i){var r=e.countRows(),s=e.countCols(),a=[];n||(n=t.Search.global.getDefaultCallback()),i||(i=t.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;s>c;c++){var h=e.getDataAtCell(l,c),u=e.getCellMeta(l,c),d=u.search.callback||n,p=u.search.queryMethod||i,f=p(o,h);if(f){var g={row:l,col:c,data:h};a.push(g)}d&&d(e,l,c,h,f)}return a}},t.Search.DEFAULT_CALLBACK=function(t,e,o,n,i){t.getCellMeta(e,o).isSearchResult=i},t.Search.DEFAULT_QUERY_METHOD=function(t,e){return"undefined"!=typeof t&&null!=t&&t.toLowerCase&&0!=t.length?-1!=e.toString().toLowerCase().indexOf(t.toLowerCase()):!1},t.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",t.Search.global=function(){var e=t.Search.DEFAULT_CALLBACK,o=t.Search.DEFAULT_QUERY_METHOD,n=t.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return e},setDefaultCallback:function(t){e=t},getDefaultQueryMethod:function(){return o},setDefaultQueryMethod:function(t){o=t},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(t){n=t}}}(),t.SearchCellDecorator=function(e,o,n,i,r,s,a){var l="object"==typeof a.search&&a.search.searchResultClass||t.Search.global.getDefaultSearchResultClass();a.isSearchResult?t.Dom.addClass(o,l):t.Dom.removeClass(o,l)};var o=t.renderers.cellDecorator;t.renderers.cellDecorator=function(e,n,i,r,s,a,l){o.apply(this,arguments),t.SearchCellDecorator.apply(this,arguments)},t.PluginHooks.add("afterInit",e),t.PluginHooks.add("afterUpdateSettings",e)}(o),c.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.fixed.style.position="absolute",this.fixed.style.left="0",this.scrollHandler=this.getScrollableElement(this.TABLE),this.$scrollHandler=t(this.scrollHandler)},c.prototype.makeClone=function(t){var e=document.createElement("DIV");e.className="ht_clone_"+t+" handsontable",e.style.position="fixed",e.style.overflow="hidden";var o=document.createElement("TABLE");return o.className=this.instance.wtTable.TABLE.className,e.appendChild(o),this.instance.wtTable.holder.parentNode.appendChild(e),new m({cloneSource:this.instance,cloneOverlay:this,table:o})},c.prototype.getScrollableElement=function(t){for(var o=t.parentNode;o&&o.style;){if("visible"!==o.style.overflow&&""!==o.style.overflow)return o;if(this instanceof x&&"visible"!==o.style.overflowX&&""!==o.style.overflowX)return o;o=o.parentNode}return e},c.prototype.prepare=function(){},c.prototype.onScroll=function(t){this.windowScrollPosition=this.getScrollPosition(),this.readSettings(),t&&(this.windowScrollPosition=t),this.resetFixedPosition()},c.prototype.availableSize=function(){var t;return t=this.windowScrollPosition>this.tableParentOffset?this.instance.wtTable.getLastVisibleRow()===this.total-1?this.instance.wtDom.outerHeight(this.TABLE):this.windowSize:this.windowSize-this.tableParentOffset},c.prototype.refresh=function(t){var e=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset),-1===e?this.measureAfter=0:this.measureAfter=this.sumCellSizes(e,this.total-e),this.applyToDOM(),this.clone&&this.clone.draw(t)},c.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid),t(e).off("."+this.instance.guid),t(document).off("."+this.instance.guid)},h.prototype.appear=function(t){var e,o,n,i,r,s,a,l,c,h,u,d;if(!this.disabled){var p,f,g,m,w,y,v,C=this.instance,b=!1,S=!1,T=!1,R=!1;for(C.wtTable.isRowInViewport(t[0])||(b=!0),C.wtTable.isRowInViewport(t[2])||(T=!0),y=C.wtTable.rowStrategy.countVisible(),w=0;y>w;w++)if(v=C.wtTable.rowFilter.visibleToSource(w),v>=t[0]&&v<=t[2]){p=v;break}for(w=y-1;w>=0;w--)if(v=C.wtTable.rowFilter.visibleToSource(w),v>=t[0]&&v<=t[2]){g=v;break}if(b&&T)S=!0,R=!0;else{for(C.wtTable.isColumnInViewport(t[1])||(S=!0),C.wtTable.isColumnInViewport(t[3])||(R=!0),y=C.wtTable.columnStrategy.countVisible(),w=0;y>w;w++)if(v=C.wtTable.columnFilter.visibleToSource(w),v>=t[1]&&v<=t[3]){f=v;break}for(w=y-1;w>=0;w--)if(v=C.wtTable.columnFilter.visibleToSource(w),v>=t[1]&&v<=t[3]){m=v;break}}if(void 0===p||void 0===f)return void this.disappear();e=p!==g||f!==m,o=C.wtTable.getCell([p,f]),n=e?C.wtTable.getCell([g,m]):o,i=this.wtDom.offset(o),r=e?this.wtDom.offset(n):i,s=this.wtDom.offset(C.wtTable.TABLE),l=i.top,u=r.top+this.wtDom.outerHeight(n)-l,h=i.left,d=r.left+this.wtDom.outerWidth(n)-h,a=l-s.top-1,c=h-s.left-1;var E=this.wtDom.getComputedStyle(o);parseInt(E.borderTopWidth,10)>0&&(a+=1,u=u>0?u-1:0),parseInt(E.borderLeftWidth,10)>0&&(c+=1,d=d>0?d-1:0),b?this.topStyle.display="none":(this.topStyle.top=a+"px",this.topStyle.left=c+"px",this.topStyle.width=d+"px",this.topStyle.display="block"),S?this.leftStyle.display="none":(this.leftStyle.top=a+"px",this.leftStyle.left=c+"px",this.leftStyle.height=u+"px",this.leftStyle.display="block");var x=Math.floor(this.settings.border.width/2);T?this.bottomStyle.display="none":(this.bottomStyle.top=a+u-x+"px",this.bottomStyle.left=c+"px",this.bottomStyle.width=d+"px",this.bottomStyle.display="block"),R?this.rightStyle.display="none":(this.rightStyle.top=a+"px",this.rightStyle.left=c+d-x+"px",this.rightStyle.height=u+1+"px",this.rightStyle.display="block"),T||R||!this.hasSetting(this.settings.border.cornerVisible)?this.cornerStyle.display="none":(this.cornerStyle.top=a+u-4+"px",this.cornerStyle.left=c+d-4+"px",this.cornerStyle.display="block")}},h.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none"},h.prototype.hasSetting=function(t){return"function"==typeof t?t():!!t},u.prototype.source=function(t){return t},u.prototype.offsetted=function(t){return t+this.offset},u.prototype.unOffsetted=function(t){return t-this.offset},u.prototype.fixed=function(t){return t<this.fixedCount?t-this.offset:t},u.prototype.unFixed=function(t){return t<this.fixedCount?t+this.offset:t},u.prototype.visibleToSource=function(t){return this.source(this.offsetted(this.fixed(t)))},u.prototype.sourceToVisible=function(t){return this.source(this.unOffsetted(this.unFixed(t)))},d.prototype.getSize=function(t){return this.cellSizes[t]},d.prototype.getContainerSize=function(t){return"function"==typeof this.containerSizeFn?this.containerSizeFn(t):this.containerSizeFn},d.prototype.countVisible=function(){return this.cellCount},d.prototype.isLastIncomplete=function(){if(this.instance.getSetting("nativeScrollbars")){var t=this.instance.cloneFrom?this.instance.cloneFrom.wtScrollbars.vertical:this.instance.wtScrollbars.vertical;return this.remainingSize>t.sumCellSizes(t.offset,t.offset+t.curOuts+1)}return this.remainingSize>0},p.prototype.add=function(t,e,o){this.cache[t]||(this.cache[t]=[]),this.cache[t][e]||(this.cache[t][e]=[]),this.cache[t][e][o]=!0},p.prototype.test=function(t,e,o){return this.cache[t]&&this.cache[t][e]&&this.cache[t][e][o]},f.prototype=new u,f.prototype.readSettings=function(t){this.offset=t.wtSettings.settings.offsetColumn,this.total=t.getSetting("totalColumns"),this.fixedCount=t.getSetting("fixedColumnsLeft"),this.countTH=t.getSetting("rowHeaders").length},f.prototype.offsettedTH=function(t){return t-this.countTH},f.prototype.unOffsettedTH=function(t){return t+this.countTH},f.prototype.visibleRowHeadedColumnToSourceColumn=function(t){return this.visibleToSource(this.offsettedTH(t))},f.prototype.sourceColumnToVisibleRowHeadedColumn=function(t){return this.unOffsettedTH(this.sourceToVisible(t))},g.prototype=new d,g.prototype.getSize=function(t){return this.cellSizes[t]+(this.cellStretch[t]||0)},g.prototype.stretch=function(){var t=this.getContainerSize(this.cellSizesSum),e=0;if(this.remainingSize=this.cellSizesSum-t,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var o,n=t/this.cellSizesSum;e<this.cellCount-1;)o=Math.floor(n*this.cellSizes[e]),this.remainingSize+=o-this.cellSizes[e],this.cellStretch[e]=o-this.cellSizes[e],e++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&t!==1/0&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},m.prototype.draw=function(t){return this.drawInterrupted=!1,t||this.wtDom.isVisible(this.wtTable.TABLE)?(this.getSetting("beforeDraw",!t),t=t&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn,this.drawn&&(this.scrollVertical(0),this.scrollHorizontal(0)),this.lastOffsetRow=this.getSetting("offsetRow"),this.lastOffsetColumn=this.getSetting("offsetColumn"),this.wtTable.draw(t),this.cloneSource||this.getSetting("onDraw",!t),this):void(this.drawInterrupted=!0)},m.prototype.update=function(t,e){return this.wtSettings.update(t,e)},m.prototype.scrollVertical=function(t){var e=this.wtScroll.scrollVertical(t);return this.getSetting("onScrollVertically"),e},m.prototype.scrollHorizontal=function(t){var e=this.wtScroll.scrollHorizontal(t);return this.getSetting("onScrollHorizontally"),e},m.prototype.scrollViewport=function(t){return this.wtScroll.scrollViewport(t),this},m.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},m.prototype.getSetting=function(t,e,o,n){return this.wtSettings.getSetting(t,e,o,n)},m.prototype.hasSetting=function(t){return this.wtSettings.has(t)},m.prototype.destroy=function(){t(document.body).off("."+this.guid),this.wtScrollbars.destroy(),clearTimeout(this.wheelTimeout),this.wtEvent&&this.wtEvent.destroy()},w.prototype=new c,w.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode,e=this.instance.wtTable.holder.getBoundingClientRect();t.style.top=Math.ceil(e.top,10)+"px",t.style.left=Math.ceil(e.left,10)+"px"}},w.prototype.prepare=function(){},w.prototype.refresh=function(t){this.clone&&this.clone.draw(t)},w.prototype.getScrollPosition=function(){},w.prototype.getLastCell=function(){},w.prototype.applyToDOM=function(){},w.prototype.scrollTo=function(){},w.prototype.readWindowSize=function(){},w.prototype.readSettings=function(){},y.prototype.closest=function(t,e,o){for(;null!=t&&t!==o;){if(1===t.nodeType&&e.indexOf(t.nodeName)>-1)return t;t=t.parentNode}return null},y.prototype.isChildOf=function(t,e){for(var o=t.parentNode;null!=o;){if(o==e)return!0;o=o.parentNode}return!1},y.prototype.index=function(t){for(var e=0;t=t.previousSibling;)++e;return e},document.documentElement.classList?(y.prototype.hasClass=function(t,e){return t.classList.contains(e)},y.prototype.addClass=function(t,e){t.classList.add(e)},y.prototype.removeClass=function(t,e){t.classList.remove(e)}):(y.prototype.hasClass=function(t,e){return t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))},y.prototype.addClass=function(t,e){this.hasClass(t,e)||(t.className+=" "+e)},y.prototype.removeClass=function(t,e){if(this.hasClass(t,e)){var o=new RegExp("(\\s|^)"+e+"(\\s|$)");t.className=t.className.replace(o," ").trim()}}),y.prototype.removeTextNodes=function(t,e){if(3===t.nodeType)e.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1)for(var o=t.childNodes,n=o.length-1;n>=0;n--)this.removeTextNodes(o[n],t)},y.prototype.empty=function(t){for(var e;e=t.lastChild;)t.removeChild(e)},y.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,y.prototype.fastInnerHTML=function(t,e){this.HTML_CHARACTERS.test(e)?t.innerHTML=e:this.fastInnerText(t,e)},document.createTextNode("test").textContent?y.prototype.fastInnerText=function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.textContent=e:(this.empty(t),t.appendChild(document.createTextNode(e)))}:y.prototype.fastInnerText=function(t,e){var o=t.firstChild;o&&3===o.nodeType&&null===o.nextSibling?o.data=e:(this.empty(t),t.appendChild(document.createTextNode(e)))},y.prototype.isVisible=function(t){for(var e=t;e!==document.documentElement;){if(null===e)return!1;if(11===e.nodeType){if(e.host){if(e.host.impl)return y.prototype.isVisible(e.host.impl);if(e.host)return y.prototype.isVisible(e.host);throw new Error("Lost in Web Components world")}return!1}if("none"===e.style.display)return!1;e=e.parentNode}return!0},y.prototype.offset=function(t){if(this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName){var o=t.getBoundingClientRect();return{top:o.top+(e.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:o.left+(e.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}for(var n=t.offsetLeft,i=t.offsetTop,r=t;(t=t.offsetParent)&&t!==document.body;)n+=t.offsetLeft,i+=t.offsetTop,r=t;return r&&"fixed"===r.style.position&&(n+=e.pageXOffset||document.documentElement.scrollLeft,i+=e.pageYOffset||document.documentElement.scrollTop),{left:n,top:i}},y.prototype.getComputedStyle=function(t){return t.currentStyle||document.defaultView.getComputedStyle(t)},y.prototype.outerWidth=function(t){return t.offsetWidth},y.prototype.outerHeight=function(t){return this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName?t.offsetHeight+t.firstChild.offsetHeight:t.offsetHeight},function(){function t(){var t=document.createElement("TABLE");t.style.borderSpacing=0,t.style.borderWidth=0,t.style.padding=0;var e=document.createElement("TBODY");t.appendChild(e),e.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,t.insertBefore(n,e),document.body.appendChild(t),o=t.offsetHeight<2*t.lastChild.offsetHeight,document.body.removeChild(t)}function e(){var t=document.createElement("p");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),(document.body||document.documentElement).appendChild(e);var o=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return o==n&&(n=e.clientWidth),(document.body||document.documentElement).removeChild(e),o-n}var o;y.prototype.hasCaptionProblem=function(){return void 0===o&&t(),o},y.prototype.getCaretPosition=function(t){if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var o=t.createTextRange(),n=o.duplicate();return o.moveToBookmark(e.getBookmark()),n.setEndPoint("EndToStart",o),n.text.length}return 0},y.prototype.setCaretPosition=function(t,e,o){if(void 0===o&&(o=e),t.setSelectionRange)t.focus(),t.setSelectionRange(e,o);else if(t.createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",o),n.moveStart("character",e),n.select()}};var n;y.prototype.getScrollbarWidth=function(){return void 0===n&&(n=e()),n}}(),v.prototype.parentCell=function(t){var e={},o=this.instance.wtTable.TABLE,n=this.wtDom.closest(t,["TD","TH"],o);return n&&this.wtDom.isChildOf(n,o)?(e.coords=this.instance.wtTable.getCoords(n),e.TD=n):this.wtDom.hasClass(t,"wtBorder")&&this.wtDom.hasClass(t,"current")&&(e.coords=this.instance.selections.current.selected[0],e.TD=this.instance.wtTable.getCell(e.coords)),e},v.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0),clearTimeout(this.dblClickTimeout1)},e.requestAnimFrame=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,o){return e.setTimeout(t,1e3/60)}}(),e.cancelRequestAnimFrame=function(){return e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),e.getComputedStyle||!function(){var t,o={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,o}}(),!String.prototype.trim){var j=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(j,"")}}b.prototype=new u,b.prototype.readSettings=function(t){t.cloneOverlay instanceof w?this.offset=0:this.offset=t.wtSettings.settings.offsetRow,this.total=t.getSetting("totalRows"),this.fixedCount=t.getSetting("fixedRowsTop")},S.prototype=new d,S.prototype.add=function(t,e,o){if(!this.isLastIncomplete()&&0!=this.remainingSize){var n=this.sizeAtIndex(t,e);if(void 0===n)return!1;var i=this.getContainerSize(this.cellSizesSum+n);return o?this.cellSizes.unshift(n):this.cellSizes.push(n),this.cellSizesSum+=n,this.cellCount++,this.remainingSize=this.cellSizesSum-i,o&&this.isLastIncomplete()?!1:!0}return!1},S.prototype.remove=function(){var t=this.cellSizes.pop();this.cellSizesSum-=t,this.cellCount--,this.remainingSize-=t},S.prototype.removeOutstanding=function(){for(;this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize;)this.remove()},T.prototype.scrollVertical=function(t){if(!this.instance.drawn)throw new Error("scrollVertical can only be called after table was drawn to DOM");var e,o=this.instance,n=o.getSetting("offsetRow"),i=o.getSetting("fixedRowsTop"),r=o.getSetting("totalRows"),s=o.wtViewport.getViewportHeight();return e=r>0?this.scrollLogicVertical(t,n,r,i,s,function(t){return i>t-n&&t-n>=0?o.getSetting("rowHeight",t-n):o.getSetting("rowHeight",t)},function(t){o.wtTable.verticalRenderReverse=t}):0,e!==n&&this.instance.wtScrollbars.vertical.scrollTo(e),o},T.prototype.scrollHorizontal=function(t){if(!this.instance.drawn)throw new Error("scrollHorizontal can only be called after table was drawn to DOM");var e,o=this.instance,n=o.getSetting("offsetColumn"),i=o.getSetting("fixedColumnsLeft"),r=o.getSetting("totalColumns"),s=o.wtViewport.getViewportWidth();return e=r>0?this.scrollLogicHorizontal(t,n,r,i,s,function(t){return i>t-n&&t-n>=0?o.getSetting("columnWidth",t-n):o.getSetting("columnWidth",t)}):0,e!==n&&this.instance.wtScrollbars.horizontal.scrollTo(e),o},T.prototype.scrollLogicVertical=function(t,e,o,n,i,r,s){var a=e+t;return a>=o-n&&(a=o-n-1,s(!0)),0>a&&(a=0),a},T.prototype.scrollLogicHorizontal=function(t,e,o,n,i,r){var s,a=e+t,l=0;if(a>n){for(a>=o-n&&(a=o-n-1),s=a;i>l&&o>s;)l+=r(s),s++;if(i>l)for(;a>0&&(l+=r(a-1),i>l);)a--}else 0>a&&(a=0);return a},T.prototype.scrollViewport=function(t){if(this.instance.drawn){var o=this.instance.getSetting("offsetRow"),n=(this.instance.getSetting("offsetColumn"),this.instance.wtTable.getLastVisibleRow()),i=this.instance.getSetting("totalRows"),r=this.instance.getSetting("totalColumns"),s=this.instance.getSetting("fixedRowsTop"),a=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var l=this.instance.wtTable.getCell(t);if("object"==typeof l){var c=y.prototype.offset(l),h=y.prototype.outerWidth(l),u=y.prototype.outerHeight(l),d=this.instance.wtScrollbars.horizontal.getScrollPosition(),p=this.instance.wtScrollbars.vertical.getScrollPosition(),f=y.prototype.outerWidth(this.instance.wtScrollbars.horizontal.scrollHandler),g=y.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);return this.instance.wtScrollbars.horizontal.scrollHandler!==e&&(c.left=c.left-y.prototype.offset(this.instance.wtScrollbars.horizontal.scrollHandler).left),this.instance.wtScrollbars.vertical.scrollHandler!==e&&(c.top=c.top-y.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top),f-=20,g-=20,f>h&&(c.left<d?this.instance.wtScrollbars.horizontal.setScrollPosition(c.left):c.left+h>d+f&&this.instance.wtScrollbars.horizontal.setScrollPosition(c.left-f+h)),void(g>u&&(c.top<p?this.instance.wtScrollbars.vertical.setScrollPosition(c.top):c.top+u>p+g&&this.instance.wtScrollbars.vertical.setScrollPosition(c.top-g+u)))}}if(t[0]<0||t[0]>i-1)throw new Error("row "+t[0]+" does not exist");if(t[1]<0||t[1]>r-1)throw new Error("column "+t[1]+" does not exist");if(t[0]>n?(this.scrollVertical(t[0]-s-o),this.instance.wtTable.verticalRenderReverse=!0):t[0]===n&&this.instance.wtTable.rowStrategy.isLastIncomplete()?(this.scrollVertical(t[0]-s-o),this.instance.wtTable.verticalRenderReverse=!0):t[0]-s<o?this.scrollVertical(t[0]-s-o):this.scrollVertical(0),this.instance.wtTable.isColumnBeforeViewport(t[1]))this.instance.wtScrollbars.horizontal.scrollTo(t[1]-a);else if(this.instance.wtTable.isColumnAfterViewport(t[1])||this.instance.wtTable.getLastVisibleColumn()===t[1]&&!this.instance.wtTable.isLastColumnFullyVisible()){for(var m=0,w=0;a>w;w++)m+=this.instance.getSetting("columnWidth",w);var v=t[1];m+=this.instance.getSetting("columnWidth",v);var C=this.instance.wtViewport.getViewportWidth();if(C>m)for(var b=this.instance.getSetting("columnWidth",v-1);C>=m+b&&v>=a;)v--,m+=b,b=this.instance.getSetting("columnWidth",v-1);this.instance.wtScrollbars.horizontal.scrollTo(v-a)}return this.instance}},R.prototype.init=function(){var e=this;this.$table=t(this.instance.wtTable.TABLE),this.slider=document.createElement("DIV"),this.sliderStyle=this.slider.style,this.sliderStyle.position="absolute",this.sliderStyle.top="0",this.sliderStyle.left="0",this.sliderStyle.display="none",this.slider.className="dragdealer "+this.type,this.handle=document.createElement("DIV"),this.handleStyle=this.handle.style,this.handle.className="handle",this.slider.appendChild(this.handle),this.container=this.instance.wtTable.holder,this.container.appendChild(this.slider);var o=!0;this.dragTimeout=null;var n,i=function(){e.onScroll(n)};this.dragdealer=new q(this.slider,{vertical:"vertical"===this.type,horizontal:"horizontal"===this.type,slide:!1,speed:100,animationCallback:function(t,r){return o?void(o=!1):(e.skipRefresh=!0,n="vertical"===e.type?r:t,void(null===e.dragTimeout&&(e.dragTimeout=setInterval(i,100),i())))},callback:function(t,o){e.skipRefresh=!1,clearInterval(e.dragTimeout),e.dragTimeout=null,n="vertical"===e.type?o:t,e.onScroll(n)}}),this.skipRefresh=!1},R.prototype.onScroll=function(t){if(this.instance.drawn&&(this.readSettings(),this.total>this.visibleCount)){var e=Math.round(this.handlePosition*this.total/this.sliderSize);1===t?"vertical"===this.type?this.instance.scrollVertical(1/0).draw():this.instance.scrollHorizontal(1/0).draw():e!==this.offset?"vertical"===this.type?this.instance.scrollVertical(e-this.offset).draw():this.instance.scrollHorizontal(e-this.offset).draw():this.refresh()}},R.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:1/e},R.prototype.prepare=function(){if(!this.skipRefresh){var t=this.getHandleSizeRatio(this.visibleCount,this.total);(1===t||isNaN(t))&&"auto"===this.scrollMode||"none"===this.scrollMode?this.visible=!1:this.visible=!0}},R.prototype.refresh=function(){if(!this.skipRefresh){if(!this.visible)return void(this.sliderStyle.display="none");var t,e,o,n,i=this.visibleCount,r=this.instance.wtViewport.getWorkspaceWidth(),s=this.instance.wtViewport.getWorkspaceHeight();
r===1/0&&(r=this.instance.wtViewport.getWorkspaceActualWidth()),s===1/0&&(s=this.instance.wtViewport.getWorkspaceActualHeight()),"vertical"===this.type?(this.instance.wtTable.rowStrategy.isLastIncomplete()&&i--,e=s-2,this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px",this.sliderStyle.left=r-1+"px",this.sliderStyle.height=Math.max(e,0)+"px"):(e=r-2,this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px",this.sliderStyle.top=s-1+"px",this.sliderStyle.width=Math.max(e,0)+"px"),t=this.getHandleSizeRatio(i,this.total),o=Math.round(e*t),10>o&&(o=15),n=Math.floor(e*(this.offset/this.total)),o+n>e&&(n=e-o),"vertical"===this.type?(this.handleStyle.height=o+"px",this.handleStyle.top=n+"px"):(this.handleStyle.width=o+"px",this.handleStyle.left=n+"px"),this.sliderStyle.display="block"}},R.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var $=function(t){this.instance=t,this.type="vertical",this.init()};$.prototype=new R,$.prototype.scrollTo=function(t){this.instance.update("offsetRow",t)},$.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV"),this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows"),this.visibleCount=this.instance.wtTable.rowStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.top,10),this.sliderSize=parseInt(this.sliderStyle.height,10),this.fixedCount=this.instance.getSetting("fixedRowsTop")};var G=function(t){this.instance=t,this.type="horizontal",this.init()};G.prototype=new R,G.prototype.scrollTo=function(t){this.instance.update("offsetColumn",t)},G.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH"),this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns"),this.visibleCount=this.instance.wtTable.columnStrategy.countVisible(),this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()&&this.visibleCount--,this.handlePosition=parseInt(this.handleStyle.left,10),this.sliderSize=parseInt(this.sliderStyle.width,10),this.fixedCount=this.instance.getSetting("fixedColumnsLeft")},G.prototype.getHandleSizeRatio=function(t,e){return!e||t>e||t==e?1:t/e},E.prototype=new c,E.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.top,10),i=Math.ceil(t.bottom,10);0>n&&i>0?o.style.top="0":o.style.top=n+"px";var r=Math.ceil(t.left,10),s=Math.ceil(t.right,10);0>r&&s>0?o.style.left="0":o.style.left=r+"px"}else t=this.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px";o.style.width=y.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px",o.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},E.prototype.prepare=function(){},E.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},E.prototype.getScrollPosition=function(){},E.prototype.getLastCell=function(){},E.prototype.applyToDOM=function(){},E.prototype.scrollTo=function(){},E.prototype.readWindowSize=function(){},E.prototype.readSettings=function(){},x.prototype=new c,x.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.left,10),i=Math.ceil(t.right,10);0>n&&i>0?o.style.left="0":o.style.left=n+"px"}else t=this.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px"}},x.prototype.react=function(){if(this.instance.wtTable.holder.parentNode){var t=this.clone.wtTable.holder.parentNode;if(this.instance.wtScrollbars.vertical.scrollHandler===e){var o=this.instance.wtTable.hider.getBoundingClientRect();t.style.top=Math.ceil(o.top,10)+"px",t.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+"px"}else this.clone.wtTable.holder.style.top=-(this.instance.wtScrollbars.vertical.windowScrollPosition-this.instance.wtScrollbars.vertical.measureBefore)+"px",t.style.height=this.instance.wtViewport.getWorkspaceHeight()+"px";t.style.width=y.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},x.prototype.prepare=function(){},x.prototype.refresh=function(t){this.measureBefore=0,this.measureAfter=0,this.clone&&this.clone.draw(t)},x.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollX:this.scrollHandler.scrollLeft},x.prototype.setScrollPosition=function(t){this.scrollHandler.scrollLeft=t},x.prototype.onScroll=function(){c.prototype.onScroll.apply(this,arguments),this.instance.getSetting("onScrollHorizontally")},x.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()},x.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px",this.fixedContainer.style.paddingRight=this.measureAfter+"px"},x.prototype.scrollTo=function(t){this.$scrollHandler.scrollLeft(this.tableParentOffset+t*this.cellSize)},x.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientWidth,this.tableParentOffset=this.instance.wtTable.holderOffset.left):(this.windowSize=y.prototype.outerWidth(this.scrollHandler),this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},x.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn"),this.total=this.instance.getSetting("totalColumns")},D.prototype=new c,D.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var t,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){t=this.instance.wtTable.hider.getBoundingClientRect();var n=Math.ceil(t.top,10),i=Math.ceil(t.bottom,10);0>n&&i>0?o.style.top="0":o.style.top=n+"px"}else t=this.instance.wtScrollbars.horizontal.scrollHandler.getBoundingClientRect(),o.style.top=Math.ceil(t.top,10)+"px",o.style.left=Math.ceil(t.left,10)+"px";this.instance.wtScrollbars.horizontal.scrollHandler===e?o.style.width=this.instance.wtViewport.getWorkspaceActualWidth()+"px":o.style.width=y.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px",o.style.height=y.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},D.prototype.react=function(){if(this.instance.wtTable.holder.parentNode&&this.instance.wtScrollbars.horizontal.scrollHandler!==e){var t=this.clone.wtTable.holder.parentNode;t.firstChild.style.left=-this.instance.wtScrollbars.horizontal.windowScrollPosition+"px"}},D.prototype.getScrollPosition=function(){return this.scrollHandler===e?this.scrollHandler.scrollY:this.scrollHandler.scrollTop},D.prototype.setScrollPosition=function(t){this.scrollHandler.scrollTop=t},D.prototype.onScroll=function(t){c.prototype.onScroll.apply(this,arguments);var e,o=0;if(e=this.windowScrollPosition-this.tableParentOffset,K=0,e>0){for(var n,i=0,r=0;r<this.total&&(n=this.instance.getSetting("rowHeight",r),i+=n,!(i>e));r++);this.offset>0&&(K=i-e),o=r,o=Math.min(o,this.total)}this.curOuts=o>this.maxOuts?this.maxOuts:o,o-=this.curOuts,this.instance.update("offsetRow",o),this.readSettings(),this.instance.draw(),this.instance.getSetting("onScrollVertically")},D.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};var K=0;D.prototype.sumCellSizes=function(t,e){for(var o=0;e>t;)o+=this.instance.getSetting("rowHeight",t),t++;return o},D.prototype.applyToDOM=function(){var t=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=t+this.sumCellSizes(0,this.total)+4+"px",this.fixed.style.top=this.measureBefore+"px",this.fixed.style.bottom=""},D.prototype.scrollTo=function(t){var e=this.tableParentOffset+t*this.cellSize;this.$scrollHandler.scrollTop(e),this.onScroll(e)},D.prototype.readWindowSize=function(){this.scrollHandler===e?(this.windowSize=document.documentElement.clientHeight,this.tableParentOffset=this.instance.wtTable.holderOffset.top):(this.windowSize=this.scrollHandler.clientHeight,this.tableParentOffset=0),this.windowScrollPosition=this.getScrollPosition()},D.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow"),this.total=this.instance.getSetting("totalRows")},H.prototype.registerListeners=function(){function o(){return c.instance.wtTable.holder.parentNode?(c.vertical.windowScrollPosition=c.vertical.getScrollPosition(),c.horizontal.windowScrollPosition=c.horizontal.getScrollPosition(),c.box=c.instance.wtTable.hider.getBoundingClientRect(),c.box.width===a&&c.box.height===l||!c.instance.rowHeightCache||(a=c.box.width,l=c.box.height,c.instance.draw()),void((c.vertical.windowScrollPosition!==n||c.horizontal.windowScrollPosition!==i||c.box.top!==r||c.box.left!==s)&&(c.vertical.onScroll(),c.horizontal.onScroll(),c.vertical.react(),c.horizontal.react(),n=c.vertical.windowScrollPosition,i=c.horizontal.windowScrollPosition,r=c.box.top,s=c.box.left))):void c.destroy()}var n,i,r,s,a,l,c=this,h=t(e);this.vertical.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&this.horizontal.$scrollHandler.on("scroll."+this.instance.guid,o),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&h.on("scroll."+this.instance.guid,o),h.on("load."+this.instance.guid,o),h.on("resize."+this.instance.guid,o),t(document).on("ready."+this.instance.guid,o),setInterval(o,100)},H.prototype.destroy=function(){this.vertical&&this.vertical.destroy(),this.horizontal&&this.horizontal.destroy()},H.prototype.refresh=function(t){this.horizontal&&this.horizontal.readSettings(),this.vertical&&this.vertical.readSettings(),this.horizontal&&this.horizontal.prepare(),this.vertical&&this.vertical.prepare(),this.horizontal&&this.horizontal.refresh(t),this.vertical&&this.vertical.refresh(t),this.corner&&this.corner.refresh(t),this.debug&&this.debug.refresh(t)},k.prototype.add=function(t){this.selected.push(t)},k.prototype.clear=function(){this.selected.length=0},k.prototype.getCorners=function(){var t,e,o,n,i,r=this.selected.length;if(r>0&&(t=o=this.selected[0][0],e=n=this.selected[0][1],r>1))for(i=1;r>i;i++)this.selected[i][0]<t?t=this.selected[i][0]:this.selected[i][0]>o&&(o=this.selected[i][0]),this.selected[i][1]<e?e=this.selected[i][1]:this.selected[i][1]>n&&(n=this.selected[i][1]);return[t,e,o,n]},k.prototype.draw=function(){var t,e,o,n,i,r=this.instance.wtTable.rowStrategy.countVisible(),s=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){for(t=this.getCorners(),e=0;r>e;e++)for(o=0;s>o;o++)n=this.instance.wtTable.rowFilter.visibleToSource(e),i=this.instance.wtTable.columnFilter.visibleToSource(o),n>=t[0]&&n<=t[2]&&i>=t[1]&&i<=t[3]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.className):n>=t[0]&&n<=t[2]?this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightRowClassName):i>=t[1]&&i<=t[3]&&this.instance.wtTable.currentCellCache.add(e,o,this.settings.highlightColumnClassName);this.border&&this.border.appear(t)}else this.border&&this.border.disappear()},A.prototype.update=function(t,e){if(void 0===e)for(var o in t)t.hasOwnProperty(o)&&(this.settings[o]=t[o]);else this.settings[t]=e;return this.instance},A.prototype.getSetting=function(t,e,o,n){return this[t]?this[t](e,o,n):this._getSetting(t,e,o,n)},A.prototype._getSetting=function(t,e,o,n){return"function"==typeof this.settings[t]?this.settings[t](e,o,n):void 0!==e&&"[object Array]"===Object.prototype.toString.call(this.settings[t])?this.settings[t][e]:this.settings[t]},A.prototype.has=function(t){return!!this.settings[t]},A.prototype.rowHeight=function(t,e){if(this.instance.rowHeightCache||(this.instance.rowHeightCache=[]),void 0===this.instance.rowHeightCache[t]){var o=23;return e&&(o=this.instance.wtDom.outerHeight(e),this.instance.rowHeightCache[t]=o),o}return this.instance.rowHeightCache[t]},P.prototype.refreshHiderDimensions=function(){var t=this.instance.wtViewport.getWorkspaceHeight(),e=this.instance.wtViewport.getWorkspaceWidth(),o=this.spreader.style;t===1/0&&e===1/0||this.instance.getSetting("nativeScrollbars")?(o.position="relative",o.width="auto",o.height="auto"):(t===1/0&&(t=this.instance.wtViewport.getWorkspaceActualHeight()),e===1/0&&(e=this.instance.wtViewport.getWorkspaceActualWidth()),this.hiderStyle.overflow="hidden",o.position="absolute",o.top="0",o.left="0",this.instance.getSetting("nativeScrollbars")||(o.height="4000px",o.width="4000px"),0>t&&(t=0),this.hiderStyle.height=t+"px",this.hiderStyle.width=e+"px")},P.prototype.refreshStretching=function(){if(!this.instance.cloneSource){var t=this.instance,e=t.getSetting("stretchH"),o=t.getSetting("totalRows"),n=t.getSetting("totalColumns"),i=t.getSetting("offsetColumn"),r=function(t){var e=s.instance.wtViewport.getViewportWidth(t);return t>e&&s.instance.getSetting("nativeScrollbars")?1/0:e},s=this,a=function(e){var o=s.columnFilter.visibleToSource(e);return n>o?t.getSetting("columnWidth",o):void 0};"hybrid"===e&&(e=i>0?"last":"none");var l=function(t){return s.instance.getSetting("nativeScrollbars")?s.instance.cloneOverlay instanceof w?1/0:2*s.instance.wtViewport.getViewportHeight(t):s.instance.wtViewport.getViewportHeight(t)},c=function(t,e){if(s.instance.getSetting("nativeScrollbars"))return 20;var n=s.rowFilter.visibleToSource(t);return o>n?s.verticalRenderReverse&&0===t?s.instance.getSetting("rowHeight",n,e)-1:s.instance.getSetting("rowHeight",n,e):void 0};this.columnStrategy=new g(t,r,a,e),this.rowStrategy=new S(t,l,c)}},P.prototype.adjustAvailableNodes=function(){for(var t,e,o,n,i=this.instance.getSetting("rowHeaders"),r=i.length,s=this.instance.getSetting("columnHeaders");this.colgroupChildrenLength<r;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(this.refreshStretching(),t=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof x||this.instance.cloneOverlay instanceof E)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount;this.colgroupChildrenLength<t+r;)this.COLGROUP.appendChild(document.createElement("COL")),this.colgroupChildrenLength++;for(;this.colgroupChildrenLength>t+r;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.colgroupChildrenLength--;if(e=this.THEAD.firstChild,s.length){for(e||(e=document.createElement("TR"),this.THEAD.appendChild(e)),this.theadChildrenLength=e.childNodes.length;this.theadChildrenLength<t+r;)e.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>t+r;)e.removeChild(e.lastChild),this.theadChildrenLength--}else e&&this.wtDom.empty(e);for(n=0;n<this.colgroupChildrenLength;n++)r>n?this.wtDom.addClass(this.COLGROUP.childNodes[n],"rowHeader"):this.wtDom.removeClass(this.COLGROUP.childNodes[n],"rowHeader");if(s.length&&(e=this.THEAD.firstChild,r))for(o=e.firstChild,n=0;r>n;n++)i[n](-r+n,o),o=o.nextSibling;for(n=0;t>n;n++)s.length&&s[0](this.columnFilter.visibleToSource(n),e.childNodes[r+n])},P.prototype.adjustColumns=function(t,e){for(var o=t.childNodes.length;e>o;){var n=document.createElement("TD");t.appendChild(n),o++}for(;o>e;)t.removeChild(t.lastChild),o--},P.prototype.draw=function(t){return this.instance.getSetting("nativeScrollbars")&&(this.verticalRenderReverse=!1),this.rowFilter.readSettings(this.instance),this.columnFilter.readSettings(this.instance),t?this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0):(this.instance.getSetting("nativeScrollbars")?this.instance.cloneSource?this.tableOffset=this.instance.cloneSource.wtTable.tableOffset:(this.holderOffset=this.wtDom.offset(this.holder),this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtScrollbars.vertical.readWindowSize(),this.instance.wtScrollbars.horizontal.readWindowSize(),this.instance.wtViewport.resetSettings()):(this.tableOffset=this.wtDom.offset(this.TABLE),this.instance.wtViewport.resetSettings()),this._doDraw()),this.refreshPositions(t),t||this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition(),this.instance.wtScrollbars.debug&&this.instance.wtScrollbars.debug.resetFixedPosition())),this.instance.drawn=!0,this},P.prototype._doDraw=function(){var t,e,o,n,i,r,s,a,l,c,h=0,u=this.instance.getSetting("offsetRow"),d=this.instance.getSetting("totalRows"),p=this.instance.getSetting("totalColumns"),f=this.instance.getSetting("rowHeaders"),g=f.length,m=!1;this.verticalRenderReverse&&(l=u);var y=!1;if(this.verticalRenderReverse&&(u===d-this.rowFilter.fixedCount-1?y=!0:(this.instance.update("offsetRow",u+1),this.rowFilter.readSettings(this.instance))),this.instance.cloneSource&&(this.columnStrategy=this.instance.cloneSource.wtTable.columnStrategy,this.rowStrategy=this.instance.cloneSource.wtTable.rowStrategy),p>0){t=this.rowFilter.visibleToSource(h);var v,C=this.instance.getSetting("fixedRowsTop");for(this.instance.cloneSource&&(this.instance.cloneOverlay instanceof D||this.instance.cloneOverlay instanceof E?v=C:this.instance.cloneOverlay instanceof x&&(v=this.rowStrategy.countVisible())),this.adjustAvailableNodes(),m=!0,n=this.instance.cloneSource&&(this.instance.cloneOverlay instanceof x||this.instance.cloneOverlay instanceof E)?this.instance.getSetting("fixedColumnsLeft"):this.columnStrategy.cellCount,this.instance.cloneSource||(a=this.instance.wtViewport.getWorkspaceWidth(),this.columnStrategy.stretch()),e=0;n>e;e++)this.COLGROUP.childNodes[e+g].style.width=this.columnStrategy.getSize(e)+"px";for(;d>t&&t>=0;){if(h>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==v&&h===v)break;if(h>=this.tbodyChildrenLength||this.verticalRenderReverse&&h>=this.rowFilter.fixedCount){for(i=document.createElement("TR"),e=0;g>e;e++)i.appendChild(document.createElement("TH"));this.verticalRenderReverse&&h>=this.rowFilter.fixedCount?this.TBODY.insertBefore(i,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild):this.TBODY.appendChild(i),this.tbodyChildrenLength++}else i=0===h?this.TBODY.firstChild:i.nextSibling;for(s=i.firstChild,e=0;g>e;e++)"TD"==s.nodeName&&(r=s,s=document.createElement("TH"),i.insertBefore(s,r),i.removeChild(r)),f[e](t,s),s=s.nextSibling;for(this.adjustColumns(i,n+g),e=0;n>e;e++)o=this.columnFilter.visibleToSource(e),r=0===e?i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(o)]:r.nextSibling,"TH"==r.nodeName&&(s=r,r=document.createElement("TD"),i.insertBefore(r,s),i.removeChild(s)),r.className="",r.removeAttribute("style"),this.instance.getSetting("cellRenderer",t,o,r);if(u=this.instance.getSetting("offsetRow"),this.verticalRenderReverse&&y){if(-this.wtDom.outerHeight(i.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(i),this.instance.update("offsetRow",u+1),this.tbodyChildrenLength--,this.rowFilter.readSettings(this.instance);break}this.instance.cloneSource||(c=this.rowStrategy.add(h,r,this.verticalRenderReverse),c===!1&&this.rowStrategy.removeOutstanding())}else if(!this.instance.cloneSource&&(c=this.rowStrategy.add(h,r,this.verticalRenderReverse),c===!1&&(this.instance.getSetting("nativeScrollbars")||this.rowStrategy.removeOutstanding()),this.rowStrategy.isLastIncomplete())){if(this.verticalRenderReverse&&!this.isRowInViewport(l))return this.verticalRenderReverse=!1,this.instance.update("offsetRow",l),void this.draw();break}if(this.instance.getSetting("nativeScrollbars")&&(this.instance.cloneSource?i.style.height=this.instance.getSetting("rowHeight",t)+"px":this.instance.getSetting("rowHeight",t,r)),this.verticalRenderReverse&&h>=this.rowFilter.fixedCount){if(0===u)break;this.instance.update("offsetRow",u-1),this.rowFilter.readSettings(this.instance)}else h++;t=this.rowFilter.visibleToSource(h)}}if(m||this.adjustAvailableNodes(),!(this.instance.cloneOverlay instanceof w))for(h=this.rowStrategy.countVisible();this.tbodyChildrenLength>h;)this.TBODY.removeChild(this.TBODY.lastChild),this.tbodyChildrenLength--;if(this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!1),!this.instance.cloneSource&&a!==this.instance.wtViewport.getWorkspaceWidth())for(this.columnStrategy.stretch(),e=0;e<this.columnStrategy.cellCount;e++)this.COLGROUP.childNodes[e+g].style.width=this.columnStrategy.getSize(e)+"px";this.verticalRenderReverse=!1},P.prototype.refreshPositions=function(t){this.refreshHiderDimensions(),this.refreshSelections(t)},P.prototype.refreshSelections=function(t){var e,o,n,i,r,s,a=[],l=this.rowStrategy.countVisible(),c=this.columnStrategy.countVisible();if(this.oldCellCache=this.currentCellCache,this.currentCellCache=new p,this.instance.selections)for(o in this.instance.selections)this.instance.selections.hasOwnProperty(o)&&(this.instance.selections[o].draw(),this.instance.selections[o].settings.className&&a.push(this.instance.selections[o].settings.className),this.instance.selections[o].settings.highlightRowClassName&&a.push(this.instance.selections[o].settings.highlightRowClassName),this.instance.selections[o].settings.highlightColumnClassName&&a.push(this.instance.selections[o].settings.highlightColumnClassName));for(s=a.length,e=0;l>e;e++)for(n=0;c>n;n++)for(o=this.rowFilter.visibleToSource(e),i=this.columnFilter.visibleToSource(n),r=0;s>r;r++)this.currentCellCache.test(e,n,a[r])?this.wtDom.addClass(this.getCell([o,i]),a[r]):t&&this.oldCellCache.test(e,n,a[r])&&this.wtDom.removeClass(this.getCell([o,i]),a[r])},P.prototype.getCell=function(t){return this.isRowBeforeViewport(t[0])?-1:this.isRowAfterViewport(t[0])?-2:this.isColumnBeforeViewport(t[1])?-3:this.isColumnAfterViewport(t[1])?-4:this.TBODY.childNodes[this.rowFilter.sourceToVisible(t[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t[1])]},P.prototype.getCoords=function(t){return[this.rowFilter.visibleToSource(this.wtDom.index(t.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(t.cellIndex)]},P.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)},P.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)},P.prototype.isRowBeforeViewport=function(t){return this.rowFilter.sourceToVisible(t)<this.rowFilter.fixedCount&&t>=this.rowFilter.fixedCount},P.prototype.isRowAfterViewport=function(t){return t>this.getLastVisibleRow()},P.prototype.isColumnBeforeViewport=function(t){return this.columnFilter.sourceToVisible(t)<this.columnFilter.fixedCount&&t>=this.columnFilter.fixedCount},P.prototype.isColumnAfterViewport=function(t){return t>this.getLastVisibleColumn()},P.prototype.isRowInViewport=function(t){return!this.isRowBeforeViewport(t)&&!this.isRowAfterViewport(t)},P.prototype.isColumnInViewport=function(t){return!this.isColumnBeforeViewport(t)&&!this.isColumnAfterViewport(t)},P.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete()},P.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete()},O.prototype.getWorkspaceHeight=function(t){if(this.instance.getSetting("nativeScrollbars"))return this.instance.wtScrollbars.vertical.windowSize;var e=this.instance.getSetting("height");return(e===1/0||void 0===e||null===e||1>e)&&(e=this.instance.wtScrollbars.vertical instanceof c?this.instance.wtScrollbars.vertical.availableSize():1/0),e!==1/0&&(t>=e?e-=this.instance.getSetting("scrollbarHeight"):this.instance.wtScrollbars.horizontal.visible&&(e-=this.instance.getSetting("scrollbarHeight"))),e},O.prototype.getWorkspaceWidth=function(t){var e=this.instance.getSetting("width");return(e===1/0||void 0===e||null===e||1>e)&&(e=this.instance.wtScrollbars.horizontal instanceof c?this.instance.wtScrollbars.horizontal.availableSize():1/0),e!==1/0&&(t>=e?e-=this.instance.getSetting("scrollbarWidth"):this.instance.wtScrollbars.vertical.visible&&(e-=this.instance.getSetting("scrollbarWidth"))),e},O.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)},O.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)},O.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var t=this.instance.wtDom.offset(this.instance.wtTable.TBODY),e=this.instance.wtTable.tableOffset;this.columnHeaderHeight=t.top-e.top}return this.columnHeaderHeight},O.prototype.getViewportHeight=function(t){var e=this.getWorkspaceHeight(t);if(e===1/0)return e;var o=this.getColumnHeaderHeight();return o>0?e-o:e},O.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var t=this.instance.getSetting("rowHeaders");if(t.length){var e=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var o=0,n=t.length;n>o;o++)e?(this.rowHeaderWidth+=this.instance.wtDom.outerWidth(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},O.prototype.getViewportWidth=function(t){var e=this.getWorkspaceWidth(t);if(e===1/0)return e;var o=this.getRowHeaderWidth();return o>0?e-o:e},O.prototype.resetSettings=function(){this.rowHeaderWidth=NaN,this.columnHeaderHeight=NaN};var X={x:0,y:0,init:function(){this.setEvent("mouse"),this.setEvent("touch")},setEvent:function(t){var e=document["on"+t+"move"]||function(){};document["on"+t+"move"]=function(t){e(t),X.refresh(t)}},refresh:function(t){t||(t=e.event),"mousemove"==t.type?this.set(t):t.touches&&this.set(t.touches[0])},set:function(t){t.pageX||t.pageY?(this.x=t.pageX,this.y=t.pageY):document.body&&(t.clientX||t.clientY)&&(this.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop)}};X.init();var Y={get:function(t){var e=0,o=0;if(t.offsetParent)do o+=t.offsetLeft,e+=t.offsetTop;while(t=t.offsetParent);return[o,e]}},q=function(t,e){if("string"==typeof t&&(t=document.getElementById(t)),t){var o=t.getElementsByTagName("div")[0];o&&-1!=o.className.search(/(^|\s)handle(\s|$)/)&&(this.init(t,o,e||{}),this.setup())}};q.prototype={init:function(t,e,o){this.wrapper=t,this.handle=e,this.options=o,this.disabled=this.getOption("disabled",!1),this.horizontal=this.getOption("horizontal",!0),this.vertical=this.getOption("vertical",!1),this.slide=this.getOption("slide",!0),this.steps=this.getOption("steps",0),this.snap=this.getOption("snap",!1),this.loose=this.getOption("loose",!1),this.speed=this.getOption("speed",10)/100,this.xPrecision=this.getOption("xPrecision",0),this.yPrecision=this.getOption("yPrecision",0),this.callback=o.callback||null,this.animationCallback=o.animationCallback||null,this.bounds={left:o.left||0,right:-(o.right||0),top:o.top||0,bottom:-(o.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0},this.value={prev:[-1,-1],current:[o.x||0,o.y||0],target:[o.x||0,o.y||0]},this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]},this.change=[0,0],this.activity=!1,this.dragging=!1,this.tapping=!1},getOption:function(t,e){return void 0!==this.options[t]?this.options[t]:e},setup:function(){this.setWrapperOffset(),this.setBoundsPadding(),this.setBounds(),this.setSteps(),this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Y.get(this.wrapper)},setBoundsPadding:function(){this.bounds.left||this.bounds.right||(this.bounds.left=Y.get(this.handle)[0]-this.offset.wrapper[0],this.bounds.right=-this.bounds.left),this.bounds.top||this.bounds.bottom||(this.bounds.top=Y.get(this.handle)[1]-this.offset.wrapper[1],this.bounds.bottom=-this.bounds.top)},setBounds:function(){this.bounds.x0=this.bounds.left,this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right,this.bounds.xRange=this.bounds.x1-this.bounds.x0-this.handle.offsetWidth,this.bounds.y0=this.bounds.top,this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom,this.bounds.yRange=this.bounds.y1-this.bounds.y0-this.handle.offsetHeight,this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth)),this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var t=0;t<=this.steps-1;t++)this.stepRatios[t]=t/(this.steps-1)}},addListeners:function(){var t=this;this.wrapper.onselectstart=function(){return!1},this.handle.onmousedown=this.handle.ontouchstart=function(e){t.handleDownHandler(e)},this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){t.wrapperDownHandler(e)};var o=document.onmouseup||function(){};document.onmouseup=function(e){o(e),t.documentUpHandler(e)};var n=document.ontouchend||function(){};document.ontouchend=function(e){n(e),t.documentUpHandler(e)};var i=e.onresize||function(){};e.onresize=function(e){i(e),t.documentResizeHandler(e)},this.wrapper.onmousemove=function(e){t.activity=!0},this.wrapper.onclick=function(e){return!t.activity},this.interval=setInterval(function(){t.animate()},25),t.animate(!1,!0)},handleDownHandler:function(t){this.activity=!1,X.refresh(t),this.preventDefaults(t,!0),this.startDrag()},wrapperDownHandler:function(t){X.refresh(t),this.preventDefaults(t,!0),this.startTap()},documentUpHandler:function(t){this.stopDrag(),this.stopTap()},documentResizeHandler:function(t){this.setWrapperOffset(),this.setBounds(),this.update()},enable:function(){this.disabled=!1,this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=!0,this.handle.className+=" disabled"},setStep:function(t,e,o){this.setValue(this.steps&&t>1?(t-1)/(this.steps-1):0,this.steps&&e>1?(e-1)/(this.steps-1):0,o)},setValue:function(t,e,o){this.setTargetValue([t,e||0]),o&&this.groupCopy(this.value.current,this.value.target)},startTap:function(t){this.disabled||(this.tapping=!0,this.setWrapperOffset(),this.setBounds(),void 0===t&&(t=[X.x-this.offset.wrapper[0]-this.handle.offsetWidth/2,X.y-this.offset.wrapper[1]-this.handle.offsetHeight/2]),this.setTargetOffset(t))},stopTap:function(){!this.disabled&&this.tapping&&(this.tapping=!1,this.setTargetValue(this.value.current),this.result())},startDrag:function(){this.disabled||(this.setWrapperOffset(),this.setBounds(),this.offset.mouse=[X.x-Y.get(this.handle)[0],X.y-Y.get(this.handle)[1]],this.dragging=!0)},stopDrag:function(){if(!this.disabled&&this.dragging){this.dragging=!1;var t=this.groupClone(this.value.current);if(this.slide){var e=this.change;t[0]+=4*e[0],t[1]+=4*e[1]}this.setTargetValue(t),this.result()}},feedback:function(){var t=this.value.current;this.snap&&this.steps>1&&(t=this.getClosestSteps(t)),this.groupCompare(t,this.value.prev)||("function"==typeof this.animationCallback&&this.animationCallback(t[0],t[1]),this.groupCopy(this.value.prev,t))},result:function(){"function"==typeof this.callback&&this.callback(this.value.target[0],this.value.target[1])},animate:function(t,e){if(!t||this.dragging){if(this.dragging){var o=this.groupClone(this.value.target),n=[X.x-this.offset.wrapper[0]-this.offset.mouse[0],X.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(n,this.loose),this.change=[this.value.target[0]-o[0],this.value.target[1]-o[1]]}(this.dragging||e)&&this.groupCopy(this.value.current,this.value.target),
(this.dragging||this.glide()||e)&&(this.update(),this.feedback())}},glide:function(){var t=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];return t[0]||t[1]?(Math.abs(t[0])>this.bounds.xStep||Math.abs(t[1])>this.bounds.yStep?(this.value.current[0]+=t[0]*this.speed,this.value.current[1]+=t[1]*this.speed):this.groupCopy(this.value.current,this.value.target),!0):!1},update:function(){this.snap?this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current)):this.offset.current=this.getOffsetsByRatios(this.value.current),this.show()},show:function(){this.groupCompare(this.offset.current,this.offset.prev)||(this.horizontal&&(this.handle.style.left=String(this.offset.current[0])+"px"),this.vertical&&(this.handle.style.top=String(this.offset.current[1])+"px"),this.groupCopy(this.offset.prev,this.offset.current))},setTargetValue:function(t,e){var o=e?this.getLooseValue(t):this.getProperValue(t);this.groupCopy(this.value.target,o),this.offset.target=this.getOffsetsByRatios(o)},setTargetOffset:function(t,e){var o=this.getRatiosByOffsets(t),n=e?this.getLooseValue(o):this.getProperValue(o);this.groupCopy(this.value.target,n),this.offset.target=this.getOffsetsByRatios(n)},getLooseValue:function(t){var e=this.getProperValue(t);return[e[0]+(t[0]-e[0])/4,e[1]+(t[1]-e[1])/4]},getProperValue:function(t){var e=this.groupClone(t);return e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0),e[0]=Math.min(e[0],1),e[1]=Math.min(e[1],1),(!this.dragging&&!this.tapping||this.snap)&&this.steps>1&&(e=this.getClosestSteps(e)),e},getRatiosByOffsets:function(t){return[this.getRatioByOffset(t[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(t[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(t,e,o){return e?(t-o)/e:0},getOffsetsByRatios:function(t){return[this.getOffsetByRatio(t[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(t[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(t,e,o){return Math.round(t*e)+o},getClosestSteps:function(t){return[this.getClosestStep(t[0]),this.getClosestStep(t[1])]},getClosestStep:function(t){for(var e=0,o=1,n=0;n<=this.steps-1;n++)Math.abs(this.stepRatios[n]-t)<o&&(o=Math.abs(this.stepRatios[n]-t),e=n);return this.stepRatios[e]},groupCompare:function(t,e){return t[0]==e[0]&&t[1]==e[1]},groupCopy:function(t,e){t[0]=e[0],t[1]=e[1]},groupClone:function(t){return[t[0],t[1]]},preventDefaults:function(t,o){t||(t=e.event),t.preventDefault&&t.preventDefault(),t.returnValue=!1,o&&document.selection&&document.selection.empty()},cancelEvent:function(t){t||(t=e.event),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0}},function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t:t(jQuery)}(function(t){function o(o){var r,s=o||e.event,a=[].slice.call(arguments,1),l=0,c=0,h=0,u=0,d=0;return o=t.event.fix(s),o.type="mousewheel",s.wheelDelta&&(l=s.wheelDelta),s.detail&&(l=-1*s.detail),s.deltaY&&(h=-1*s.deltaY,l=h),s.deltaX&&(c=s.deltaX,l=-1*c),void 0!==s.wheelDeltaY&&(h=s.wheelDeltaY),void 0!==s.wheelDeltaX&&(c=-1*s.wheelDeltaX),u=Math.abs(l),(!n||n>u)&&(n=u),d=Math.max(Math.abs(h),Math.abs(c)),(!i||i>d)&&(i=d),r=l>0?"floor":"ceil",l=Math[r](l/n),c=Math[r](c/i),h=Math[r](h/i),a.unshift(o,l,c,h),(t.event.dispatch||t.event.handle).apply(this,a)}var n,i,r=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],s="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(t.event.fixHooks)for(var a=r.length;a;)t.event.fixHooks[r[--a]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=s.length;t;)this.addEventListener(s[--t],o,!1);else this.onmousewheel=o},teardown:function(){if(this.removeEventListener)for(var t=s.length;t;)this.removeEventListener(s[--t],o,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})})}(jQuery,window,Handsontable),function(){function t(t){this._n=t}function e(t,e,o){var n,i=Math.pow(10,e);if(n=(Math.round(t*i)/i).toFixed(e),o){var r=new RegExp("0{1,"+o+"}$");n=n.replace(r,"")}return n}function o(t,e){var o;return o=e.indexOf("$")>-1?i(t,e):e.indexOf("%")>-1?r(t,e):e.indexOf(":")>-1?s(t,e):l(t,e)}function n(t,e){if(e.indexOf(":")>-1)t._n=a(e);else if(e===f)t._n=0;else{var o=e;"."!==d[p].delimiters.decimal&&(e=e.replace(/\./g,"").replace(d[p].delimiters.decimal,"."));for(var n=new RegExp(d[p].abbreviations.thousand+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),i=new RegExp(d[p].abbreviations.million+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),r=new RegExp(d[p].abbreviations.billion+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),s=new RegExp(d[p].abbreviations.trillion+"(?:\\)|(\\"+d[p].currency.symbol+")?(?:\\))?)?$"),l=["KB","MB","GB","TB","PB","EB","ZB","YB"],c=!1,h=0;h<=l.length&&!(c=e.indexOf(l[h])>-1?Math.pow(1024,h+1):!1);h++);t._n=(c?c:1)*(o.match(n)?Math.pow(10,3):1)*(o.match(i)?Math.pow(10,6):1)*(o.match(r)?Math.pow(10,9):1)*(o.match(s)?Math.pow(10,12):1)*(e.indexOf("%")>-1?.01:1)*Number((e.indexOf("(")>-1?"-":"")+e.replace(/[^0-9\.-]+/g,"")),t._n=c?Math.ceil(t._n):t._n}return t._n}function i(t,e){var n=e.indexOf("$")<=1?!0:!1,i="";e.indexOf(" $")>-1?(i=" ",e=e.replace(" $","")):e.indexOf("$ ")>-1?(i=" ",e=e.replace("$ ","")):e=e.replace("$","");var r=o(t,e);return n?r.indexOf("(")>-1||r.indexOf("-")>-1?(r=r.split(""),r.splice(1,0,d[p].currency.symbol+i),r=r.join("")):r=d[p].currency.symbol+i+r:r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,i+d[p].currency.symbol),r=r.join("")):r=r+i+d[p].currency.symbol,r}function r(t,e){var n="";e.indexOf(" %")>-1?(n=" ",e=e.replace(" %","")):e=e.replace("%",""),t._n=100*t._n;var i=o(t,e);return i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,n+"%"),i=i.join("")):i=i+n+"%",i}function s(t,e){var o=Math.floor(t._n/60/60),n=Math.floor((t._n-60*o*60)/60),i=Math.round(t._n-60*o*60-60*n);return o+":"+(10>n?"0"+n:n)+":"+(10>i?"0"+i:i)}function a(t){var e=t.split(":"),o=0;return 3===e.length?(o+=60*Number(e[0])*60,o+=60*Number(e[1]),o+=Number(e[2])):2===e.lenght&&(o+=60*Number(e[0]),o+=Number(e[1])),Number(o)}function l(t,o){var n=!1,i=!1,r="",s="",a="",l=Math.abs(t._n);if(0===t._n&&null!==f)return f;if(o.indexOf("(")>-1&&(n=!0,o=o.slice(1,-1)),o.indexOf("a")>-1&&(o.indexOf(" a")>-1?(r=" ",o=o.replace(" a","")):o=o.replace("a",""),l>=Math.pow(10,12)?(r+=d[p].abbreviations.trillion,t._n=t._n/Math.pow(10,12)):l<Math.pow(10,12)&&l>=Math.pow(10,9)?(r+=d[p].abbreviations.billion,t._n=t._n/Math.pow(10,9)):l<Math.pow(10,9)&&l>=Math.pow(10,6)?(r+=d[p].abbreviations.million,t._n=t._n/Math.pow(10,6)):l<Math.pow(10,6)&&l>=Math.pow(10,3)&&(r+=d[p].abbreviations.thousand,t._n=t._n/Math.pow(10,3))),o.indexOf("b")>-1){o.indexOf(" b")>-1?(s=" ",o=o.replace(" b","")):o=o.replace("b","");for(var c,h,u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],g=0;g<=u.length;g++)if(c=Math.pow(1024,g),h=Math.pow(1024,g+1),t._n>=c&&t._n<h){s+=u[g],c>0&&(t._n=t._n/c);break}}o.indexOf("o")>-1&&(o.indexOf(" o")>-1?(a=" ",o=o.replace(" o","")):o=o.replace("o",""),a+=d[p].ordinal(t._n)),o.indexOf("[.]")>-1&&(i=!0,o=o.replace("[.]","."));var m=t._n.toString().split(".")[0],w=o.split(".")[1],y=o.indexOf(","),v="",C=!1;return w?(w.indexOf("[")>-1?(w=w.replace("]",""),w=w.split("["),v=e(t._n,w[0].length+w[1].length,w[1].length)):v=e(t._n,w.length),m=v.split(".")[0],v=v.split(".")[1].length?d[p].delimiters.decimal+v.split(".")[1]:"",i&&0===Number(v)&&(v="")):m=e(t._n,null),m.indexOf("-")>-1&&(m=m.slice(1),C=!0),y>-1&&(m=m.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d[p].delimiters.thousands)),0===o.indexOf(".")&&(m=""),(n&&C?"(":"")+(!n&&C?"-":"")+m+v+(a?a:"")+(r?r:"")+(s?s:"")+(n&&C?")":"")}function c(t,e){d[t]=e}var h,u="1.4.7",d={},p="en",f=null,g="undefined"!=typeof module&&module.exports;h=function(e){return h.isNumeral(e)?e=e.value():Number(e)||(e=0),new t(Number(e))},h.version=u,h.isNumeral=function(e){return e instanceof t},h.language=function(t,e){return t?(t&&!e&&(p=t),(e||!d[t])&&c(t,e),h):p},h.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(t){var e=t%10;return 1===~~(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th"},currency:{symbol:"$"}}),h.zeroFormat=function(t){f="string"==typeof t?t:null},h.fn=t.prototype={clone:function(){return h(this)},format:function(t){return o(this,t?t:h.defaultFormat)},unformat:function(t){return n(this,t?t:h.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(t){return this._n=Number(t),this},add:function(t){return this._n=this._n+Number(t),this},subtract:function(t){return this._n=this._n-Number(t),this},multiply:function(t){return this._n=this._n*Number(t),this},divide:function(t){return this._n=this._n/Number(t),this},difference:function(t){var e=this._n-Number(t);return 0>e&&(e=-e),e}},g&&(module.exports=h),"undefined"==typeof ender&&(this.numeral=h),"function"==typeof define&&define.amd&&define([],function(){return h})}.call(this);